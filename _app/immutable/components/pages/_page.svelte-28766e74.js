import{I as U,S as Y,i as z,s as K,k as I,a as B,q as H,l as y,m as D,h as m,c as C,r as O,n as w,J as P,b as v,D as V,K as ce,f as d,g as T,d as j,u as fe,t as $,L as A,p as F,M as ie,N as J,O as ae,P as he,w as N,x as M,y as W,z as G,e as L,H as _e,o as ge}from"../../chunks/index-5bc28d6e.js";import{b as me}from"../../chunks/paths-d538d824.js";import{B as be,a as q,c as Q,r as de}from"../../chunks/game-c3d881e5.js";function pe(s){const e=s-1;return e*e*e+1}function X(s,{delay:e=0,duration:t=400,easing:l=U}={}){const n=+getComputedStyle(s).opacity;return{delay:e,duration:t,easing:l,css:o=>`opacity: ${o*n}`}}function Z(s,{delay:e=0,duration:t=400,easing:l=pe,x:n=0,y:o=0,opacity:c=0}={}){const u=getComputedStyle(s),r=+u.opacity,i=u.transform==="none"?"":u.transform,a=r*(1-c);return{delay:e,duration:t,easing:l,css:(g,f)=>`
			transform: ${i} translate(${(1-g)*n}px, ${(1-g)*o}px);
			opacity: ${r-a*f}`}}function x(s,e,t){const l=s.slice();return l[5]=e[t],l}function ee(s){let e,t,l=`var(--clr-wtr${s[5]})`,n;return{c(){e=I("div"),this.h()},l(o){e=y(o,"DIV",{class:!0}),D(e).forEach(m),this.h()},h(){w(e,"class","waterblock svelte-1ioo7u3"),F(e,"background-color",l)},m(o,c){v(o,e,c),n=!0},p(o,c){s=o,c&1&&l!==(l=`var(--clr-wtr${s[5]})`)&&F(e,"background-color",l)},i(o){n||(o&&ie(()=>{t||(t=J(e,Z,{y:-200,duration:200,easing:U},!0)),t.run(1)}),n=!0)},o(o){o&&(t||(t=J(e,Z,{y:-200,duration:200,easing:U},!1)),t.run(0)),n=!1},d(o){o&&m(e),o&&t&&t.end()}}}function $e(s){let e,t,l,n,o,c,u=s[0].name+"",r,i,a,g,f=s[0].levels,h=[];for(let _=0;_<f.length;_+=1)h[_]=ee(x(s,f,_));const S=_=>$(h[_],1,1,()=>{h[_]=null});return{c(){e=I("div"),t=I("div"),l=I("div"),n=B();for(let _=0;_<h.length;_+=1)h[_].c();o=B(),c=I("h4"),r=H(u),this.h()},l(_){e=y(_,"DIV",{class:!0});var b=D(e);t=y(b,"DIV",{class:!0,selectable:!0});var p=D(t);l=y(p,"DIV",{class:!0}),D(l).forEach(m),n=C(p);for(let E=0;E<h.length;E+=1)h[E].l(p);p.forEach(m),o=C(b),c=y(b,"H4",{class:!0});var k=D(c);r=O(k,u),k.forEach(m),b.forEach(m),this.h()},h(){w(l,"class","plug svelte-1ioo7u3"),w(t,"class","tube svelte-1ioo7u3"),w(t,"selectable",s[3]),P(t,"selected",s[1]),P(t,"highlight",s[2]),P(t,"unplugged",!s[0].done),w(c,"class","svelte-1ioo7u3"),w(e,"class","tube-slot")},m(_,b){v(_,e,b),V(e,t),V(t,l),V(t,n);for(let p=0;p<h.length;p+=1)h[p].m(t,null);V(e,o),V(e,c),V(c,r),i=!0,a||(g=ce(t,"click",s[4]),a=!0)},p(_,[b]){if(b&1){f=_[0].levels;let p;for(p=0;p<f.length;p+=1){const k=x(_,f,p);h[p]?(h[p].p(k,b),d(h[p],1)):(h[p]=ee(k),h[p].c(),d(h[p],1),h[p].m(t,null))}for(T(),p=f.length;p<h.length;p+=1)S(p);j()}(!i||b&8)&&w(t,"selectable",_[3]),(!i||b&2)&&P(t,"selected",_[1]),(!i||b&4)&&P(t,"highlight",_[2]),(!i||b&1)&&P(t,"unplugged",!_[0].done),(!i||b&1)&&u!==(u=_[0].name+"")&&fe(r,u)},i(_){if(!i){for(let b=0;b<f.length;b+=1)d(h[b]);i=!0}},o(_){h=h.filter(Boolean);for(let b=0;b<h.length;b+=1)$(h[b]);i=!1},d(_){_&&m(e),A(h,_),a=!1,g()}}}function ve(s,e,t){let{tube:l}=e,{selected:n=!1}=e,{highlight:o=!1}=e,{selectable:c}=e;function u(r){ae.call(this,s,r)}return s.$$set=r=>{"tube"in r&&t(0,l=r.tube),"selected"in r&&t(1,n=r.selected),"highlight"in r&&t(2,o=r.highlight),"selectable"in r&&t(3,c=r.selectable)},[l,n,o,c,u]}class ke extends Y{constructor(e){super(),z(this,e,ve,$e,K,{tube:0,selected:1,highlight:2,selectable:3})}}function te(s,e,t){const l=s.slice();return l[9]=e[t],l}function le(s,e,t){const l=s.slice();return l[12]=e[t],l}function ne(s){let e,t;function l(){return s[6](s[12])}return e=new ke({props:{tube:s[12],selected:s[0]===s[12].id,selectable:s[3](s[12].id,s[0]),highlight:s[1]===s[12].id}}),e.$on("click",l),{c(){N(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,o){W(e,n,o),t=!0},p(n,o){s=n;const c={};o&4&&(c.tube=s[12]),o&5&&(c.selected=s[0]===s[12].id),o&5&&(c.selectable=s[3](s[12].id,s[0])),o&6&&(c.highlight=s[1]===s[12].id),e.$set(c)},i(n){t||(d(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){G(e,n)}}}function se(s){let e,t,l,n=s[9],o=[];for(let u=0;u<n.length;u+=1)o[u]=ne(le(s,n,u));const c=u=>$(o[u],1,1,()=>{o[u]=null});return{c(){e=I("div");for(let u=0;u<o.length;u+=1)o[u].c();t=B(),this.h()},l(u){e=y(u,"DIV",{class:!0});var r=D(e);for(let i=0;i<o.length;i+=1)o[i].l(r);t=C(r),r.forEach(m),this.h()},h(){w(e,"class","tubes-row svelte-1m5libu")},m(u,r){v(u,e,r);for(let i=0;i<o.length;i+=1)o[i].m(e,null);V(e,t),l=!0},p(u,r){if(r&31){n=u[9];let i;for(i=0;i<n.length;i+=1){const a=le(u,n,i);o[i]?(o[i].p(a,r),d(o[i],1)):(o[i]=ne(a),o[i].c(),d(o[i],1),o[i].m(e,t))}for(T(),i=n.length;i<o.length;i+=1)c(i);j()}},i(u){if(!l){for(let r=0;r<n.length;r+=1)d(o[r]);l=!0}},o(u){o=o.filter(Boolean);for(let r=0;r<o.length;r+=1)$(o[r]);l=!1},d(u){u&&m(e),A(o,u)}}}function we(s){let e,t,l=s[2],n=[];for(let c=0;c<l.length;c+=1)n[c]=se(te(s,l,c));const o=c=>$(n[c],1,1,()=>{n[c]=null});return{c(){e=I("div");for(let c=0;c<n.length;c+=1)n[c].c();this.h()},l(c){e=y(c,"DIV",{class:!0});var u=D(e);for(let r=0;r<n.length;r+=1)n[r].l(u);u.forEach(m),this.h()},h(){w(e,"class","tubes-container")},m(c,u){v(c,e,u);for(let r=0;r<n.length;r+=1)n[r].m(e,null);t=!0},p(c,[u]){if(u&31){l=c[2];let r;for(r=0;r<l.length;r+=1){const i=te(c,l,r);n[r]?(n[r].p(i,u),d(n[r],1)):(n[r]=se(i),n[r].c(),d(n[r],1),n[r].m(e,null))}for(T(),r=l.length;r<n.length;r+=1)o(r);j()}},i(c){if(!t){for(let u=0;u<l.length;u+=1)d(n[u]);t=!0}},o(c){n=n.filter(Boolean);for(let u=0;u<n.length;u+=1)$(n[u]);t=!1},d(c){c&&m(e),A(n,c)}}}function Ee(s,e,t){const l=he();let{tubes:n}=e,{selected:o=null}=e,{highlight:c=null}=e,u=[];function r(f){const h=f.length<=6?f.length:f.length<=14?(f.length+1)/2:5,S=[];for(let _=0;_<f.length;_+=h)S.push(n.slice(_,_+h));return S}function i(f){return o===f?!0:!(n[f].done||o===null&&n[f].empty||o!==null&&n[f].full)}function a(f){i(f)&&l("select",f)}const g=f=>a(f.id);return s.$$set=f=>{"tubes"in f&&t(5,n=f.tubes),"selected"in f&&t(0,o=f.selected),"highlight"in f&&t(1,c=f.highlight)},s.$$.update=()=>{s.$$.dirty&32&&t(2,u=r(n))},[o,c,u,i,a,n,g]}class Ie extends Y{constructor(e){super(),z(this,e,Ee,we,K,{tubes:5,selected:0,highlight:1})}}function ye(s){let e,t,l,n,o,c;return{c(){e=I("div"),t=I("h2"),l=H(s[0]),this.h()},l(u){e=y(u,"DIV",{class:!0});var r=D(e);t=y(r,"H2",{});var i=D(t);l=O(i,s[0]),i.forEach(m),r.forEach(m),this.h()},h(){w(e,"class",n="modal "+(s[1]||"")+" svelte-alsri9")},m(u,r){v(u,e,r),V(e,t),V(t,l),c=!0},p(u,[r]){(!c||r&1)&&fe(l,u[0]),(!c||r&2&&n!==(n="modal "+(u[1]||"")+" svelte-alsri9"))&&w(e,"class",n)},i(u){c||(ie(()=>{o||(o=J(e,X,{delay:100},!0)),o.run(1)}),c=!0)},o(u){o||(o=J(e,X,{delay:100},!1)),o.run(0),c=!1},d(u){u&&m(e),u&&o&&o.end()}}}function De(s,e,t){let{message:l}=e,{result:n}=e;return s.$$set=o=>{"message"in o&&t(0,l=o.message),"result"in o&&t(1,n=o.result)},s.$$.update=()=>{s.$$.dirty&2&&console.log(n),s.$$.dirty&2&&t(0,l=n==="win"?"🏅 You Win 🏅":"You lose 😞")},[l,n]}class Se extends Y{constructor(e){super(),z(this,e,De,ye,K,{message:0,result:1})}}function Ve(){return new Worker(""+new URL("../../workers/solve-worker-c56cda26.js",import.meta.url).href)}function Be(s){let e;return{c(){e=H("New")},l(t){e=O(t,"New")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function Ce(s){let e;return{c(){e=H("Custom")},l(t){e=O(t,"Custom")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function Ne(s){let e;return{c(){e=H("Reset")},l(t){e=O(t,"Reset")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function oe(s){let e,t;return e=new q({props:{spin:s[2],$$slots:{default:[Me]},$$scope:{ctx:s}}}),e.$on("click",s[9]),{c(){N(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,n){W(e,l,n),t=!0},p(l,n){const o={};n&4&&(o.spin=l[2]),n&32768&&(o.$$scope={dirty:n,ctx:l}),e.$set(o)},i(l){t||(d(e.$$.fragment,l),t=!0)},o(l){$(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function Me(s){let e;return{c(){e=H("Solve")},l(t){e=O(t,"Solve")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function re(s){let e,t;return e=new q({props:{$$slots:{default:[We]},$$scope:{ctx:s}}}),e.$on("click",s[11]),{c(){N(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,n){W(e,l,n),t=!0},p(l,n){const o={};n&32768&&(o.$$scope={dirty:n,ctx:l}),e.$set(o)},i(l){t||(d(e.$$.fragment,l),t=!0)},o(l){$(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function We(s){let e;return{c(){e=H("💡")},l(t){e=O(t,"💡")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function Ge(s){let e,t,l,n,o,c,u,r,i;e=new q({props:{$$slots:{default:[Be]},$$scope:{ctx:s}}}),e.$on("click",s[7]),l=new q({props:{href:me+"/edit",$$slots:{default:[Ce]},$$scope:{ctx:s}}}),o=new q({props:{$$slots:{default:[Ne]},$$scope:{ctx:s}}}),o.$on("click",s[8]);let a=s[1]&&s[5].length==0&&oe(s),g=s[5].length>0&&re(s);return{c(){N(e.$$.fragment),t=B(),N(l.$$.fragment),n=B(),N(o.$$.fragment),c=B(),a&&a.c(),u=B(),g&&g.c(),r=L()},l(f){M(e.$$.fragment,f),t=C(f),M(l.$$.fragment,f),n=C(f),M(o.$$.fragment,f),c=C(f),a&&a.l(f),u=C(f),g&&g.l(f),r=L()},m(f,h){W(e,f,h),v(f,t,h),W(l,f,h),v(f,n,h),W(o,f,h),v(f,c,h),a&&a.m(f,h),v(f,u,h),g&&g.m(f,h),v(f,r,h),i=!0},p(f,h){const S={};h&32768&&(S.$$scope={dirty:h,ctx:f}),e.$set(S);const _={};h&32768&&(_.$$scope={dirty:h,ctx:f}),l.$set(_);const b={};h&32768&&(b.$$scope={dirty:h,ctx:f}),o.$set(b),f[1]&&f[5].length==0?a?(a.p(f,h),h&34&&d(a,1)):(a=oe(f),a.c(),d(a,1),a.m(u.parentNode,u)):a&&(T(),$(a,1,1,()=>{a=null}),j()),f[5].length>0?g?(g.p(f,h),h&32&&d(g,1)):(g=re(f),g.c(),d(g,1),g.m(r.parentNode,r)):g&&(T(),$(g,1,1,()=>{g=null}),j())},i(f){i||(d(e.$$.fragment,f),d(l.$$.fragment,f),d(o.$$.fragment,f),d(a),d(g),i=!0)},o(f){$(e.$$.fragment,f),$(l.$$.fragment,f),$(o.$$.fragment,f),$(a),$(g),i=!1},d(f){G(e,f),f&&m(t),G(l,f),f&&m(n),G(o,f),f&&m(c),a&&a.d(f),f&&m(u),g&&g.d(f),f&&m(r)}}}function ue(s){let e,t;return e=new Se({props:{result:s[3].status}}),{c(){N(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,n){W(e,l,n),t=!0},p(l,n){const o={};n&8&&(o.result=l[3].status),e.$set(o)},i(l){t||(d(e.$$.fragment,l),t=!0)},o(l){$(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function Re(s){let e,t,l,n,o,c,u;e=new be({props:{$$slots:{default:[Ge]},$$scope:{ctx:s}}}),n=new Ie({props:{tubes:s[3].tubes,selected:s[0],selectable:s[4],highlight:s[6]}}),n.$on("select",s[10]);let r=s[3].status&&ue(s);return{c(){N(e.$$.fragment),t=B(),l=I("div"),N(n.$$.fragment),o=B(),r&&r.c(),c=L(),this.h()},l(i){M(e.$$.fragment,i),t=C(i),l=y(i,"DIV",{class:!0});var a=D(l);M(n.$$.fragment,a),a.forEach(m),o=C(i),r&&r.l(i),c=L(),this.h()},h(){w(l,"class","cols-2 svelte-m2jv0k")},m(i,a){W(e,i,a),v(i,t,a),v(i,l,a),W(n,l,null),v(i,o,a),r&&r.m(i,a),v(i,c,a),u=!0},p(i,[a]){const g={};a&32806&&(g.$$scope={dirty:a,ctx:i}),e.$set(g);const f={};a&8&&(f.tubes=i[3].tubes),a&1&&(f.selected=i[0]),a&16&&(f.selectable=i[4]),a&64&&(f.highlight=i[6]),n.$set(f),i[3].status?r?(r.p(i,a),a&8&&d(r,1)):(r=ue(i),r.c(),d(r,1),r.m(c.parentNode,c)):r&&(T(),$(r,1,1,()=>{r=null}),j())},i(i){u||(d(e.$$.fragment,i),d(n.$$.fragment,i),d(r),u=!0)},o(i){$(e.$$.fragment,i),$(n.$$.fragment,i),$(r),u=!1},d(i){G(e,i),i&&m(t),i&&m(l),G(n),i&&m(o),r&&r.d(i),i&&m(c)}}}function He(s,e,t){let l;_e(s,Q,k=>t(13,l=k));let n,o=!1,c=l,u=null,r,i=[],a=[],g=null;ge(async()=>{t(1,n=new Ve),t(1,n.onmessage=function(k){k.data.result==="win"&&(t(5,a=k.data.actions),console.debug(a)),t(2,o=!1)},n)});function f(){console.debug("generating new game"),Q.set(de()),t(3,c=l),i=[],t(5,a=[]),t(6,g=null)}function h(){t(3,c=l),t(0,u=null),i=[],t(5,a=[]),t(6,g=null)}function S(){n.postMessage(c),t(2,o=!0)}function _(k){const E=k.detail;if(u===null)t(0,u=E),console.debug(`selecting ${u}`);else if(u===E)console.debug(`deselecting ${u}`),t(0,u=null);else{if(b(u,E),a.length>0){const R=a[0];E===R.toIndex&&u===R.fromIndex?t(5,a=a.slice(1)):t(5,a=[])}t(0,u=null),t(6,g=null)}}function b(k,E){try{const R=c.historyEntry({from:k,to:E});t(3,c=c.applyMove({from:k,to:E})),console.debug(`applied move ${JSON.stringify(R)}`),i=[...i,R]}catch(R){console.log(R.message)}}function p(){a.length>0&&(t(0,u=a[0].fromIndex),t(6,g=a[0].toIndex))}return s.$$.update=()=>{s.$$.dirty&1&&t(4,r=u?"non-full":"non-empty")},[u,n,o,c,r,a,g,f,h,S,_,p]}class je extends Y{constructor(e){super(),z(this,e,He,Re,K,{})}}export{je as default};
