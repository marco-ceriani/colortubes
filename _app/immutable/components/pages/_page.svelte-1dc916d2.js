import{I as Q,S as j,i as J,s as Y,k as I,a as N,q as M,l as y,m as D,h as m,c as C,r as V,n as E,J as H,b as $,D as k,K as _e,f as b,g as P,d as R,u as O,t as v,L as U,p as z,M as he,N as A,O as ge,P as me,w as q,x as G,y as L,z as W,B as X,e as K,H as de,o as be}from"../../chunks/index-5bc28d6e.js";import{b as pe}from"../../chunks/paths-d538d824.js";import{B as ve,G as F,a as T,c as Z,r as $e}from"../../chunks/game-e6546d15.js";function ke(o){const e=o-1;return e*e*e+1}function x(o,{delay:e=0,duration:t=400,easing:l=Q}={}){const n=+getComputedStyle(o).opacity;return{delay:e,duration:t,easing:l,css:s=>`opacity: ${s*n}`}}function ee(o,{delay:e=0,duration:t=400,easing:l=ke,x:n=0,y:s=0,opacity:c=0}={}){const u=getComputedStyle(o),f=+u.opacity,a=u.transform==="none"?"":u.transform,i=f*(1-c);return{delay:e,duration:t,easing:l,css:(h,r)=>`
			transform: ${a} translate(${(1-h)*n}px, ${(1-h)*s}px);
			opacity: ${f-i*r}`}}function te(o,e,t){const l=o.slice();return l[5]=e[t],l}function le(o){let e,t,l=`var(--clr-wtr${o[5]})`,n;return{c(){e=I("div"),this.h()},l(s){e=y(s,"DIV",{class:!0}),D(e).forEach(m),this.h()},h(){E(e,"class","waterblock svelte-13yaq6d"),z(e,"background-color",l)},m(s,c){$(s,e,c),n=!0},p(s,c){o=s,c&1&&l!==(l=`var(--clr-wtr${o[5]})`)&&z(e,"background-color",l)},i(s){n||(s&&he(()=>{t||(t=A(e,ee,{y:-200,duration:200,easing:Q},!0)),t.run(1)}),n=!0)},o(s){s&&(t||(t=A(e,ee,{y:-200,duration:200,easing:Q},!1)),t.run(0)),n=!1},d(s){s&&m(e),s&&t&&t.end()}}}function we(o){let e,t,l,n,s,c,u=o[0].name+"",f,a,i,h,r=o[0].levels,_=[];for(let g=0;g<r.length;g+=1)_[g]=le(te(o,r,g));const w=g=>v(_[g],1,1,()=>{_[g]=null});return{c(){e=I("div"),t=I("div"),l=I("div"),n=N();for(let g=0;g<_.length;g+=1)_[g].c();s=N(),c=I("h4"),f=M(u),this.h()},l(g){e=y(g,"DIV",{class:!0});var p=D(e);t=y(p,"DIV",{class:!0,selectable:!0});var d=D(t);l=y(d,"DIV",{class:!0}),D(l).forEach(m),n=C(d);for(let B=0;B<_.length;B+=1)_[B].l(d);d.forEach(m),s=C(p),c=y(p,"H4",{class:!0});var S=D(c);f=V(S,u),S.forEach(m),p.forEach(m),this.h()},h(){E(l,"class","plug svelte-13yaq6d"),E(t,"class","tube svelte-13yaq6d"),E(t,"selectable",o[3]),H(t,"selected",o[1]),H(t,"highlight",o[2]),H(t,"unplugged",!o[0].done),E(c,"class","svelte-13yaq6d"),E(e,"class","tube-slot")},m(g,p){$(g,e,p),k(e,t),k(t,l),k(t,n);for(let d=0;d<_.length;d+=1)_[d].m(t,null);k(e,s),k(e,c),k(c,f),a=!0,i||(h=_e(t,"click",o[4]),i=!0)},p(g,[p]){if(p&1){r=g[0].levels;let d;for(d=0;d<r.length;d+=1){const S=te(g,r,d);_[d]?(_[d].p(S,p),b(_[d],1)):(_[d]=le(S),_[d].c(),b(_[d],1),_[d].m(t,null))}for(P(),d=r.length;d<_.length;d+=1)w(d);R()}(!a||p&8)&&E(t,"selectable",g[3]),(!a||p&2)&&H(t,"selected",g[1]),(!a||p&4)&&H(t,"highlight",g[2]),(!a||p&1)&&H(t,"unplugged",!g[0].done),(!a||p&1)&&u!==(u=g[0].name+"")&&O(f,u)},i(g){if(!a){for(let p=0;p<r.length;p+=1)b(_[p]);a=!0}},o(g){_=_.filter(Boolean);for(let p=0;p<_.length;p+=1)v(_[p]);a=!1},d(g){g&&m(e),U(_,g),i=!1,h()}}}function Ee(o,e,t){let{tube:l}=e,{selected:n=!1}=e,{highlight:s=!1}=e,{selectable:c}=e;function u(f){ge.call(this,o,f)}return o.$$set=f=>{"tube"in f&&t(0,l=f.tube),"selected"in f&&t(1,n=f.selected),"highlight"in f&&t(2,s=f.highlight),"selectable"in f&&t(3,c=f.selectable)},[l,n,s,c,u]}class Ie extends j{constructor(e){super(),J(this,e,Ee,we,Y,{tube:0,selected:1,highlight:2,selectable:3})}}function se(o,e,t){const l=o.slice();return l[9]=e[t],l}function ne(o,e,t){const l=o.slice();return l[12]=e[t],l}function oe(o){let e,t;function l(){return o[6](o[12])}return e=new Ie({props:{tube:o[12],selected:o[0]===o[12].id,selectable:o[3](o[12].id,o[0]),highlight:o[1]===o[12].id}}),e.$on("click",l),{c(){q(e.$$.fragment)},l(n){G(e.$$.fragment,n)},m(n,s){L(e,n,s),t=!0},p(n,s){o=n;const c={};s&4&&(c.tube=o[12]),s&5&&(c.selected=o[0]===o[12].id),s&5&&(c.selectable=o[3](o[12].id,o[0])),s&6&&(c.highlight=o[1]===o[12].id),e.$set(c)},i(n){t||(b(e.$$.fragment,n),t=!0)},o(n){v(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function re(o){let e,t,l,n=o[9],s=[];for(let u=0;u<n.length;u+=1)s[u]=oe(ne(o,n,u));const c=u=>v(s[u],1,1,()=>{s[u]=null});return{c(){e=I("div");for(let u=0;u<s.length;u+=1)s[u].c();t=N(),this.h()},l(u){e=y(u,"DIV",{class:!0});var f=D(e);for(let a=0;a<s.length;a+=1)s[a].l(f);t=C(f),f.forEach(m),this.h()},h(){E(e,"class","tubes-row svelte-1m5libu")},m(u,f){$(u,e,f);for(let a=0;a<s.length;a+=1)s[a].m(e,null);k(e,t),l=!0},p(u,f){if(f&31){n=u[9];let a;for(a=0;a<n.length;a+=1){const i=ne(u,n,a);s[a]?(s[a].p(i,f),b(s[a],1)):(s[a]=oe(i),s[a].c(),b(s[a],1),s[a].m(e,t))}for(P(),a=n.length;a<s.length;a+=1)c(a);R()}},i(u){if(!l){for(let f=0;f<n.length;f+=1)b(s[f]);l=!0}},o(u){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)v(s[f]);l=!1},d(u){u&&m(e),U(s,u)}}}function ye(o){let e,t,l=o[2],n=[];for(let c=0;c<l.length;c+=1)n[c]=re(se(o,l,c));const s=c=>v(n[c],1,1,()=>{n[c]=null});return{c(){e=I("div");for(let c=0;c<n.length;c+=1)n[c].c();this.h()},l(c){e=y(c,"DIV",{class:!0});var u=D(e);for(let f=0;f<n.length;f+=1)n[f].l(u);u.forEach(m),this.h()},h(){E(e,"class","tubes-container")},m(c,u){$(c,e,u);for(let f=0;f<n.length;f+=1)n[f].m(e,null);t=!0},p(c,[u]){if(u&31){l=c[2];let f;for(f=0;f<l.length;f+=1){const a=se(c,l,f);n[f]?(n[f].p(a,u),b(n[f],1)):(n[f]=re(a),n[f].c(),b(n[f],1),n[f].m(e,null))}for(P(),f=l.length;f<n.length;f+=1)s(f);R()}},i(c){if(!t){for(let u=0;u<l.length;u+=1)b(n[u]);t=!0}},o(c){n=n.filter(Boolean);for(let u=0;u<n.length;u+=1)v(n[u]);t=!1},d(c){c&&m(e),U(n,c)}}}function De(o,e,t){const l=me();let{tubes:n}=e,{selected:s=null}=e,{highlight:c=null}=e,u=[];function f(r){const _=r.length<=6?r.length:r.length<=14?(r.length+1)/2:5,w=[];for(let g=0;g<r.length;g+=_)w.push(n.slice(g,g+_));return w}function a(r){return s===r?!0:!(n[r].done||s===null&&n[r].empty||s!==null&&n[r].full)}function i(r){a(r)&&l("select",r)}const h=r=>i(r.id);return o.$$set=r=>{"tubes"in r&&t(5,n=r.tubes),"selected"in r&&t(0,s=r.selected),"highlight"in r&&t(1,c=r.highlight)},o.$$.update=()=>{o.$$.dirty&32&&t(2,u=f(n))},[s,c,u,a,i,n,h]}class Se extends j{constructor(e){super(),J(this,e,De,ye,Y,{tubes:5,selected:0,highlight:1})}}function fe(o,e,t){const l=o.slice();return l[2]=e[t],l}function ue(o){let e,t,l=o[2].amount+"",n,s=`var(--clr-wtr${o[2].color})`,c,u=o[2].fromId+"",f,a,i=o[2].toId+"",h;return{c(){e=I("li"),t=I("span"),n=M(l),c=M(" from "),f=M(u),a=M(" to "),h=M(i),this.h()},l(r){e=y(r,"LI",{class:!0});var _=D(e);t=y(_,"SPAN",{class:!0});var w=D(t);n=V(w,l),w.forEach(m),c=V(_," from "),f=V(_,u),a=V(_," to "),h=V(_,i),_.forEach(m),this.h()},h(){E(t,"class","amount svelte-5cl2gs"),z(t,"background-color",s),E(e,"class","svelte-5cl2gs")},m(r,_){$(r,e,_),k(e,t),k(t,n),k(e,c),k(e,f),k(e,a),k(e,h)},p(r,_){_&2&&l!==(l=r[2].amount+"")&&O(n,l),_&2&&s!==(s=`var(--clr-wtr${r[2].color})`)&&z(t,"background-color",s),_&2&&u!==(u=r[2].fromId+"")&&O(f,u),_&2&&i!==(i=r[2].toId+"")&&O(h,i)},d(r){r&&m(e)}}}function Me(o){let e,t,l,n,s,c=o[1],u=[];for(let f=0;f<c.length;f+=1)u[f]=ue(fe(o,c,f));return{c(){e=I("div"),t=I("h3"),l=M(o[0]),n=N(),s=I("ol");for(let f=0;f<u.length;f+=1)u[f].c();this.h()},l(f){e=y(f,"DIV",{class:!0});var a=D(e);t=y(a,"H3",{});var i=D(t);l=V(i,o[0]),i.forEach(m),n=C(a),s=y(a,"OL",{class:!0});var h=D(s);for(let r=0;r<u.length;r+=1)u[r].l(h);h.forEach(m),a.forEach(m),this.h()},h(){E(s,"class","svelte-5cl2gs"),E(e,"class","log svelte-5cl2gs")},m(f,a){$(f,e,a),k(e,t),k(t,l),k(e,n),k(e,s);for(let i=0;i<u.length;i+=1)u[i].m(s,null)},p(f,[a]){if(a&1&&O(l,f[0]),a&2){c=f[1];let i;for(i=0;i<c.length;i+=1){const h=fe(f,c,i);u[i]?u[i].p(h,a):(u[i]=ue(h),u[i].c(),u[i].m(s,null))}for(;i<u.length;i+=1)u[i].d(1);u.length=c.length}},i:X,o:X,d(f){f&&m(e),U(u,f)}}}function Ve(o,e,t){let{title:l="Moves"}=e,{moves:n=[]}=e;return o.$$set=s=>{"title"in s&&t(0,l=s.title),"moves"in s&&t(1,n=s.moves)},[l,n]}class Be extends j{constructor(e){super(),J(this,e,Ve,Me,Y,{title:0,moves:1})}}function Ne(o){let e,t,l,n,s,c;return{c(){e=I("div"),t=I("h2"),l=M(o[0]),this.h()},l(u){e=y(u,"DIV",{class:!0});var f=D(e);t=y(f,"H2",{});var a=D(t);l=V(a,o[0]),a.forEach(m),f.forEach(m),this.h()},h(){E(e,"class",n="modal "+(o[1]||"")+" svelte-alsri9")},m(u,f){$(u,e,f),k(e,t),k(t,l),c=!0},p(u,[f]){(!c||f&1)&&O(l,u[0]),(!c||f&2&&n!==(n="modal "+(u[1]||"")+" svelte-alsri9"))&&E(e,"class",n)},i(u){c||(he(()=>{s||(s=A(e,x,{delay:100},!0)),s.run(1)}),c=!0)},o(u){s||(s=A(e,x,{delay:100},!1)),s.run(0),c=!1},d(u){u&&m(e),u&&s&&s.end()}}}function Ce(o,e,t){let{message:l}=e,{result:n}=e;return o.$$set=s=>{"message"in s&&t(0,l=s.message),"result"in s&&t(1,n=s.result)},o.$$.update=()=>{o.$$.dirty&2&&console.log(n),o.$$.dirty&2&&t(0,l=n==="win"?"ðŸ… You Win ðŸ…":"You lose ðŸ˜ž")},[l,n]}class qe extends j{constructor(e){super(),J(this,e,Ce,Ne,Y,{message:0,result:1})}}function Ge(){return new Worker(""+new URL("../../workers/solve-worker-562c52e6.js",import.meta.url).href)}function Le(o){let e;return{c(){e=M("Custom")},l(t){e=V(t,"Custom")},m(t,l){$(t,e,l)},d(t){t&&m(e)}}}function We(o){let e;return{c(){e=M("New")},l(t){e=V(t,"New")},m(t,l){$(t,e,l)},d(t){t&&m(e)}}}function He(o){let e;return{c(){e=M("Reset")},l(t){e=V(t,"Reset")},m(t,l){$(t,e,l)},d(t){t&&m(e)}}}function ce(o){let e,t;return e=new T({props:{$$slots:{default:[Oe]},$$scope:{ctx:o}}}),e.$on("click",o[9]),{c(){q(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,n){L(e,l,n),t=!0},p(l,n){const s={};n&16384&&(s.$$scope={dirty:n,ctx:l}),e.$set(s)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){v(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Oe(o){let e;return{c(){e=M("Solve")},l(t){e=V(t,"Solve")},m(t,l){$(t,e,l)},d(t){t&&m(e)}}}function ie(o){let e,t;return e=new T({props:{$$slots:{default:[Pe]},$$scope:{ctx:o}}}),e.$on("click",o[11]),{c(){q(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,n){L(e,l,n),t=!0},p(l,n){const s={};n&16384&&(s.$$scope={dirty:n,ctx:l}),e.$set(s)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){v(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Pe(o){let e;return{c(){e=M("ðŸ’¡")},l(t){e=V(t,"ðŸ’¡")},m(t,l){$(t,e,l)},d(t){t&&m(e)}}}function Re(o){let e,t,l,n,s,c,u,f,a;e=new T({props:{href:pe+"/edit",$$slots:{default:[Le]},$$scope:{ctx:o}}}),l=new T({props:{$$slots:{default:[We]},$$scope:{ctx:o}}}),l.$on("click",o[7]),s=new T({props:{$$slots:{default:[He]},$$scope:{ctx:o}}}),s.$on("click",o[8]);let i=o[1]&&o[5].length==0&&ce(o),h=o[5].length>0&&ie(o);return{c(){q(e.$$.fragment),t=N(),q(l.$$.fragment),n=N(),q(s.$$.fragment),c=N(),i&&i.c(),u=N(),h&&h.c(),f=K()},l(r){G(e.$$.fragment,r),t=C(r),G(l.$$.fragment,r),n=C(r),G(s.$$.fragment,r),c=C(r),i&&i.l(r),u=C(r),h&&h.l(r),f=K()},m(r,_){L(e,r,_),$(r,t,_),L(l,r,_),$(r,n,_),L(s,r,_),$(r,c,_),i&&i.m(r,_),$(r,u,_),h&&h.m(r,_),$(r,f,_),a=!0},p(r,_){const w={};_&16384&&(w.$$scope={dirty:_,ctx:r}),e.$set(w);const g={};_&16384&&(g.$$scope={dirty:_,ctx:r}),l.$set(g);const p={};_&16384&&(p.$$scope={dirty:_,ctx:r}),s.$set(p),r[1]&&r[5].length==0?i?(i.p(r,_),_&34&&b(i,1)):(i=ce(r),i.c(),b(i,1),i.m(u.parentNode,u)):i&&(P(),v(i,1,1,()=>{i=null}),R()),r[5].length>0?h?(h.p(r,_),_&32&&b(h,1)):(h=ie(r),h.c(),b(h,1),h.m(f.parentNode,f)):h&&(P(),v(h,1,1,()=>{h=null}),R())},i(r){a||(b(e.$$.fragment,r),b(l.$$.fragment,r),b(s.$$.fragment,r),b(i),b(h),a=!0)},o(r){v(e.$$.fragment,r),v(l.$$.fragment,r),v(s.$$.fragment,r),v(i),v(h),a=!1},d(r){W(e,r),r&&m(t),W(l,r),r&&m(n),W(s,r),r&&m(c),i&&i.d(r),r&&m(u),h&&h.d(r),r&&m(f)}}}function ae(o){let e,t;return e=new qe({props:{result:o[2].status}}),{c(){q(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,n){L(e,l,n),t=!0},p(l,n){const s={};n&4&&(s.result=l[2].status),e.$set(s)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){v(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Te(o){let e,t,l,n,s,c,u,f,a;e=new ve({props:{$$slots:{default:[Re]},$$scope:{ctx:o}}}),n=new Se({props:{tubes:o[2].tubes,selected:o[0],selectable:o[3],highlight:o[6]}}),n.$on("select",o[10]),c=new Be({props:{moves:o[4]}});let i=o[2].status&&ae(o);return{c(){q(e.$$.fragment),t=N(),l=I("div"),q(n.$$.fragment),s=N(),q(c.$$.fragment),u=N(),i&&i.c(),f=K(),this.h()},l(h){G(e.$$.fragment,h),t=C(h),l=y(h,"DIV",{class:!0});var r=D(l);G(n.$$.fragment,r),s=C(r),G(c.$$.fragment,r),r.forEach(m),u=C(h),i&&i.l(h),f=K(),this.h()},h(){E(l,"class","cols-2 svelte-m2jv0k")},m(h,r){L(e,h,r),$(h,t,r),$(h,l,r),L(n,l,null),k(l,s),L(c,l,null),$(h,u,r),i&&i.m(h,r),$(h,f,r),a=!0},p(h,[r]){const _={};r&16418&&(_.$$scope={dirty:r,ctx:h}),e.$set(_);const w={};r&4&&(w.tubes=h[2].tubes),r&1&&(w.selected=h[0]),r&8&&(w.selectable=h[3]),r&64&&(w.highlight=h[6]),n.$set(w);const g={};r&16&&(g.moves=h[4]),c.$set(g),h[2].status?i?(i.p(h,r),r&4&&b(i,1)):(i=ae(h),i.c(),b(i,1),i.m(f.parentNode,f)):i&&(P(),v(i,1,1,()=>{i=null}),R())},i(h){a||(b(e.$$.fragment,h),b(n.$$.fragment,h),b(c.$$.fragment,h),b(i),a=!0)},o(h){v(e.$$.fragment,h),v(n.$$.fragment,h),v(c.$$.fragment,h),v(i),a=!1},d(h){W(e,h),h&&m(t),h&&m(l),W(n),W(c),h&&m(u),i&&i.d(h),h&&m(f)}}}function je(o,e,t){let l;de(o,Z,d=>t(12,l=d));let n,s=new F(l),c=null,u,f=[],a=[],i=null;be(async()=>{t(1,n=new Ge),t(1,n.onmessage=function(d){t(5,a=d.data.actions),console.log(a)},n)});function h(){console.debug("generating new game"),Z.set($e()),t(2,s=new F(l)),t(4,f=[]),t(5,a=[]),t(6,i=null)}function r(){t(2,s=new F(l)),t(0,c=null),t(4,f=[]),t(5,a=[]),t(6,i=null)}function _(){n.postMessage(s)}function w(d){const S=d.detail;if(c===null)t(0,c=S),console.debug(`selecting ${c}`);else if(c===S)console.debug(`deselecting ${c}`),t(0,c=null);else{if(g(c,S),a.length>0){const B=a[0];S===B.toIndex&&c===B.fromIndex?t(5,a=a.slice(1)):t(5,a=[])}t(0,c=null),t(6,i=null)}}function g(d,S){try{const B=s.historyEntry({from:d,to:S});t(2,s=s.applyMove({from:d,to:S})),console.debug(`applied move ${JSON.stringify(B)}`),t(4,f=[...f,B])}catch(B){console.log(B.message)}}function p(){a.length>0&&(t(0,c=a[0].fromIndex),t(6,i=a[0].toIndex))}return o.$$.update=()=>{o.$$.dirty&1&&t(3,u=c?"non-full":"non-empty")},[c,n,s,u,f,a,i,h,r,_,w,p]}class Ae extends j{constructor(e){super(),J(this,e,je,Te,Y,{})}}export{Ae as default};
