import{I as Q,S as j,i as J,s as Y,k as I,a as N,q as S,l as y,m as D,h as m,c as C,r as M,n as E,J as H,b as $,D as k,K as _e,f as b,g as P,d as R,u as O,t as p,L as U,p as z,M as he,N as A,O as ge,P as me,w as q,x as G,y as L,z as W,B as X,e as K,H as de,o as be}from"../../chunks/index-5bc28d6e.js";import{b as ve}from"../../chunks/paths-d538d824.js";import{B as pe,G as F,a as T,c as Z,r as $e}from"../../chunks/game-e6546d15.js";function ke(o){const e=o-1;return e*e*e+1}function x(o,{delay:e=0,duration:t=400,easing:l=Q}={}){const s=+getComputedStyle(o).opacity;return{delay:e,duration:t,easing:l,css:n=>`opacity: ${n*s}`}}function ee(o,{delay:e=0,duration:t=400,easing:l=ke,x:s=0,y:n=0,opacity:i=0}={}){const u=getComputedStyle(o),f=+u.opacity,a=u.transform==="none"?"":u.transform,c=f*(1-i);return{delay:e,duration:t,easing:l,css:(h,r)=>`
			transform: ${a} translate(${(1-h)*s}px, ${(1-h)*n}px);
			opacity: ${f-c*r}`}}function te(o,e,t){const l=o.slice();return l[5]=e[t],l}function le(o){let e,t,l=`var(--clr-wtr${o[5]})`,s;return{c(){e=I("div"),this.h()},l(n){e=y(n,"DIV",{class:!0}),D(e).forEach(m),this.h()},h(){E(e,"class","waterblock svelte-13yaq6d"),z(e,"background-color",l)},m(n,i){$(n,e,i),s=!0},p(n,i){o=n,i&1&&l!==(l=`var(--clr-wtr${o[5]})`)&&z(e,"background-color",l)},i(n){s||(n&&he(()=>{t||(t=A(e,ee,{y:-200,duration:200,easing:Q},!0)),t.run(1)}),s=!0)},o(n){n&&(t||(t=A(e,ee,{y:-200,duration:200,easing:Q},!1)),t.run(0)),s=!1},d(n){n&&m(e),n&&t&&t.end()}}}function we(o){let e,t,l,s,n,i,u=o[0].name+"",f,a,c,h,r=o[0].levels,_=[];for(let g=0;g<r.length;g+=1)_[g]=le(te(o,r,g));const w=g=>p(_[g],1,1,()=>{_[g]=null});return{c(){e=I("div"),t=I("div"),l=I("div"),s=N();for(let g=0;g<_.length;g+=1)_[g].c();n=N(),i=I("h4"),f=S(u),this.h()},l(g){e=y(g,"DIV",{class:!0});var v=D(e);t=y(v,"DIV",{class:!0,selectable:!0});var d=D(t);l=y(d,"DIV",{class:!0}),D(l).forEach(m),s=C(d);for(let B=0;B<_.length;B+=1)_[B].l(d);d.forEach(m),n=C(v),i=y(v,"H4",{class:!0});var V=D(i);f=M(V,u),V.forEach(m),v.forEach(m),this.h()},h(){E(l,"class","plug svelte-13yaq6d"),E(t,"class","tube svelte-13yaq6d"),E(t,"selectable",o[3]),H(t,"selected",o[1]),H(t,"highlight",o[2]),H(t,"unplugged",!o[0].done),E(i,"class","svelte-13yaq6d"),E(e,"class","tube-slot")},m(g,v){$(g,e,v),k(e,t),k(t,l),k(t,s);for(let d=0;d<_.length;d+=1)_[d].m(t,null);k(e,n),k(e,i),k(i,f),a=!0,c||(h=_e(t,"click",o[4]),c=!0)},p(g,[v]){if(v&1){r=g[0].levels;let d;for(d=0;d<r.length;d+=1){const V=te(g,r,d);_[d]?(_[d].p(V,v),b(_[d],1)):(_[d]=le(V),_[d].c(),b(_[d],1),_[d].m(t,null))}for(P(),d=r.length;d<_.length;d+=1)w(d);R()}(!a||v&8)&&E(t,"selectable",g[3]),(!a||v&2)&&H(t,"selected",g[1]),(!a||v&4)&&H(t,"highlight",g[2]),(!a||v&1)&&H(t,"unplugged",!g[0].done),(!a||v&1)&&u!==(u=g[0].name+"")&&O(f,u)},i(g){if(!a){for(let v=0;v<r.length;v+=1)b(_[v]);a=!0}},o(g){_=_.filter(Boolean);for(let v=0;v<_.length;v+=1)p(_[v]);a=!1},d(g){g&&m(e),U(_,g),c=!1,h()}}}function Ee(o,e,t){let{tube:l}=e,{selected:s=!1}=e,{highlight:n=!1}=e,{selectable:i}=e;function u(f){ge.call(this,o,f)}return o.$$set=f=>{"tube"in f&&t(0,l=f.tube),"selected"in f&&t(1,s=f.selected),"highlight"in f&&t(2,n=f.highlight),"selectable"in f&&t(3,i=f.selectable)},[l,s,n,i,u]}class Ie extends j{constructor(e){super(),J(this,e,Ee,we,Y,{tube:0,selected:1,highlight:2,selectable:3})}}function ne(o,e,t){const l=o.slice();return l[9]=e[t],l}function se(o,e,t){const l=o.slice();return l[12]=e[t],l}function oe(o){let e,t;function l(){return o[6](o[12])}return e=new Ie({props:{tube:o[12],selected:o[0]===o[12].id,selectable:o[3](o[12].id,o[0]),highlight:o[1]===o[12].id}}),e.$on("click",l),{c(){q(e.$$.fragment)},l(s){G(e.$$.fragment,s)},m(s,n){L(e,s,n),t=!0},p(s,n){o=s;const i={};n&4&&(i.tube=o[12]),n&5&&(i.selected=o[0]===o[12].id),n&5&&(i.selectable=o[3](o[12].id,o[0])),n&6&&(i.highlight=o[1]===o[12].id),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){p(e.$$.fragment,s),t=!1},d(s){W(e,s)}}}function re(o){let e,t,l,s=o[9],n=[];for(let u=0;u<s.length;u+=1)n[u]=oe(se(o,s,u));const i=u=>p(n[u],1,1,()=>{n[u]=null});return{c(){e=I("div");for(let u=0;u<n.length;u+=1)n[u].c();t=N(),this.h()},l(u){e=y(u,"DIV",{class:!0});var f=D(e);for(let a=0;a<n.length;a+=1)n[a].l(f);t=C(f),f.forEach(m),this.h()},h(){E(e,"class","tubes-row svelte-1m5libu")},m(u,f){$(u,e,f);for(let a=0;a<n.length;a+=1)n[a].m(e,null);k(e,t),l=!0},p(u,f){if(f&31){s=u[9];let a;for(a=0;a<s.length;a+=1){const c=se(u,s,a);n[a]?(n[a].p(c,f),b(n[a],1)):(n[a]=oe(c),n[a].c(),b(n[a],1),n[a].m(e,t))}for(P(),a=s.length;a<n.length;a+=1)i(a);R()}},i(u){if(!l){for(let f=0;f<s.length;f+=1)b(n[f]);l=!0}},o(u){n=n.filter(Boolean);for(let f=0;f<n.length;f+=1)p(n[f]);l=!1},d(u){u&&m(e),U(n,u)}}}function ye(o){let e,t,l=o[2],s=[];for(let i=0;i<l.length;i+=1)s[i]=re(ne(o,l,i));const n=i=>p(s[i],1,1,()=>{s[i]=null});return{c(){e=I("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=y(i,"DIV",{class:!0});var u=D(e);for(let f=0;f<s.length;f+=1)s[f].l(u);u.forEach(m),this.h()},h(){E(e,"class","tubes-container")},m(i,u){$(i,e,u);for(let f=0;f<s.length;f+=1)s[f].m(e,null);t=!0},p(i,[u]){if(u&31){l=i[2];let f;for(f=0;f<l.length;f+=1){const a=ne(i,l,f);s[f]?(s[f].p(a,u),b(s[f],1)):(s[f]=re(a),s[f].c(),b(s[f],1),s[f].m(e,null))}for(P(),f=l.length;f<s.length;f+=1)n(f);R()}},i(i){if(!t){for(let u=0;u<l.length;u+=1)b(s[u]);t=!0}},o(i){s=s.filter(Boolean);for(let u=0;u<s.length;u+=1)p(s[u]);t=!1},d(i){i&&m(e),U(s,i)}}}function De(o,e,t){const l=me();let{tubes:s}=e,{selected:n=null}=e,{highlight:i=null}=e,u=[];function f(r){const _=r.length<=6?r.length:r.length<=14?(r.length+1)/2:5,w=[];for(let g=0;g<r.length;g+=_)w.push(s.slice(g,g+_));return w}function a(r){return n===r?!0:!(s[r].done||n===null&&s[r].empty||n!==null&&s[r].full)}function c(r){a(r)&&l("select",r)}const h=r=>c(r.id);return o.$$set=r=>{"tubes"in r&&t(5,s=r.tubes),"selected"in r&&t(0,n=r.selected),"highlight"in r&&t(1,i=r.highlight)},o.$$.update=()=>{o.$$.dirty&32&&t(2,u=f(s))},[n,i,u,a,c,s,h]}class Se extends j{constructor(e){super(),J(this,e,De,ye,Y,{tubes:5,selected:0,highlight:1})}}function fe(o,e,t){const l=o.slice();return l[2]=e[t],l}function ue(o){let e,t,l=o[2].amount+"",s,n=`var(--clr-wtr${o[2].color})`,i,u=o[2].fromId+"",f,a,c=o[2].toId+"",h;return{c(){e=I("li"),t=I("span"),s=S(l),i=S(" from "),f=S(u),a=S(" to "),h=S(c),this.h()},l(r){e=y(r,"LI",{class:!0});var _=D(e);t=y(_,"SPAN",{class:!0});var w=D(t);s=M(w,l),w.forEach(m),i=M(_," from "),f=M(_,u),a=M(_," to "),h=M(_,c),_.forEach(m),this.h()},h(){E(t,"class","amount svelte-5cl2gs"),z(t,"background-color",n),E(e,"class","svelte-5cl2gs")},m(r,_){$(r,e,_),k(e,t),k(t,s),k(e,i),k(e,f),k(e,a),k(e,h)},p(r,_){_&2&&l!==(l=r[2].amount+"")&&O(s,l),_&2&&n!==(n=`var(--clr-wtr${r[2].color})`)&&z(t,"background-color",n),_&2&&u!==(u=r[2].fromId+"")&&O(f,u),_&2&&c!==(c=r[2].toId+"")&&O(h,c)},d(r){r&&m(e)}}}function Me(o){let e,t,l,s,n,i=o[1],u=[];for(let f=0;f<i.length;f+=1)u[f]=ue(fe(o,i,f));return{c(){e=I("div"),t=I("h3"),l=S(o[0]),s=N(),n=I("ol");for(let f=0;f<u.length;f+=1)u[f].c();this.h()},l(f){e=y(f,"DIV",{class:!0});var a=D(e);t=y(a,"H3",{});var c=D(t);l=M(c,o[0]),c.forEach(m),s=C(a),n=y(a,"OL",{class:!0});var h=D(n);for(let r=0;r<u.length;r+=1)u[r].l(h);h.forEach(m),a.forEach(m),this.h()},h(){E(n,"class","svelte-5cl2gs"),E(e,"class","log svelte-5cl2gs")},m(f,a){$(f,e,a),k(e,t),k(t,l),k(e,s),k(e,n);for(let c=0;c<u.length;c+=1)u[c].m(n,null)},p(f,[a]){if(a&1&&O(l,f[0]),a&2){i=f[1];let c;for(c=0;c<i.length;c+=1){const h=fe(f,i,c);u[c]?u[c].p(h,a):(u[c]=ue(h),u[c].c(),u[c].m(n,null))}for(;c<u.length;c+=1)u[c].d(1);u.length=i.length}},i:X,o:X,d(f){f&&m(e),U(u,f)}}}function Ve(o,e,t){let{title:l="Moves"}=e,{moves:s=[]}=e;return o.$$set=n=>{"title"in n&&t(0,l=n.title),"moves"in n&&t(1,s=n.moves)},[l,s]}class Be extends j{constructor(e){super(),J(this,e,Ve,Me,Y,{title:0,moves:1})}}function Ne(o){let e,t,l,s,n,i;return{c(){e=I("div"),t=I("h2"),l=S(o[0]),this.h()},l(u){e=y(u,"DIV",{class:!0});var f=D(e);t=y(f,"H2",{});var a=D(t);l=M(a,o[0]),a.forEach(m),f.forEach(m),this.h()},h(){E(e,"class",s="modal "+(o[1]||"")+" svelte-alsri9")},m(u,f){$(u,e,f),k(e,t),k(t,l),i=!0},p(u,[f]){(!i||f&1)&&O(l,u[0]),(!i||f&2&&s!==(s="modal "+(u[1]||"")+" svelte-alsri9"))&&E(e,"class",s)},i(u){i||(he(()=>{n||(n=A(e,x,{delay:100},!0)),n.run(1)}),i=!0)},o(u){n||(n=A(e,x,{delay:100},!1)),n.run(0),i=!1},d(u){u&&m(e),u&&n&&n.end()}}}function Ce(o,e,t){let{message:l}=e,{result:s}=e;return o.$$set=n=>{"message"in n&&t(0,l=n.message),"result"in n&&t(1,s=n.result)},o.$$.update=()=>{o.$$.dirty&2&&console.log(s),o.$$.dirty&2&&t(0,l=s==="win"?"üèÖ You Win üèÖ":"You lose üòû")},[l,s]}class qe extends j{constructor(e){super(),J(this,e,Ce,Ne,Y,{message:0,result:1})}}function Ge(){return new Worker(""+new URL("../../workers/solve-worker-562c52e6.js",import.meta.url).href)}function Le(o){let e;return{c(){e=S("Custom")},l(t){e=M(t,"Custom")},m(t,l){$(t,e,l)},d(t){t&&m(e)}}}function We(o){let e;return{c(){e=S("New")},l(t){e=M(t,"New")},m(t,l){$(t,e,l)},d(t){t&&m(e)}}}function He(o){let e;return{c(){e=S("Reset")},l(t){e=M(t,"Reset")},m(t,l){$(t,e,l)},d(t){t&&m(e)}}}function ie(o){let e,t;return e=new T({props:{$$slots:{default:[Oe]},$$scope:{ctx:o}}}),e.$on("click",o[9]),{c(){q(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,s){L(e,l,s),t=!0},p(l,s){const n={};s&16384&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){p(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Oe(o){let e;return{c(){e=S("Solve")},l(t){e=M(t,"Solve")},m(t,l){$(t,e,l)},d(t){t&&m(e)}}}function ce(o){let e,t;return e=new T({props:{$$slots:{default:[Pe]},$$scope:{ctx:o}}}),e.$on("click",o[11]),{c(){q(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,s){L(e,l,s),t=!0},p(l,s){const n={};s&16384&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){p(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Pe(o){let e;return{c(){e=S("üí°")},l(t){e=M(t,"üí°")},m(t,l){$(t,e,l)},d(t){t&&m(e)}}}function Re(o){let e,t,l,s,n,i,u,f,a;e=new T({props:{href:ve+"/edit",$$slots:{default:[Le]},$$scope:{ctx:o}}}),l=new T({props:{$$slots:{default:[We]},$$scope:{ctx:o}}}),l.$on("click",o[7]),n=new T({props:{$$slots:{default:[He]},$$scope:{ctx:o}}}),n.$on("click",o[8]);let c=o[1]&&o[5].length==0&&ie(o),h=o[5].length>0&&ce(o);return{c(){q(e.$$.fragment),t=N(),q(l.$$.fragment),s=N(),q(n.$$.fragment),i=N(),c&&c.c(),u=N(),h&&h.c(),f=K()},l(r){G(e.$$.fragment,r),t=C(r),G(l.$$.fragment,r),s=C(r),G(n.$$.fragment,r),i=C(r),c&&c.l(r),u=C(r),h&&h.l(r),f=K()},m(r,_){L(e,r,_),$(r,t,_),L(l,r,_),$(r,s,_),L(n,r,_),$(r,i,_),c&&c.m(r,_),$(r,u,_),h&&h.m(r,_),$(r,f,_),a=!0},p(r,_){const w={};_&16384&&(w.$$scope={dirty:_,ctx:r}),e.$set(w);const g={};_&16384&&(g.$$scope={dirty:_,ctx:r}),l.$set(g);const v={};_&16384&&(v.$$scope={dirty:_,ctx:r}),n.$set(v),r[1]&&r[5].length==0?c?(c.p(r,_),_&34&&b(c,1)):(c=ie(r),c.c(),b(c,1),c.m(u.parentNode,u)):c&&(P(),p(c,1,1,()=>{c=null}),R()),r[5].length>0?h?(h.p(r,_),_&32&&b(h,1)):(h=ce(r),h.c(),b(h,1),h.m(f.parentNode,f)):h&&(P(),p(h,1,1,()=>{h=null}),R())},i(r){a||(b(e.$$.fragment,r),b(l.$$.fragment,r),b(n.$$.fragment,r),b(c),b(h),a=!0)},o(r){p(e.$$.fragment,r),p(l.$$.fragment,r),p(n.$$.fragment,r),p(c),p(h),a=!1},d(r){W(e,r),r&&m(t),W(l,r),r&&m(s),W(n,r),r&&m(i),c&&c.d(r),r&&m(u),h&&h.d(r),r&&m(f)}}}function ae(o){let e,t;return e=new qe({props:{result:o[2].status}}),{c(){q(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,s){L(e,l,s),t=!0},p(l,s){const n={};s&4&&(n.result=l[2].status),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){p(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Te(o){let e,t,l,s,n,i,u,f,a;e=new pe({props:{$$slots:{default:[Re]},$$scope:{ctx:o}}}),s=new Se({props:{tubes:o[2].tubes,selected:o[0],selectable:o[3],highlight:o[6]}}),s.$on("select",o[10]),i=new Be({props:{moves:o[4]}});let c=o[2].status&&ae(o);return{c(){q(e.$$.fragment),t=N(),l=I("div"),q(s.$$.fragment),n=N(),q(i.$$.fragment),u=N(),c&&c.c(),f=K(),this.h()},l(h){G(e.$$.fragment,h),t=C(h),l=y(h,"DIV",{class:!0});var r=D(l);G(s.$$.fragment,r),n=C(r),G(i.$$.fragment,r),r.forEach(m),u=C(h),c&&c.l(h),f=K(),this.h()},h(){E(l,"class","cols-2 svelte-m2jv0k")},m(h,r){L(e,h,r),$(h,t,r),$(h,l,r),L(s,l,null),k(l,n),L(i,l,null),$(h,u,r),c&&c.m(h,r),$(h,f,r),a=!0},p(h,[r]){const _={};r&16418&&(_.$$scope={dirty:r,ctx:h}),e.$set(_);const w={};r&4&&(w.tubes=h[2].tubes),r&1&&(w.selected=h[0]),r&8&&(w.selectable=h[3]),r&64&&(w.highlight=h[6]),s.$set(w);const g={};r&16&&(g.moves=h[4]),i.$set(g),h[2].status?c?(c.p(h,r),r&4&&b(c,1)):(c=ae(h),c.c(),b(c,1),c.m(f.parentNode,f)):c&&(P(),p(c,1,1,()=>{c=null}),R())},i(h){a||(b(e.$$.fragment,h),b(s.$$.fragment,h),b(i.$$.fragment,h),b(c),a=!0)},o(h){p(e.$$.fragment,h),p(s.$$.fragment,h),p(i.$$.fragment,h),p(c),a=!1},d(h){W(e,h),h&&m(t),h&&m(l),W(s),W(i),h&&m(u),c&&c.d(h),h&&m(f)}}}function je(o,e,t){let l;de(o,Z,d=>t(12,l=d));let s,n=new F(l),i=null,u,f=[],a=[],c=null;be(async()=>{t(1,s=new Ge),t(1,s.onmessage=function(d){t(5,a=d.data.actions),console.log(a)},s)});function h(){console.debug("generating new game"),Z.set($e()),t(2,n=new F(l)),t(4,f=[]),t(5,a=[]),t(6,c=null)}function r(){t(2,n=new F(l)),t(0,i=null),t(4,f=[]),t(5,a=[]),t(6,c=null)}function _(){s.postMessage(n)}function w(d){const V=d.detail;if(i===null)t(0,i=V),console.debug(`selecting ${i}`);else{if(g(i,V),a.length>0){const B=a[0];V===B.toIndex&&i===B.fromIndex?t(5,a=a.slice(1)):t(5,a=[])}t(0,i=null),t(6,c=null)}}function g(d,V){try{const B=n.historyEntry({from:d,to:V});t(2,n=n.applyMove({from:d,to:V})),console.debug(`applied move ${JSON.stringify(B)}`),t(4,f=[...f,B])}catch(B){console.log(B.message)}}function v(){a.length>0&&(t(0,i=a[0].fromIndex),t(6,c=a[0].toIndex))}return o.$$.update=()=>{o.$$.dirty&1&&t(3,u=i?"non-full":"non-empty")},[i,s,n,u,f,a,c,h,r,_,w,v]}class Ae extends j{constructor(e){super(),J(this,e,je,Te,Y,{})}}export{Ae as default};
