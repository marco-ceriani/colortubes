import{J as K,S as Y,i as z,s as A,k as I,a as V,q as G,l as y,m as D,h as m,c as B,r as O,n as w,K as j,b as v,E as S,L as ce,f as d,g as q,d as H,u as fe,t as $,M as Q,p as U,N as ie,O as L,P as ae,Q as he,x as C,y as N,z as M,A as T,e as P,I as _e,o as ge}from"../../chunks/index-3657e411.js";import{b as me}from"../../chunks/paths-267500fe.js";import{d as be,B as de,a as J,c as F,r as pe}from"../../chunks/game-55f24ee4.js";function $e(n){const e=n-1;return e*e*e+1}function X(n,{delay:e=0,duration:t=400,easing:l=K}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:l,css:r=>`opacity: ${r*s}`}}function Z(n,{delay:e=0,duration:t=400,easing:l=$e,x:s=0,y:r=0,opacity:i=0}={}){const u=getComputedStyle(n),o=+u.opacity,f=u.transform==="none"?"":u.transform,a=o*(1-i);return{delay:e,duration:t,easing:l,css:(h,c)=>`
			transform: ${f} translate(${(1-h)*s}px, ${(1-h)*r}px);
			opacity: ${o-a*c}`}}function x(n,e,t){const l=n.slice();return l[5]=e[t],l}function ee(n){let e,t,l=`var(--clr-wtr${n[5]})`,s;return{c(){e=I("div"),this.h()},l(r){e=y(r,"DIV",{class:!0}),D(e).forEach(m),this.h()},h(){w(e,"class","waterblock svelte-1ioo7u3"),U(e,"background-color",l)},m(r,i){v(r,e,i),s=!0},p(r,i){n=r,i&1&&l!==(l=`var(--clr-wtr${n[5]})`)&&U(e,"background-color",l)},i(r){s||(r&&ie(()=>{t||(t=L(e,Z,{y:-200,duration:200,easing:K},!0)),t.run(1)}),s=!0)},o(r){r&&(t||(t=L(e,Z,{y:-200,duration:200,easing:K},!1)),t.run(0)),s=!1},d(r){r&&m(e),r&&t&&t.end()}}}function ve(n){let e,t,l,s,r,i,u=n[0].name+"",o,f,a,h,c=n[0].levels,_=[];for(let g=0;g<c.length;g+=1)_[g]=ee(x(n,c,g));const R=g=>$(_[g],1,1,()=>{_[g]=null});return{c(){e=I("div"),t=I("div"),l=I("div"),s=V();for(let g=0;g<_.length;g+=1)_[g].c();r=V(),i=I("h4"),o=G(u),this.h()},l(g){e=y(g,"DIV",{class:!0});var b=D(e);t=y(b,"DIV",{class:!0,selectable:!0});var p=D(t);l=y(p,"DIV",{class:!0}),D(l).forEach(m),s=B(p);for(let E=0;E<_.length;E+=1)_[E].l(p);p.forEach(m),r=B(b),i=y(b,"H4",{class:!0});var k=D(i);o=O(k,u),k.forEach(m),b.forEach(m),this.h()},h(){w(l,"class","plug svelte-1ioo7u3"),w(t,"class","tube svelte-1ioo7u3"),w(t,"selectable",n[3]),j(t,"selected",n[1]),j(t,"highlight",n[2]),j(t,"unplugged",!n[0].done),w(i,"class","svelte-1ioo7u3"),w(e,"class","tube-slot")},m(g,b){v(g,e,b),S(e,t),S(t,l),S(t,s);for(let p=0;p<_.length;p+=1)_[p].m(t,null);S(e,r),S(e,i),S(i,o),f=!0,a||(h=ce(t,"click",n[4]),a=!0)},p(g,[b]){if(b&1){c=g[0].levels;let p;for(p=0;p<c.length;p+=1){const k=x(g,c,p);_[p]?(_[p].p(k,b),d(_[p],1)):(_[p]=ee(k),_[p].c(),d(_[p],1),_[p].m(t,null))}for(q(),p=c.length;p<_.length;p+=1)R(p);H()}(!f||b&8)&&w(t,"selectable",g[3]),(!f||b&2)&&j(t,"selected",g[1]),(!f||b&4)&&j(t,"highlight",g[2]),(!f||b&1)&&j(t,"unplugged",!g[0].done),(!f||b&1)&&u!==(u=g[0].name+"")&&fe(o,u)},i(g){if(!f){for(let b=0;b<c.length;b+=1)d(_[b]);f=!0}},o(g){_=_.filter(Boolean);for(let b=0;b<_.length;b+=1)$(_[b]);f=!1},d(g){g&&m(e),Q(_,g),a=!1,h()}}}function ke(n,e,t){let{tube:l}=e,{selected:s=!1}=e,{highlight:r=!1}=e,{selectable:i}=e;function u(o){ae.call(this,n,o)}return n.$$set=o=>{"tube"in o&&t(0,l=o.tube),"selected"in o&&t(1,s=o.selected),"highlight"in o&&t(2,r=o.highlight),"selectable"in o&&t(3,i=o.selectable)},[l,s,r,i,u]}class we extends Y{constructor(e){super(),z(this,e,ke,ve,A,{tube:0,selected:1,highlight:2,selectable:3})}}function te(n,e,t){const l=n.slice();return l[8]=e[t],l}function le(n,e,t){const l=n.slice();return l[11]=e[t],l}function se(n){let e,t;function l(){return n[6](n[11])}return e=new we({props:{tube:n[11],selected:n[0]===n[11].id,selectable:n[3](n[11].id,n[0]),highlight:n[1]===n[11].id}}),e.$on("click",l),{c(){C(e.$$.fragment)},l(s){N(e.$$.fragment,s)},m(s,r){M(e,s,r),t=!0},p(s,r){n=s;const i={};r&4&&(i.tube=n[11]),r&5&&(i.selected=n[0]===n[11].id),r&5&&(i.selectable=n[3](n[11].id,n[0])),r&6&&(i.highlight=n[1]===n[11].id),e.$set(i)},i(s){t||(d(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){T(e,s)}}}function ne(n){let e,t,l,s=n[8],r=[];for(let u=0;u<s.length;u+=1)r[u]=se(le(n,s,u));const i=u=>$(r[u],1,1,()=>{r[u]=null});return{c(){e=I("div");for(let u=0;u<r.length;u+=1)r[u].c();t=V(),this.h()},l(u){e=y(u,"DIV",{class:!0});var o=D(e);for(let f=0;f<r.length;f+=1)r[f].l(o);t=B(o),o.forEach(m),this.h()},h(){w(e,"class","tubes-row svelte-1m5libu")},m(u,o){v(u,e,o);for(let f=0;f<r.length;f+=1)r[f].m(e,null);S(e,t),l=!0},p(u,o){if(o&31){s=u[8];let f;for(f=0;f<s.length;f+=1){const a=le(u,s,f);r[f]?(r[f].p(a,o),d(r[f],1)):(r[f]=se(a),r[f].c(),d(r[f],1),r[f].m(e,t))}for(q(),f=s.length;f<r.length;f+=1)i(f);H()}},i(u){if(!l){for(let o=0;o<s.length;o+=1)d(r[o]);l=!0}},o(u){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)$(r[o]);l=!1},d(u){u&&m(e),Q(r,u)}}}function Ee(n){let e,t,l=n[2],s=[];for(let i=0;i<l.length;i+=1)s[i]=ne(te(n,l,i));const r=i=>$(s[i],1,1,()=>{s[i]=null});return{c(){e=I("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=y(i,"DIV",{class:!0});var u=D(e);for(let o=0;o<s.length;o+=1)s[o].l(u);u.forEach(m),this.h()},h(){w(e,"class","tubes-container")},m(i,u){v(i,e,u);for(let o=0;o<s.length;o+=1)s[o].m(e,null);t=!0},p(i,[u]){if(u&31){l=i[2];let o;for(o=0;o<l.length;o+=1){const f=te(i,l,o);s[o]?(s[o].p(f,u),d(s[o],1)):(s[o]=ne(f),s[o].c(),d(s[o],1),s[o].m(e,null))}for(q(),o=l.length;o<s.length;o+=1)r(o);H()}},i(i){if(!t){for(let u=0;u<l.length;u+=1)d(s[u]);t=!0}},o(i){s=s.filter(Boolean);for(let u=0;u<s.length;u+=1)$(s[u]);t=!1},d(i){i&&m(e),Q(s,i)}}}function Ie(n,e,t){const l=he();let{tubes:s}=e,{selected:r=null}=e,{highlight:i=null}=e,u=[];function o(h){return r===h?!0:!(s[h].done||r===null&&s[h].empty||r!==null&&s[h].full)}function f(h){o(h)&&l("select",h)}const a=h=>f(h.id);return n.$$set=h=>{"tubes"in h&&t(5,s=h.tubes),"selected"in h&&t(0,r=h.selected),"highlight"in h&&t(1,i=h.highlight)},n.$$.update=()=>{n.$$.dirty&32&&t(2,u=be(s))},[r,i,u,o,f,s,a]}class ye extends Y{constructor(e){super(),z(this,e,Ie,Ee,A,{tubes:5,selected:0,highlight:1})}}function De(n){let e,t,l,s,r,i;return{c(){e=I("div"),t=I("h2"),l=G(n[1]),this.h()},l(u){e=y(u,"DIV",{class:!0});var o=D(e);t=y(o,"H2",{});var f=D(t);l=O(f,n[1]),f.forEach(m),o.forEach(m),this.h()},h(){w(e,"class",s="modal "+(n[0]||"")+" svelte-alsri9")},m(u,o){v(u,e,o),S(e,t),S(t,l),i=!0},p(u,[o]){(!i||o&2)&&fe(l,u[1]),(!i||o&1&&s!==(s="modal "+(u[0]||"")+" svelte-alsri9"))&&w(e,"class",s)},i(u){i||(ie(()=>{r||(r=L(e,X,{delay:100},!0)),r.run(1)}),i=!0)},o(u){r||(r=L(e,X,{delay:100},!1)),r.run(0),i=!1},d(u){u&&m(e),u&&r&&r.end()}}}function Se(n,e,t){let l,{result:s}=e;return n.$$set=r=>{"result"in r&&t(0,s=r.result)},n.$$.update=()=>{n.$$.dirty&1&&t(1,l=s==="win"?"🏅 You Win 🏅":"You lose 😞")},[s,l]}class Ve extends Y{constructor(e){super(),z(this,e,Se,De,A,{result:0})}}function Be(){return new Worker(""+new URL("../../workers/solve-worker-adfa78ed.js",import.meta.url).href)}function Ce(n){let e;return{c(){e=G("New")},l(t){e=O(t,"New")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function Ne(n){let e;return{c(){e=G("Custom")},l(t){e=O(t,"Custom")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function Me(n){let e;return{c(){e=G("Reset")},l(t){e=O(t,"Reset")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function re(n){let e,t;return e=new J({props:{spin:n[2],$$slots:{default:[Te]},$$scope:{ctx:n}}}),e.$on("click",n[9]),{c(){C(e.$$.fragment)},l(l){N(e.$$.fragment,l)},m(l,s){M(e,l,s),t=!0},p(l,s){const r={};s&4&&(r.spin=l[2]),s&32768&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(d(e.$$.fragment,l),t=!0)},o(l){$(e.$$.fragment,l),t=!1},d(l){T(e,l)}}}function Te(n){let e;return{c(){e=G("Solve")},l(t){e=O(t,"Solve")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function oe(n){let e,t;return e=new J({props:{$$slots:{default:[We]},$$scope:{ctx:n}}}),e.$on("click",n[11]),{c(){C(e.$$.fragment)},l(l){N(e.$$.fragment,l)},m(l,s){M(e,l,s),t=!0},p(l,s){const r={};s&32768&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(d(e.$$.fragment,l),t=!0)},o(l){$(e.$$.fragment,l),t=!1},d(l){T(e,l)}}}function We(n){let e;return{c(){e=G("💡")},l(t){e=O(t,"💡")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function Ge(n){let e,t,l,s,r,i,u,o,f;e=new J({props:{$$slots:{default:[Ce]},$$scope:{ctx:n}}}),e.$on("click",n[7]),l=new J({props:{href:me+"/edit",$$slots:{default:[Ne]},$$scope:{ctx:n}}}),r=new J({props:{$$slots:{default:[Me]},$$scope:{ctx:n}}}),r.$on("click",n[8]);let a=n[1]&&n[5].length==0&&re(n),h=n[5].length>0&&oe(n);return{c(){C(e.$$.fragment),t=V(),C(l.$$.fragment),s=V(),C(r.$$.fragment),i=V(),a&&a.c(),u=V(),h&&h.c(),o=P()},l(c){N(e.$$.fragment,c),t=B(c),N(l.$$.fragment,c),s=B(c),N(r.$$.fragment,c),i=B(c),a&&a.l(c),u=B(c),h&&h.l(c),o=P()},m(c,_){M(e,c,_),v(c,t,_),M(l,c,_),v(c,s,_),M(r,c,_),v(c,i,_),a&&a.m(c,_),v(c,u,_),h&&h.m(c,_),v(c,o,_),f=!0},p(c,_){const R={};_&32768&&(R.$$scope={dirty:_,ctx:c}),e.$set(R);const g={};_&32768&&(g.$$scope={dirty:_,ctx:c}),l.$set(g);const b={};_&32768&&(b.$$scope={dirty:_,ctx:c}),r.$set(b),c[1]&&c[5].length==0?a?(a.p(c,_),_&34&&d(a,1)):(a=re(c),a.c(),d(a,1),a.m(u.parentNode,u)):a&&(q(),$(a,1,1,()=>{a=null}),H()),c[5].length>0?h?(h.p(c,_),_&32&&d(h,1)):(h=oe(c),h.c(),d(h,1),h.m(o.parentNode,o)):h&&(q(),$(h,1,1,()=>{h=null}),H())},i(c){f||(d(e.$$.fragment,c),d(l.$$.fragment,c),d(r.$$.fragment,c),d(a),d(h),f=!0)},o(c){$(e.$$.fragment,c),$(l.$$.fragment,c),$(r.$$.fragment,c),$(a),$(h),f=!1},d(c){T(e,c),c&&m(t),T(l,c),c&&m(s),T(r,c),c&&m(i),a&&a.d(c),c&&m(u),h&&h.d(c),c&&m(o)}}}function ue(n){let e,t;return e=new Ve({props:{result:n[3].status}}),{c(){C(e.$$.fragment)},l(l){N(e.$$.fragment,l)},m(l,s){M(e,l,s),t=!0},p(l,s){const r={};s&8&&(r.result=l[3].status),e.$set(r)},i(l){t||(d(e.$$.fragment,l),t=!0)},o(l){$(e.$$.fragment,l),t=!1},d(l){T(e,l)}}}function Oe(n){let e,t,l,s,r,i,u;e=new de({props:{$$slots:{default:[Ge]},$$scope:{ctx:n}}}),s=new ye({props:{tubes:n[3].tubes,selected:n[0],selectable:n[4],highlight:n[6]}}),s.$on("select",n[10]);let o=n[3].status&&ue(n);return{c(){C(e.$$.fragment),t=V(),l=I("div"),C(s.$$.fragment),r=V(),o&&o.c(),i=P(),this.h()},l(f){N(e.$$.fragment,f),t=B(f),l=y(f,"DIV",{class:!0});var a=D(l);N(s.$$.fragment,a),a.forEach(m),r=B(f),o&&o.l(f),i=P(),this.h()},h(){w(l,"class","cols-2 svelte-m2jv0k")},m(f,a){M(e,f,a),v(f,t,a),v(f,l,a),M(s,l,null),v(f,r,a),o&&o.m(f,a),v(f,i,a),u=!0},p(f,[a]){const h={};a&32806&&(h.$$scope={dirty:a,ctx:f}),e.$set(h);const c={};a&8&&(c.tubes=f[3].tubes),a&1&&(c.selected=f[0]),a&16&&(c.selectable=f[4]),a&64&&(c.highlight=f[6]),s.$set(c),f[3].status?o?(o.p(f,a),a&8&&d(o,1)):(o=ue(f),o.c(),d(o,1),o.m(i.parentNode,i)):o&&(q(),$(o,1,1,()=>{o=null}),H())},i(f){u||(d(e.$$.fragment,f),d(s.$$.fragment,f),d(o),u=!0)},o(f){$(e.$$.fragment,f),$(s.$$.fragment,f),$(o),u=!1},d(f){T(e,f),f&&m(t),f&&m(l),T(s),f&&m(r),o&&o.d(f),f&&m(i)}}}function Re(n,e,t){let l;_e(n,F,k=>t(13,l=k));let s,r=!1,i=l,u=null,o,f=[],a=[],h=null;ge(async()=>{t(1,s=new Be),t(1,s.onmessage=function(k){k.data.result==="win"&&(t(5,a=k.data.actions),console.debug(a)),t(2,r=!1)},s)});function c(){console.debug("generating new game"),F.set(pe()),t(3,i=l),f=[],t(5,a=[]),t(6,h=null)}function _(){t(3,i=l),t(0,u=null),f=[],t(5,a=[]),t(6,h=null)}function R(){s.postMessage(i),t(2,r=!0)}function g(k){const E=k.detail;if(u===null)t(0,u=E),console.debug(`selecting ${u}`);else if(u===E)console.debug(`deselecting ${u}`),t(0,u=null);else{if(b(u,E),a.length>0){const W=a[0];E===W.toIndex&&u===W.fromIndex?t(5,a=a.slice(1)):t(5,a=[])}t(0,u=null),t(6,h=null)}}function b(k,E){try{const W=i.historyEntry({from:k,to:E});t(3,i=i.applyMove({from:k,to:E})),console.debug(`applied move ${JSON.stringify(W)}`),f=[...f,W]}catch(W){console.log(W.message)}}function p(){a.length>0&&(t(0,u=a[0].fromIndex),t(6,h=a[0].toIndex))}return n.$$.update=()=>{n.$$.dirty&1&&t(4,o=u?"non-full":"non-empty")},[u,s,r,i,o,a,h,c,_,R,g,p]}class Je extends Y{constructor(e){super(),z(this,e,Re,Oe,A,{})}}export{Je as default};
