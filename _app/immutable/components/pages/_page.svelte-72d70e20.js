import{I as A,S as Y,i as z,s as K,k as E,a as B,q as H,l as I,m as D,h as m,c as C,r as L,n as w,J as O,b as v,D as V,K as ae,f as d,g as P,d as T,u as ie,t as $,L as F,p as Q,M as ce,N as q,O as he,P as _e,w as M,x as N,y as G,z as W,e as J,H as ge,o as me}from"../../chunks/index-5bc28d6e.js";import{b as be}from"../../chunks/paths-d538d824.js";import{B as de,G as U,a as j,c as X,r as pe}from"../../chunks/game-0f56d800.js";function $e(s){const e=s-1;return e*e*e+1}function Z(s,{delay:e=0,duration:t=400,easing:l=A}={}){const n=+getComputedStyle(s).opacity;return{delay:e,duration:t,easing:l,css:o=>`opacity: ${o*n}`}}function x(s,{delay:e=0,duration:t=400,easing:l=$e,x:n=0,y:o=0,opacity:c=0}={}){const u=getComputedStyle(s),r=+u.opacity,i=u.transform==="none"?"":u.transform,a=r*(1-c);return{delay:e,duration:t,easing:l,css:(g,f)=>`
			transform: ${i} translate(${(1-g)*n}px, ${(1-g)*o}px);
			opacity: ${r-a*f}`}}function ee(s,e,t){const l=s.slice();return l[5]=e[t],l}function te(s){let e,t,l=`var(--clr-wtr${s[5]})`,n;return{c(){e=E("div"),this.h()},l(o){e=I(o,"DIV",{class:!0}),D(e).forEach(m),this.h()},h(){w(e,"class","waterblock svelte-1ioo7u3"),Q(e,"background-color",l)},m(o,c){v(o,e,c),n=!0},p(o,c){s=o,c&1&&l!==(l=`var(--clr-wtr${s[5]})`)&&Q(e,"background-color",l)},i(o){n||(o&&ce(()=>{t||(t=q(e,x,{y:-200,duration:200,easing:A},!0)),t.run(1)}),n=!0)},o(o){o&&(t||(t=q(e,x,{y:-200,duration:200,easing:A},!1)),t.run(0)),n=!1},d(o){o&&m(e),o&&t&&t.end()}}}function ve(s){let e,t,l,n,o,c,u=s[0].name+"",r,i,a,g,f=s[0].levels,h=[];for(let _=0;_<f.length;_+=1)h[_]=te(ee(s,f,_));const S=_=>$(h[_],1,1,()=>{h[_]=null});return{c(){e=E("div"),t=E("div"),l=E("div"),n=B();for(let _=0;_<h.length;_+=1)h[_].c();o=B(),c=E("h4"),r=H(u),this.h()},l(_){e=I(_,"DIV",{class:!0});var b=D(e);t=I(b,"DIV",{class:!0,selectable:!0});var p=D(t);l=I(p,"DIV",{class:!0}),D(l).forEach(m),n=C(p);for(let y=0;y<h.length;y+=1)h[y].l(p);p.forEach(m),o=C(b),c=I(b,"H4",{class:!0});var k=D(c);r=L(k,u),k.forEach(m),b.forEach(m),this.h()},h(){w(l,"class","plug svelte-1ioo7u3"),w(t,"class","tube svelte-1ioo7u3"),w(t,"selectable",s[3]),O(t,"selected",s[1]),O(t,"highlight",s[2]),O(t,"unplugged",!s[0].done),w(c,"class","svelte-1ioo7u3"),w(e,"class","tube-slot")},m(_,b){v(_,e,b),V(e,t),V(t,l),V(t,n);for(let p=0;p<h.length;p+=1)h[p].m(t,null);V(e,o),V(e,c),V(c,r),i=!0,a||(g=ae(t,"click",s[4]),a=!0)},p(_,[b]){if(b&1){f=_[0].levels;let p;for(p=0;p<f.length;p+=1){const k=ee(_,f,p);h[p]?(h[p].p(k,b),d(h[p],1)):(h[p]=te(k),h[p].c(),d(h[p],1),h[p].m(t,null))}for(P(),p=f.length;p<h.length;p+=1)S(p);T()}(!i||b&8)&&w(t,"selectable",_[3]),(!i||b&2)&&O(t,"selected",_[1]),(!i||b&4)&&O(t,"highlight",_[2]),(!i||b&1)&&O(t,"unplugged",!_[0].done),(!i||b&1)&&u!==(u=_[0].name+"")&&ie(r,u)},i(_){if(!i){for(let b=0;b<f.length;b+=1)d(h[b]);i=!0}},o(_){h=h.filter(Boolean);for(let b=0;b<h.length;b+=1)$(h[b]);i=!1},d(_){_&&m(e),F(h,_),a=!1,g()}}}function ke(s,e,t){let{tube:l}=e,{selected:n=!1}=e,{highlight:o=!1}=e,{selectable:c}=e;function u(r){he.call(this,s,r)}return s.$$set=r=>{"tube"in r&&t(0,l=r.tube),"selected"in r&&t(1,n=r.selected),"highlight"in r&&t(2,o=r.highlight),"selectable"in r&&t(3,c=r.selectable)},[l,n,o,c,u]}class we extends Y{constructor(e){super(),z(this,e,ke,ve,K,{tube:0,selected:1,highlight:2,selectable:3})}}function le(s,e,t){const l=s.slice();return l[9]=e[t],l}function ne(s,e,t){const l=s.slice();return l[12]=e[t],l}function se(s){let e,t;function l(){return s[6](s[12])}return e=new we({props:{tube:s[12],selected:s[0]===s[12].id,selectable:s[3](s[12].id,s[0]),highlight:s[1]===s[12].id}}),e.$on("click",l),{c(){M(e.$$.fragment)},l(n){N(e.$$.fragment,n)},m(n,o){G(e,n,o),t=!0},p(n,o){s=n;const c={};o&4&&(c.tube=s[12]),o&5&&(c.selected=s[0]===s[12].id),o&5&&(c.selectable=s[3](s[12].id,s[0])),o&6&&(c.highlight=s[1]===s[12].id),e.$set(c)},i(n){t||(d(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function oe(s){let e,t,l,n=s[9],o=[];for(let u=0;u<n.length;u+=1)o[u]=se(ne(s,n,u));const c=u=>$(o[u],1,1,()=>{o[u]=null});return{c(){e=E("div");for(let u=0;u<o.length;u+=1)o[u].c();t=B(),this.h()},l(u){e=I(u,"DIV",{class:!0});var r=D(e);for(let i=0;i<o.length;i+=1)o[i].l(r);t=C(r),r.forEach(m),this.h()},h(){w(e,"class","tubes-row svelte-1m5libu")},m(u,r){v(u,e,r);for(let i=0;i<o.length;i+=1)o[i].m(e,null);V(e,t),l=!0},p(u,r){if(r&31){n=u[9];let i;for(i=0;i<n.length;i+=1){const a=ne(u,n,i);o[i]?(o[i].p(a,r),d(o[i],1)):(o[i]=se(a),o[i].c(),d(o[i],1),o[i].m(e,t))}for(P(),i=n.length;i<o.length;i+=1)c(i);T()}},i(u){if(!l){for(let r=0;r<n.length;r+=1)d(o[r]);l=!0}},o(u){o=o.filter(Boolean);for(let r=0;r<o.length;r+=1)$(o[r]);l=!1},d(u){u&&m(e),F(o,u)}}}function ye(s){let e,t,l=s[2],n=[];for(let c=0;c<l.length;c+=1)n[c]=oe(le(s,l,c));const o=c=>$(n[c],1,1,()=>{n[c]=null});return{c(){e=E("div");for(let c=0;c<n.length;c+=1)n[c].c();this.h()},l(c){e=I(c,"DIV",{class:!0});var u=D(e);for(let r=0;r<n.length;r+=1)n[r].l(u);u.forEach(m),this.h()},h(){w(e,"class","tubes-container")},m(c,u){v(c,e,u);for(let r=0;r<n.length;r+=1)n[r].m(e,null);t=!0},p(c,[u]){if(u&31){l=c[2];let r;for(r=0;r<l.length;r+=1){const i=le(c,l,r);n[r]?(n[r].p(i,u),d(n[r],1)):(n[r]=oe(i),n[r].c(),d(n[r],1),n[r].m(e,null))}for(P(),r=l.length;r<n.length;r+=1)o(r);T()}},i(c){if(!t){for(let u=0;u<l.length;u+=1)d(n[u]);t=!0}},o(c){n=n.filter(Boolean);for(let u=0;u<n.length;u+=1)$(n[u]);t=!1},d(c){c&&m(e),F(n,c)}}}function Ee(s,e,t){const l=_e();let{tubes:n}=e,{selected:o=null}=e,{highlight:c=null}=e,u=[];function r(f){const h=f.length<=6?f.length:f.length<=14?(f.length+1)/2:5,S=[];for(let _=0;_<f.length;_+=h)S.push(n.slice(_,_+h));return S}function i(f){return o===f?!0:!(n[f].done||o===null&&n[f].empty||o!==null&&n[f].full)}function a(f){i(f)&&l("select",f)}const g=f=>a(f.id);return s.$$set=f=>{"tubes"in f&&t(5,n=f.tubes),"selected"in f&&t(0,o=f.selected),"highlight"in f&&t(1,c=f.highlight)},s.$$.update=()=>{s.$$.dirty&32&&t(2,u=r(n))},[o,c,u,i,a,n,g]}class Ie extends Y{constructor(e){super(),z(this,e,Ee,ye,K,{tubes:5,selected:0,highlight:1})}}function De(s){let e,t,l,n,o,c;return{c(){e=E("div"),t=E("h2"),l=H(s[0]),this.h()},l(u){e=I(u,"DIV",{class:!0});var r=D(e);t=I(r,"H2",{});var i=D(t);l=L(i,s[0]),i.forEach(m),r.forEach(m),this.h()},h(){w(e,"class",n="modal "+(s[1]||"")+" svelte-alsri9")},m(u,r){v(u,e,r),V(e,t),V(t,l),c=!0},p(u,[r]){(!c||r&1)&&ie(l,u[0]),(!c||r&2&&n!==(n="modal "+(u[1]||"")+" svelte-alsri9"))&&w(e,"class",n)},i(u){c||(ce(()=>{o||(o=q(e,Z,{delay:100},!0)),o.run(1)}),c=!0)},o(u){o||(o=q(e,Z,{delay:100},!1)),o.run(0),c=!1},d(u){u&&m(e),u&&o&&o.end()}}}function Se(s,e,t){let{message:l}=e,{result:n}=e;return s.$$set=o=>{"message"in o&&t(0,l=o.message),"result"in o&&t(1,n=o.result)},s.$$.update=()=>{s.$$.dirty&2&&console.log(n),s.$$.dirty&2&&t(0,l=n==="win"?"🏅 You Win 🏅":"You lose 😞")},[l,n]}class Ve extends Y{constructor(e){super(),z(this,e,Se,De,K,{message:0,result:1})}}function Be(){return new Worker(""+new URL("../../workers/solve-worker-487c951a.js",import.meta.url).href)}function Ce(s){let e;return{c(){e=H("New")},l(t){e=L(t,"New")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function Me(s){let e;return{c(){e=H("Custom")},l(t){e=L(t,"Custom")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function Ne(s){let e;return{c(){e=H("Reset")},l(t){e=L(t,"Reset")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function re(s){let e,t;return e=new j({props:{spin:s[2],$$slots:{default:[Ge]},$$scope:{ctx:s}}}),e.$on("click",s[9]),{c(){M(e.$$.fragment)},l(l){N(e.$$.fragment,l)},m(l,n){G(e,l,n),t=!0},p(l,n){const o={};n&4&&(o.spin=l[2]),n&32768&&(o.$$scope={dirty:n,ctx:l}),e.$set(o)},i(l){t||(d(e.$$.fragment,l),t=!0)},o(l){$(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Ge(s){let e;return{c(){e=H("Solve")},l(t){e=L(t,"Solve")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function ue(s){let e,t;return e=new j({props:{$$slots:{default:[We]},$$scope:{ctx:s}}}),e.$on("click",s[11]),{c(){M(e.$$.fragment)},l(l){N(e.$$.fragment,l)},m(l,n){G(e,l,n),t=!0},p(l,n){const o={};n&32768&&(o.$$scope={dirty:n,ctx:l}),e.$set(o)},i(l){t||(d(e.$$.fragment,l),t=!0)},o(l){$(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function We(s){let e;return{c(){e=H("💡")},l(t){e=L(t,"💡")},m(t,l){v(t,e,l)},d(t){t&&m(e)}}}function Re(s){let e,t,l,n,o,c,u,r,i;e=new j({props:{$$slots:{default:[Ce]},$$scope:{ctx:s}}}),e.$on("click",s[7]),l=new j({props:{href:be+"/edit",$$slots:{default:[Me]},$$scope:{ctx:s}}}),o=new j({props:{$$slots:{default:[Ne]},$$scope:{ctx:s}}}),o.$on("click",s[8]);let a=s[1]&&s[5].length==0&&re(s),g=s[5].length>0&&ue(s);return{c(){M(e.$$.fragment),t=B(),M(l.$$.fragment),n=B(),M(o.$$.fragment),c=B(),a&&a.c(),u=B(),g&&g.c(),r=J()},l(f){N(e.$$.fragment,f),t=C(f),N(l.$$.fragment,f),n=C(f),N(o.$$.fragment,f),c=C(f),a&&a.l(f),u=C(f),g&&g.l(f),r=J()},m(f,h){G(e,f,h),v(f,t,h),G(l,f,h),v(f,n,h),G(o,f,h),v(f,c,h),a&&a.m(f,h),v(f,u,h),g&&g.m(f,h),v(f,r,h),i=!0},p(f,h){const S={};h&32768&&(S.$$scope={dirty:h,ctx:f}),e.$set(S);const _={};h&32768&&(_.$$scope={dirty:h,ctx:f}),l.$set(_);const b={};h&32768&&(b.$$scope={dirty:h,ctx:f}),o.$set(b),f[1]&&f[5].length==0?a?(a.p(f,h),h&34&&d(a,1)):(a=re(f),a.c(),d(a,1),a.m(u.parentNode,u)):a&&(P(),$(a,1,1,()=>{a=null}),T()),f[5].length>0?g?(g.p(f,h),h&32&&d(g,1)):(g=ue(f),g.c(),d(g,1),g.m(r.parentNode,r)):g&&(P(),$(g,1,1,()=>{g=null}),T())},i(f){i||(d(e.$$.fragment,f),d(l.$$.fragment,f),d(o.$$.fragment,f),d(a),d(g),i=!0)},o(f){$(e.$$.fragment,f),$(l.$$.fragment,f),$(o.$$.fragment,f),$(a),$(g),i=!1},d(f){W(e,f),f&&m(t),W(l,f),f&&m(n),W(o,f),f&&m(c),a&&a.d(f),f&&m(u),g&&g.d(f),f&&m(r)}}}function fe(s){let e,t;return e=new Ve({props:{result:s[3].status}}),{c(){M(e.$$.fragment)},l(l){N(e.$$.fragment,l)},m(l,n){G(e,l,n),t=!0},p(l,n){const o={};n&8&&(o.result=l[3].status),e.$set(o)},i(l){t||(d(e.$$.fragment,l),t=!0)},o(l){$(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function He(s){let e,t,l,n,o,c,u;e=new de({props:{$$slots:{default:[Re]},$$scope:{ctx:s}}}),n=new Ie({props:{tubes:s[3].tubes,selected:s[0],selectable:s[4],highlight:s[6]}}),n.$on("select",s[10]);let r=s[3].status&&fe(s);return{c(){M(e.$$.fragment),t=B(),l=E("div"),M(n.$$.fragment),o=B(),r&&r.c(),c=J(),this.h()},l(i){N(e.$$.fragment,i),t=C(i),l=I(i,"DIV",{class:!0});var a=D(l);N(n.$$.fragment,a),a.forEach(m),o=C(i),r&&r.l(i),c=J(),this.h()},h(){w(l,"class","cols-2 svelte-m2jv0k")},m(i,a){G(e,i,a),v(i,t,a),v(i,l,a),G(n,l,null),v(i,o,a),r&&r.m(i,a),v(i,c,a),u=!0},p(i,[a]){const g={};a&32806&&(g.$$scope={dirty:a,ctx:i}),e.$set(g);const f={};a&8&&(f.tubes=i[3].tubes),a&1&&(f.selected=i[0]),a&16&&(f.selectable=i[4]),a&64&&(f.highlight=i[6]),n.$set(f),i[3].status?r?(r.p(i,a),a&8&&d(r,1)):(r=fe(i),r.c(),d(r,1),r.m(c.parentNode,c)):r&&(P(),$(r,1,1,()=>{r=null}),T())},i(i){u||(d(e.$$.fragment,i),d(n.$$.fragment,i),d(r),u=!0)},o(i){$(e.$$.fragment,i),$(n.$$.fragment,i),$(r),u=!1},d(i){W(e,i),i&&m(t),i&&m(l),W(n),i&&m(o),r&&r.d(i),i&&m(c)}}}function Le(s,e,t){let l;ge(s,X,k=>t(13,l=k));let n,o=!1,c=new U(l),u=null,r,i=[],a=[],g=null;me(async()=>{t(1,n=new Be),t(1,n.onmessage=function(k){k.data.result==="win"&&(t(5,a=k.data.actions),console.debug(a)),t(2,o=!1)},n)});function f(){console.debug("generating new game"),X.set(pe()),t(3,c=new U(l)),i=[],t(5,a=[]),t(6,g=null)}function h(){t(3,c=new U(l)),t(0,u=null),i=[],t(5,a=[]),t(6,g=null)}function S(){n.postMessage(c),t(2,o=!0)}function _(k){const y=k.detail;if(u===null)t(0,u=y),console.debug(`selecting ${u}`);else if(u===y)console.debug(`deselecting ${u}`),t(0,u=null);else{if(b(u,y),a.length>0){const R=a[0];y===R.toIndex&&u===R.fromIndex?t(5,a=a.slice(1)):t(5,a=[])}t(0,u=null),t(6,g=null)}}function b(k,y){try{const R=c.historyEntry({from:k,to:y});t(3,c=c.applyMove({from:k,to:y})),console.debug(`applied move ${JSON.stringify(R)}`),i=[...i,R]}catch(R){console.log(R.message)}}function p(){a.length>0&&(t(0,u=a[0].fromIndex),t(6,g=a[0].toIndex))}return s.$$.update=()=>{s.$$.dirty&1&&t(4,r=u?"non-full":"non-empty")},[u,n,o,c,r,a,g,f,h,S,_,p]}class je extends Y{constructor(e){super(),z(this,e,Le,He,K,{})}}export{je as default};
