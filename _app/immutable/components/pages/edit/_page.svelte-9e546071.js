import{S as oe,i as re,s as ce,k as v,a as D,l as k,m as y,c as P,h,n as d,J as A,p as U,b as $,D as q,K as M,B as K,L as F,P as ae,q as L,r as z,u as ie,w as O,x as R,y as j,f as S,t as V,z as I,H as fe}from"../../../chunks/index-5bc28d6e.js";import{h as B}from"../../../chunks/singletons-2d098f24.js";import{b as ue}from"../../../chunks/paths-d538d824.js";import{N as _e,B as he,a as H,T as Q,c as W,G as me}from"../../../chunks/game-c3d881e5.js";B.disable_scroll_handling;const pe=B.goto;B.invalidate;B.invalidateAll;B.preload_data;B.preload_code;B.before_navigate;B.after_navigate;function X(n,e,o){const l=n.slice();return l[7]=e[o],l}function Y(n){let e,o=(n[0][n[7]]||"")+"",l,s=`var(--clr-wtr${n[7]>=0?n[7]:"-none"})`,u,r;function t(){return n[4](n[7])}return{c(){e=v("button"),l=L(o),this.h()},l(a){e=k(a,"BUTTON",{class:!0});var _=y(e);l=z(_,o),_.forEach(h),this.h()},h(){d(e,"class","cell svelte-1smq6qh"),A(e,"curr",n[7]===n[1]),A(e,"extra",n[0][n[7]]>4),U(e,"--color",s)},m(a,_){$(a,e,_),q(e,l),u||(r=M(e,"click",t),u=!0)},p(a,_){n=a,_&1&&o!==(o=(n[0][n[7]]||"")+"")&&ie(l,o),_&6&&A(e,"curr",n[7]===n[1]),_&5&&A(e,"extra",n[0][n[7]]>4)},d(a){a&&h(e),u=!1,r()}}}function ge(n){let e,o,l,s,u,r=n[2],t=[];for(let a=0;a<r.length;a+=1)t[a]=Y(X(n,r,a));return{c(){e=v("div");for(let a=0;a<t.length;a+=1)t[a].c();o=D(),l=v("button"),this.h()},l(a){e=k(a,"DIV",{class:!0});var _=y(e);for(let p=0;p<t.length;p+=1)t[p].l(_);o=P(_),l=k(_,"BUTTON",{class:!0});var i=y(l);i.forEach(h),_.forEach(h),this.h()},h(){d(l,"class","cell empty svelte-1smq6qh"),A(l,"curr",n[1]===null),U(l,"--color","var(--clr-wtr-none)"),d(e,"class","palette svelte-1smq6qh")},m(a,_){$(a,e,_);for(let i=0;i<t.length;i+=1)t[i].m(e,null);q(e,o),q(e,l),s||(u=M(l,"click",n[5]),s=!0)},p(a,[_]){if(_&15){r=a[2];let i;for(i=0;i<r.length;i+=1){const p=X(a,r,i);t[i]?t[i].p(p,_):(t[i]=Y(p),t[i].c(),t[i].m(e,o))}for(;i<t.length;i+=1)t[i].d(1);t.length=r.length}_&2&&A(l,"curr",a[1]===null)},i:K,o:K,d(a){a&&h(e),F(t,a),s=!1,u()}}}function be(n,e,o){const l=ae();let{counts:s={}}=e;const u=Array(_e).fill().map((i,p)=>p+1);let r=null;function t(i){o(1,r=i),l("color-pick",i)}const a=i=>t(i),_=()=>t(null);return n.$$set=i=>{"counts"in i&&o(0,s=i.counts)},[s,r,u,t,a,_]}class $e extends oe{constructor(e){super(),re(this,e,be,ge,ce,{counts:0})}}function de(n){if(n.length<=6)return[n];const e=n.length<=14?2:3,o=Math.floor(n.length/e),l=[];for(let s=0,u=0;s<n.length;u++,s+=o){const r=u<n.length%e?1:0;l.push(n.slice(s,s+o+r)),s+=r}return l}function Z(n,e,o){const l=n.slice();return l[15]=e[o],l}function x(n,e,o){const l=n.slice();return l[18]=e[o],l}function ee(n,e,o){const l=n.slice();return l[21]=e[o],l[23]=o,l}function ve(n){let e;return{c(){e=L("Reset")},l(o){e=z(o,"Reset")},m(o,l){$(o,e,l)},d(o){o&&h(e)}}}function ke(n){let e;return{c(){e=L("Discard")},l(o){e=z(o,"Discard")},m(o,l){$(o,e,l)},d(o){o&&h(e)}}}function we(n){let e;return{c(){e=L("Play")},l(o){e=z(o,"Play")},m(o,l){$(o,e,l)},d(o){o&&h(e)}}}function ye(n){let e,o,l,s,u,r;return e=new H({props:{$$slots:{default:[ve]},$$scope:{ctx:n}}}),e.$on("click",n[5]),l=new H({props:{href:ue+"/",$$slots:{default:[ke]},$$scope:{ctx:n}}}),u=new H({props:{disabled:!n[3],$$slots:{default:[we]},$$scope:{ctx:n}}}),u.$on("click",n[8]),{c(){O(e.$$.fragment),o=D(),O(l.$$.fragment),s=D(),O(u.$$.fragment)},l(t){R(e.$$.fragment,t),o=P(t),R(l.$$.fragment,t),s=P(t),R(u.$$.fragment,t)},m(t,a){j(e,t,a),$(t,o,a),j(l,t,a),$(t,s,a),j(u,t,a),r=!0},p(t,a){const _={};a&16777216&&(_.$$scope={dirty:a,ctx:t}),e.$set(_);const i={};a&16777216&&(i.$$scope={dirty:a,ctx:t}),l.$set(i);const p={};a&8&&(p.disabled=!t[3]),a&16777216&&(p.$$scope={dirty:a,ctx:t}),u.$set(p)},i(t){r||(S(e.$$.fragment,t),S(l.$$.fragment,t),S(u.$$.fragment,t),r=!0)},o(t){V(e.$$.fragment,t),V(l.$$.fragment,t),V(u.$$.fragment,t),r=!1},d(t){I(e,t),t&&h(o),I(l,t),t&&h(s),I(u,t)}}}function te(n){let e,o=`var(--clr-wtr${n[18].levels[n[23]]||""})`,l,s;function u(){return n[9](n[18],n[23])}return{c(){e=v("div"),this.h()},l(r){e=k(r,"DIV",{class:!0}),y(e).forEach(h),this.h()},h(){d(e,"class","block svelte-jgsu2c"),U(e,"background-color",o)},m(r,t){$(r,e,t),l||(s=M(e,"click",u),l=!0)},p(r,t){n=r,t&4&&o!==(o=`var(--clr-wtr${n[18].levels[n[23]]||""})`)&&U(e,"background-color",o)},d(r){r&&h(e),l=!1,s()}}}function le(n){let e,o=Array(4),l=[];for(let s=0;s<o.length;s+=1)l[s]=te(ee(n,o,s));return{c(){e=v("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=k(s,"DIV",{class:!0});var u=y(e);for(let r=0;r<l.length;r+=1)l[r].l(u);u.forEach(h),this.h()},h(){d(e,"class","tube svelte-jgsu2c")},m(s,u){$(s,e,u);for(let r=0;r<l.length;r+=1)l[r].m(e,null)},p(s,u){if(u&132){o=Array(4);let r;for(r=0;r<o.length;r+=1){const t=ee(s,o,r);l[r]?l[r].p(t,u):(l[r]=te(t),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=o.length}},d(s){s&&h(e),F(l,s)}}}function ne(n){let e,o,l=n[15],s=[];for(let u=0;u<l.length;u+=1)s[u]=le(x(n,l,u));return{c(){e=v("div");for(let u=0;u<s.length;u+=1)s[u].c();o=D(),this.h()},l(u){e=k(u,"DIV",{class:!0});var r=y(e);for(let t=0;t<s.length;t+=1)s[t].l(r);o=P(r),r.forEach(h),this.h()},h(){d(e,"class","tubes-row svelte-jgsu2c")},m(u,r){$(u,e,r);for(let t=0;t<s.length;t+=1)s[t].m(e,null);q(e,o)},p(u,r){if(r&132){l=u[15];let t;for(t=0;t<l.length;t+=1){const a=x(u,l,t);s[t]?s[t].p(a,r):(s[t]=le(a),s[t].c(),s[t].m(e,o))}for(;t<s.length;t+=1)s[t].d(1);s.length=l.length}},d(u){u&&h(e),F(s,u)}}}function Te(n){let e,o,l,s,u,r,t,a,_,i,p,w,T,N,G;e=new he({props:{$$slots:{default:[ye]},$$scope:{ctx:n}}}),i=new $e({props:{counts:n[1]}}),i.$on("color-pick",n[6]);let E=n[2],b=[];for(let c=0;c<E.length;c+=1)b[c]=ne(Z(n,E,c));return{c(){O(e.$$.fragment),o=D(),l=v("div"),s=v("label"),u=L("Num. Tubes"),r=D(),t=v("input"),_=D(),O(i.$$.fragment),p=D(),w=v("div");for(let c=0;c<b.length;c+=1)b[c].c();this.h()},l(c){R(e.$$.fragment,c),o=P(c),l=k(c,"DIV",{});var f=y(l);s=k(f,"LABEL",{for:!0});var m=y(s);u=z(m,"Num. Tubes"),m.forEach(h),r=P(f),t=k(f,"INPUT",{type:!0,name:!0,min:!0,max:!0,class:!0}),f.forEach(h),_=P(c),R(i.$$.fragment,c),p=P(c),w=k(c,"DIV",{});var C=y(w);for(let g=0;g<b.length;g+=1)b[g].l(C);C.forEach(h),this.h()},h(){d(s,"for","num_tubes"),d(t,"type","number"),d(t,"name","num_tubes"),d(t,"min","5"),d(t,"max","20"),t.value=a=n[0].tubes.length,d(t,"class","svelte-jgsu2c")},m(c,f){j(e,c,f),$(c,o,f),$(c,l,f),q(l,s),q(s,u),q(l,r),q(l,t),$(c,_,f),j(i,c,f),$(c,p,f),$(c,w,f);for(let m=0;m<b.length;m+=1)b[m].m(w,null);T=!0,N||(G=M(t,"change",n[4]),N=!0)},p(c,[f]){const m={};f&16777224&&(m.$$scope={dirty:f,ctx:c}),e.$set(m),(!T||f&1&&a!==(a=c[0].tubes.length)&&t.value!==a)&&(t.value=a);const C={};if(f&2&&(C.counts=c[1]),i.$set(C),f&132){E=c[2];let g;for(g=0;g<E.length;g+=1){const J=Z(c,E,g);b[g]?b[g].p(J,f):(b[g]=ne(J),b[g].c(),b[g].m(w,null))}for(;g<b.length;g+=1)b[g].d(1);b.length=E.length}},i(c){T||(S(e.$$.fragment,c),S(i.$$.fragment,c),T=!0)},o(c){V(e.$$.fragment,c),V(i.$$.fragment,c),T=!1},d(c){I(e,c),c&&h(o),c&&h(l),c&&h(_),I(i,c),c&&h(p),c&&h(w),F(b,c),N=!1,G()}}}function se(n,e=0){return Array(n).fill().map((o,l)=>({id:e+l,levels:["","","",""]}))}function Ee(n){return n.length<4?n.concat(new Array(4-n.length).fill("")):n}function Ce(n,e,o){let l;fe(n,W,c=>o(11,l=c));let s=l,u=[s.tubes],r=null,t={},a=!1;function _(c){const f=c.target.value;if(f<s.tubes.length&&o(0,s.tubes=s.tubes.slice(0,f),s),f>s.tubes.length){const m=f-s.tubes.length;o(0,s.tubes=[...s.tubes,...se(m,s.tubes.length)],s)}}function i(){o(0,s.tubes=se(10),s)}function p(c){return c.map(f=>{const m=f.levels.indexOf("");return m>=0?new Q(f.id,f.levels.slice(0,m)):f})}function w(c){r=c.detail}function T(c,f){console.debug(`apply color ${r} to tube ${c} level ${f}`);const m=s.tubes[c],C=Ee([...m.levels]);C[f]=r||"";const g=[...s.tubes];g[c]=new Q(m.id,C),o(0,s.tubes=g,s)}function N(){const c={};for(const f of s.tubes)for(const m of f.levels)m&&(c[m]=++c[m]||1);return c}function G(c){const f=new Set(Object.values(t));return f.size===1&&f.has(4)}function E(){a&&(W.set(new me(p(s.tubes))),pe(ue+"/"))}const b=(c,f)=>T(c.id,f);return n.$$.update=()=>{n.$$.dirty&1&&o(2,u=de(s.tubes)),n.$$.dirty&1&&o(1,t=N(s.tubes)),n.$$.dirty&2&&o(3,a=G())},[s,t,u,a,_,i,w,T,E,b]}class Ae extends oe{constructor(e){super(),re(this,e,Ce,Te,ce,{})}}export{Ae as default};
