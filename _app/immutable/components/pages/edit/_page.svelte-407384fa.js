import{S as ie,i as ae,s as ue,k as y,a as C,l as E,m as T,c as D,h,n as k,J as R,p as K,b as d,D as q,K as M,B as X,L as Q,P as _e,q as V,r as j,u as he,w as S,x as U,y as G,f as H,t as F,z as J,H as me}from"../../../chunks/index-5bc28d6e.js";import{h as z}from"../../../chunks/singletons-2d098f24.js";import{b as fe}from"../../../chunks/paths-d538d824.js";import{N as pe,B as ge,a as W,T as Y,c as Z}from"../../../chunks/game-7d8ba482.js";z.disable_scroll_handling;const $e=z.goto;z.invalidate;z.invalidateAll;z.preload_data;z.preload_code;z.before_navigate;z.after_navigate;function x(n,e,s){const l=n.slice();return l[7]=e[s],l}function ee(n){let e,s=(n[0][n[7]]||"")+"",l,o=`var(--clr-wtr${n[7]>=0?n[7]:"-none"})`,c,r;function t(){return n[4](n[7])}return{c(){e=y("button"),l=V(s),this.h()},l(i){e=E(i,"BUTTON",{class:!0});var f=T(e);l=j(f,s),f.forEach(h),this.h()},h(){k(e,"class","cell svelte-1smq6qh"),R(e,"curr",n[7]===n[1]),R(e,"extra",n[0][n[7]]>4),K(e,"--color",o)},m(i,f){d(i,e,f),q(e,l),c||(r=M(e,"click",t),c=!0)},p(i,f){n=i,f&1&&s!==(s=(n[0][n[7]]||"")+"")&&he(l,s),f&6&&R(e,"curr",n[7]===n[1]),f&5&&R(e,"extra",n[0][n[7]]>4)},d(i){i&&h(e),c=!1,r()}}}function de(n){let e,s,l,o,c,r=n[2],t=[];for(let i=0;i<r.length;i+=1)t[i]=ee(x(n,r,i));return{c(){e=y("div");for(let i=0;i<t.length;i+=1)t[i].c();s=C(),l=y("button"),this.h()},l(i){e=E(i,"DIV",{class:!0});var f=T(e);for(let $=0;$<t.length;$+=1)t[$].l(f);s=D(f),l=E(f,"BUTTON",{class:!0});var u=T(l);u.forEach(h),f.forEach(h),this.h()},h(){k(l,"class","cell empty svelte-1smq6qh"),R(l,"curr",n[1]===null),K(l,"--color","var(--clr-wtr-none)"),k(e,"class","palette svelte-1smq6qh")},m(i,f){d(i,e,f);for(let u=0;u<t.length;u+=1)t[u].m(e,null);q(e,s),q(e,l),o||(c=M(l,"click",n[5]),o=!0)},p(i,[f]){if(f&15){r=i[2];let u;for(u=0;u<r.length;u+=1){const $=x(i,r,u);t[u]?t[u].p($,f):(t[u]=ee($),t[u].c(),t[u].m(e,s))}for(;u<t.length;u+=1)t[u].d(1);t.length=r.length}f&2&&R(l,"curr",i[1]===null)},i:X,o:X,d(i){i&&h(e),Q(t,i),o=!1,c()}}}function ve(n,e,s){const l=_e();let{counts:o={}}=e;const c=Array(pe).fill().map((u,$)=>$+1);let r=null;function t(u){s(1,r=u),l("color-pick",u)}const i=u=>t(u),f=()=>t(null);return n.$$set=u=>{"counts"in u&&s(0,o=u.counts)},[o,r,c,t,i,f]}class be extends ie{constructor(e){super(),ae(this,e,ve,de,ue,{counts:0})}}function ke(n){const e=n.length<=6?n.length:n.length<=14?(n.length+1)/2:5,s=[];for(let l=0;l<n.length;l+=e)s.push(n.slice(l,l+e));return s}function te(n,e,s){const l=n.slice();return l[15]=e[s],l}function le(n,e,s){const l=n.slice();return l[18]=e[s],l}function ne(n,e,s){const l=n.slice();return l[21]=e[s],l[23]=s,l}function we(n){let e;return{c(){e=V("Reset")},l(s){e=j(s,"Reset")},m(s,l){d(s,e,l)},d(s){s&&h(e)}}}function ye(n){let e;return{c(){e=V("Discard")},l(s){e=j(s,"Discard")},m(s,l){d(s,e,l)},d(s){s&&h(e)}}}function Ee(n){let e;return{c(){e=V("Play")},l(s){e=j(s,"Play")},m(s,l){d(s,e,l)},d(s){s&&h(e)}}}function Te(n){let e,s,l,o,c,r;return e=new W({props:{$$slots:{default:[we]},$$scope:{ctx:n}}}),e.$on("click",n[5]),l=new W({props:{href:fe+"/",$$slots:{default:[ye]},$$scope:{ctx:n}}}),c=new W({props:{disabled:!n[3],$$slots:{default:[Ee]},$$scope:{ctx:n}}}),c.$on("click",n[8]),{c(){S(e.$$.fragment),s=C(),S(l.$$.fragment),o=C(),S(c.$$.fragment)},l(t){U(e.$$.fragment,t),s=D(t),U(l.$$.fragment,t),o=D(t),U(c.$$.fragment,t)},m(t,i){G(e,t,i),d(t,s,i),G(l,t,i),d(t,o,i),G(c,t,i),r=!0},p(t,i){const f={};i&16777216&&(f.$$scope={dirty:i,ctx:t}),e.$set(f);const u={};i&16777216&&(u.$$scope={dirty:i,ctx:t}),l.$set(u);const $={};i&8&&($.disabled=!t[3]),i&16777216&&($.$$scope={dirty:i,ctx:t}),c.$set($)},i(t){r||(H(e.$$.fragment,t),H(l.$$.fragment,t),H(c.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),F(l.$$.fragment,t),F(c.$$.fragment,t),r=!1},d(t){J(e,t),t&&h(s),J(l,t),t&&h(o),J(c,t)}}}function se(n){let e,s=`var(--clr-wtr${n[18].levels[n[23]]||""})`,l,o;function c(){return n[9](n[18],n[23])}return{c(){e=y("div"),this.h()},l(r){e=E(r,"DIV",{class:!0}),T(e).forEach(h),this.h()},h(){k(e,"class","block svelte-jgsu2c"),K(e,"background-color",s)},m(r,t){d(r,e,t),l||(o=M(e,"click",c),l=!0)},p(r,t){n=r,t&4&&s!==(s=`var(--clr-wtr${n[18].levels[n[23]]||""})`)&&K(e,"background-color",s)},d(r){r&&h(e),l=!1,o()}}}function oe(n){let e,s=Array(4),l=[];for(let o=0;o<s.length;o+=1)l[o]=se(ne(n,s,o));return{c(){e=y("div");for(let o=0;o<l.length;o+=1)l[o].c();this.h()},l(o){e=E(o,"DIV",{class:!0});var c=T(e);for(let r=0;r<l.length;r+=1)l[r].l(c);c.forEach(h),this.h()},h(){k(e,"class","tube svelte-jgsu2c")},m(o,c){d(o,e,c);for(let r=0;r<l.length;r+=1)l[r].m(e,null)},p(o,c){if(c&132){s=Array(4);let r;for(r=0;r<s.length;r+=1){const t=ne(o,s,r);l[r]?l[r].p(t,c):(l[r]=se(t),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=s.length}},d(o){o&&h(e),Q(l,o)}}}function re(n){let e,s,l=n[15],o=[];for(let c=0;c<l.length;c+=1)o[c]=oe(le(n,l,c));return{c(){e=y("div");for(let c=0;c<o.length;c+=1)o[c].c();s=C(),this.h()},l(c){e=E(c,"DIV",{class:!0});var r=T(e);for(let t=0;t<o.length;t+=1)o[t].l(r);s=D(r),r.forEach(h),this.h()},h(){k(e,"class","tubes-row svelte-jgsu2c")},m(c,r){d(c,e,r);for(let t=0;t<o.length;t+=1)o[t].m(e,null);q(e,s)},p(c,r){if(r&132){l=c[15];let t;for(t=0;t<l.length;t+=1){const i=le(c,l,t);o[t]?o[t].p(i,r):(o[t]=oe(i),o[t].c(),o[t].m(e,s))}for(;t<o.length;t+=1)o[t].d(1);o.length=l.length}},d(c){c&&h(e),Q(o,c)}}}function Pe(n){let e,s,l,o,c,r,t,i,f,u,$,A,b,N,P,B,I,g;o=new ge({props:{$$slots:{default:[Te]},$$scope:{ctx:n}}}),b=new be({props:{counts:n[1]}}),b.$on("color-pick",n[6]);let m=n[2],_=[];for(let a=0;a<m.length;a+=1)_[a]=re(te(n,m,a));return{c(){e=y("h2"),s=V("Edit Puzzle"),l=C(),S(o.$$.fragment),c=C(),r=y("div"),t=y("label"),i=V("Num. Tubes"),f=C(),u=y("input"),A=C(),S(b.$$.fragment),N=C(),P=y("div");for(let a=0;a<_.length;a+=1)_[a].c();this.h()},l(a){e=E(a,"H2",{});var p=T(e);s=j(p,"Edit Puzzle"),p.forEach(h),l=D(a),U(o.$$.fragment,a),c=D(a),r=E(a,"DIV",{});var w=T(r);t=E(w,"LABEL",{for:!0});var L=T(t);i=j(L,"Num. Tubes"),L.forEach(h),f=D(w),u=E(w,"INPUT",{type:!0,name:!0,min:!0,max:!0,class:!0}),w.forEach(h),A=D(a),U(b.$$.fragment,a),N=D(a),P=E(a,"DIV",{});var v=T(P);for(let O=0;O<_.length;O+=1)_[O].l(v);v.forEach(h),this.h()},h(){k(t,"for","num_tubes"),k(u,"type","number"),k(u,"name","num_tubes"),k(u,"min","5"),k(u,"max","15"),u.value=$=n[0].length,k(u,"class","svelte-jgsu2c")},m(a,p){d(a,e,p),q(e,s),d(a,l,p),G(o,a,p),d(a,c,p),d(a,r,p),q(r,t),q(t,i),q(r,f),q(r,u),d(a,A,p),G(b,a,p),d(a,N,p),d(a,P,p);for(let w=0;w<_.length;w+=1)_[w].m(P,null);B=!0,I||(g=M(u,"change",n[4]),I=!0)},p(a,[p]){const w={};p&16777224&&(w.$$scope={dirty:p,ctx:a}),o.$set(w),(!B||p&1&&$!==($=a[0].length)&&u.value!==$)&&(u.value=$);const L={};if(p&2&&(L.counts=a[1]),b.$set(L),p&132){m=a[2];let v;for(v=0;v<m.length;v+=1){const O=te(a,m,v);_[v]?_[v].p(O,p):(_[v]=re(O),_[v].c(),_[v].m(P,null))}for(;v<_.length;v+=1)_[v].d(1);_.length=m.length}},i(a){B||(H(o.$$.fragment,a),H(b.$$.fragment,a),B=!0)},o(a){F(o.$$.fragment,a),F(b.$$.fragment,a),B=!1},d(a){a&&h(e),a&&h(l),J(o,a),a&&h(c),a&&h(r),a&&h(A),J(b,a),a&&h(N),a&&h(P),Q(_,a),I=!1,g()}}}function ce(n,e=0){return Array(n).fill().map((s,l)=>({id:e+l,levels:["","","",""]}))}function Ce(n){return n.length<4?n.concat(new Array(4-n.length).fill("")):n}function De(n,e,s){let l;me(n,Z,g=>s(11,l=g));let o=l,c=[o],r=null,t={},i=!1;function f(g){const m=g.target.value;if(m<o.length&&s(0,o=o.slice(0,m)),m>o.length){const _=m-o.length;s(0,o=[...o,...ce(_,o.length)])}}function u(){s(0,o=ce(10))}function $(g){return g.map(m=>{const _=m.levels.indexOf("");return _>=0?new Y(m.id,m.levels.slice(0,_)):m})}function A(g){r=g.detail}function b(g,m){console.debug(`apply color ${r} to tube ${g} level ${m}`);const _=o[g],a=Ce([..._.levels]);a[m]=r||"";const p=[...o];p[g]=new Y(_.id,a),s(0,o=p)}function N(){const g={};for(const m of o)for(const _ of m.levels)_&&(g[_]=++g[_]||1);return g}function P(g){const m=new Set(Object.values(t));return m.size===1&&m.has(4)}function B(){i&&(Z.set($(o)),$e(fe+"/"))}const I=(g,m)=>b(g.id,m);return n.$$.update=()=>{n.$$.dirty&1&&s(2,c=ke(o)),n.$$.dirty&1&&s(1,t=N()),n.$$.dirty&2&&s(3,i=P())},[o,t,c,i,f,u,A,b,B,I]}class Ne extends ie{constructor(e){super(),ae(this,e,De,Pe,ue,{})}}export{Ne as default};
