import{S as ue,i as ie,s as ae,k as y,a as C,l as E,m as T,c as D,h,n as k,J as R,p as K,b as $,D as q,K as M,B as X,L as Q,P as _e,q as S,r as V,u as he,w as L,x as G,y as U,f as H,t as F,z as J,H as me}from"../../../chunks/index-5bc28d6e.js";import{h as z}from"../../../chunks/singletons-2d098f24.js";import{b as fe}from"../../../chunks/paths-d538d824.js";import{N as pe,B as be,a as W,T as Y,c as Z,G as ge}from"../../../chunks/game-c3d881e5.js";z.disable_scroll_handling;const $e=z.goto;z.invalidate;z.invalidateAll;z.preload_data;z.preload_code;z.before_navigate;z.after_navigate;function x(n,e,o){const l=n.slice();return l[7]=e[o],l}function ee(n){let e,o=(n[0][n[7]]||"")+"",l,s=`var(--clr-wtr${n[7]>=0?n[7]:"-none"})`,c,r;function t(){return n[4](n[7])}return{c(){e=y("button"),l=S(o),this.h()},l(u){e=E(u,"BUTTON",{class:!0});var f=T(e);l=V(f,o),f.forEach(h),this.h()},h(){k(e,"class","cell svelte-1smq6qh"),R(e,"curr",n[7]===n[1]),R(e,"extra",n[0][n[7]]>4),K(e,"--color",s)},m(u,f){$(u,e,f),q(e,l),c||(r=M(e,"click",t),c=!0)},p(u,f){n=u,f&1&&o!==(o=(n[0][n[7]]||"")+"")&&he(l,o),f&6&&R(e,"curr",n[7]===n[1]),f&5&&R(e,"extra",n[0][n[7]]>4)},d(u){u&&h(e),c=!1,r()}}}function de(n){let e,o,l,s,c,r=n[2],t=[];for(let u=0;u<r.length;u+=1)t[u]=ee(x(n,r,u));return{c(){e=y("div");for(let u=0;u<t.length;u+=1)t[u].c();o=C(),l=y("button"),this.h()},l(u){e=E(u,"DIV",{class:!0});var f=T(e);for(let g=0;g<t.length;g+=1)t[g].l(f);o=D(f),l=E(f,"BUTTON",{class:!0});var a=T(l);a.forEach(h),f.forEach(h),this.h()},h(){k(l,"class","cell empty svelte-1smq6qh"),R(l,"curr",n[1]===null),K(l,"--color","var(--clr-wtr-none)"),k(e,"class","palette svelte-1smq6qh")},m(u,f){$(u,e,f);for(let a=0;a<t.length;a+=1)t[a].m(e,null);q(e,o),q(e,l),s||(c=M(l,"click",n[5]),s=!0)},p(u,[f]){if(f&15){r=u[2];let a;for(a=0;a<r.length;a+=1){const g=x(u,r,a);t[a]?t[a].p(g,f):(t[a]=ee(g),t[a].c(),t[a].m(e,o))}for(;a<t.length;a+=1)t[a].d(1);t.length=r.length}f&2&&R(l,"curr",u[1]===null)},i:X,o:X,d(u){u&&h(e),Q(t,u),s=!1,c()}}}function ve(n,e,o){const l=_e();let{counts:s={}}=e;const c=Array(pe).fill().map((a,g)=>g+1);let r=null;function t(a){o(1,r=a),l("color-pick",a)}const u=a=>t(a),f=()=>t(null);return n.$$set=a=>{"counts"in a&&o(0,s=a.counts)},[s,r,c,t,u,f]}class ke extends ue{constructor(e){super(),ie(this,e,ve,de,ae,{counts:0})}}function we(n){const e=n.length<=6?n.length:n.length<=14?(n.length+1)/2:5,o=[];for(let l=0;l<n.length;l+=e)o.push(n.slice(l,l+e));return o}function te(n,e,o){const l=n.slice();return l[15]=e[o],l}function le(n,e,o){const l=n.slice();return l[18]=e[o],l}function ne(n,e,o){const l=n.slice();return l[21]=e[o],l[23]=o,l}function ye(n){let e;return{c(){e=S("Reset")},l(o){e=V(o,"Reset")},m(o,l){$(o,e,l)},d(o){o&&h(e)}}}function Ee(n){let e;return{c(){e=S("Discard")},l(o){e=V(o,"Discard")},m(o,l){$(o,e,l)},d(o){o&&h(e)}}}function Te(n){let e;return{c(){e=S("Play")},l(o){e=V(o,"Play")},m(o,l){$(o,e,l)},d(o){o&&h(e)}}}function Pe(n){let e,o,l,s,c,r;return e=new W({props:{$$slots:{default:[ye]},$$scope:{ctx:n}}}),e.$on("click",n[5]),l=new W({props:{href:fe+"/",$$slots:{default:[Ee]},$$scope:{ctx:n}}}),c=new W({props:{disabled:!n[3],$$slots:{default:[Te]},$$scope:{ctx:n}}}),c.$on("click",n[8]),{c(){L(e.$$.fragment),o=C(),L(l.$$.fragment),s=C(),L(c.$$.fragment)},l(t){G(e.$$.fragment,t),o=D(t),G(l.$$.fragment,t),s=D(t),G(c.$$.fragment,t)},m(t,u){U(e,t,u),$(t,o,u),U(l,t,u),$(t,s,u),U(c,t,u),r=!0},p(t,u){const f={};u&16777216&&(f.$$scope={dirty:u,ctx:t}),e.$set(f);const a={};u&16777216&&(a.$$scope={dirty:u,ctx:t}),l.$set(a);const g={};u&8&&(g.disabled=!t[3]),u&16777216&&(g.$$scope={dirty:u,ctx:t}),c.$set(g)},i(t){r||(H(e.$$.fragment,t),H(l.$$.fragment,t),H(c.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),F(l.$$.fragment,t),F(c.$$.fragment,t),r=!1},d(t){J(e,t),t&&h(o),J(l,t),t&&h(s),J(c,t)}}}function se(n){let e,o=`var(--clr-wtr${n[18].levels[n[23]]||""})`,l,s;function c(){return n[9](n[18],n[23])}return{c(){e=y("div"),this.h()},l(r){e=E(r,"DIV",{class:!0}),T(e).forEach(h),this.h()},h(){k(e,"class","block svelte-jgsu2c"),K(e,"background-color",o)},m(r,t){$(r,e,t),l||(s=M(e,"click",c),l=!0)},p(r,t){n=r,t&4&&o!==(o=`var(--clr-wtr${n[18].levels[n[23]]||""})`)&&K(e,"background-color",o)},d(r){r&&h(e),l=!1,s()}}}function oe(n){let e,o=Array(4),l=[];for(let s=0;s<o.length;s+=1)l[s]=se(ne(n,o,s));return{c(){e=y("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=E(s,"DIV",{class:!0});var c=T(e);for(let r=0;r<l.length;r+=1)l[r].l(c);c.forEach(h),this.h()},h(){k(e,"class","tube svelte-jgsu2c")},m(s,c){$(s,e,c);for(let r=0;r<l.length;r+=1)l[r].m(e,null)},p(s,c){if(c&132){o=Array(4);let r;for(r=0;r<o.length;r+=1){const t=ne(s,o,r);l[r]?l[r].p(t,c):(l[r]=se(t),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=o.length}},d(s){s&&h(e),Q(l,s)}}}function re(n){let e,o,l=n[15],s=[];for(let c=0;c<l.length;c+=1)s[c]=oe(le(n,l,c));return{c(){e=y("div");for(let c=0;c<s.length;c+=1)s[c].c();o=C(),this.h()},l(c){e=E(c,"DIV",{class:!0});var r=T(e);for(let t=0;t<s.length;t+=1)s[t].l(r);o=D(r),r.forEach(h),this.h()},h(){k(e,"class","tubes-row svelte-jgsu2c")},m(c,r){$(c,e,r);for(let t=0;t<s.length;t+=1)s[t].m(e,null);q(e,o)},p(c,r){if(r&132){l=c[15];let t;for(t=0;t<l.length;t+=1){const u=le(c,l,t);s[t]?s[t].p(u,r):(s[t]=oe(u),s[t].c(),s[t].m(e,o))}for(;t<s.length;t+=1)s[t].d(1);s.length=l.length}},d(c){c&&h(e),Q(s,c)}}}function Ce(n){let e,o,l,s,c,r,t,u,f,a,g,A,v,N,P,B,j,b;s=new be({props:{$$slots:{default:[Pe]},$$scope:{ctx:n}}}),v=new ke({props:{counts:n[1]}}),v.$on("color-pick",n[6]);let m=n[2],_=[];for(let i=0;i<m.length;i+=1)_[i]=re(te(n,m,i));return{c(){e=y("h2"),o=S("Edit Puzzle"),l=C(),L(s.$$.fragment),c=C(),r=y("div"),t=y("label"),u=S("Num. Tubes"),f=C(),a=y("input"),A=C(),L(v.$$.fragment),N=C(),P=y("div");for(let i=0;i<_.length;i+=1)_[i].c();this.h()},l(i){e=E(i,"H2",{});var p=T(e);o=V(p,"Edit Puzzle"),p.forEach(h),l=D(i),G(s.$$.fragment,i),c=D(i),r=E(i,"DIV",{});var w=T(r);t=E(w,"LABEL",{for:!0});var I=T(t);u=V(I,"Num. Tubes"),I.forEach(h),f=D(w),a=E(w,"INPUT",{type:!0,name:!0,min:!0,max:!0,class:!0}),w.forEach(h),A=D(i),G(v.$$.fragment,i),N=D(i),P=E(i,"DIV",{});var d=T(P);for(let O=0;O<_.length;O+=1)_[O].l(d);d.forEach(h),this.h()},h(){k(t,"for","num_tubes"),k(a,"type","number"),k(a,"name","num_tubes"),k(a,"min","5"),k(a,"max","20"),a.value=g=n[0].tubes.length,k(a,"class","svelte-jgsu2c")},m(i,p){$(i,e,p),q(e,o),$(i,l,p),U(s,i,p),$(i,c,p),$(i,r,p),q(r,t),q(t,u),q(r,f),q(r,a),$(i,A,p),U(v,i,p),$(i,N,p),$(i,P,p);for(let w=0;w<_.length;w+=1)_[w].m(P,null);B=!0,j||(b=M(a,"change",n[4]),j=!0)},p(i,[p]){const w={};p&16777224&&(w.$$scope={dirty:p,ctx:i}),s.$set(w),(!B||p&1&&g!==(g=i[0].tubes.length)&&a.value!==g)&&(a.value=g);const I={};if(p&2&&(I.counts=i[1]),v.$set(I),p&132){m=i[2];let d;for(d=0;d<m.length;d+=1){const O=te(i,m,d);_[d]?_[d].p(O,p):(_[d]=re(O),_[d].c(),_[d].m(P,null))}for(;d<_.length;d+=1)_[d].d(1);_.length=m.length}},i(i){B||(H(s.$$.fragment,i),H(v.$$.fragment,i),B=!0)},o(i){F(s.$$.fragment,i),F(v.$$.fragment,i),B=!1},d(i){i&&h(e),i&&h(l),J(s,i),i&&h(c),i&&h(r),i&&h(A),J(v,i),i&&h(N),i&&h(P),Q(_,i),j=!1,b()}}}function ce(n,e=0){return Array(n).fill().map((o,l)=>({id:e+l,levels:["","","",""]}))}function De(n){return n.length<4?n.concat(new Array(4-n.length).fill("")):n}function qe(n,e,o){let l;me(n,Z,b=>o(11,l=b));let s=l,c=[s.tubes],r=null,t={},u=!1;function f(b){const m=b.target.value;if(m<s.tubes.length&&o(0,s.tubes=s.tubes.slice(0,m),s),m>s.tubes.length){const _=m-s.tubes.length;o(0,s.tubes=[...s.tubes,...ce(_,s.tubes.length)],s)}}function a(){o(0,s.tubes=ce(10),s)}function g(b){return b.map(m=>{const _=m.levels.indexOf("");return _>=0?new Y(m.id,m.levels.slice(0,_)):m})}function A(b){r=b.detail}function v(b,m){console.debug(`apply color ${r} to tube ${b} level ${m}`);const _=s.tubes[b],i=De([..._.levels]);i[m]=r||"";const p=[...s.tubes];p[b]=new Y(_.id,i),o(0,s.tubes=p,s)}function N(){const b={};for(const m of s.tubes)for(const _ of m.levels)_&&(b[_]=++b[_]||1);return b}function P(b){const m=new Set(Object.values(t));return m.size===1&&m.has(4)}function B(){u&&(Z.set(new ge(g(s.tubes))),$e(fe+"/"))}const j=(b,m)=>v(b.id,m);return n.$$.update=()=>{n.$$.dirty&1&&o(2,c=we(s.tubes)),n.$$.dirty&1&&o(1,t=N(s.tubes)),n.$$.dirty&2&&o(3,u=P())},[s,t,c,u,f,a,A,v,B,j]}class Oe extends ue{constructor(e){super(),ie(this,e,qe,Ce,ae,{})}}export{Oe as default};
