import{I as U,S as J,i as Y,s as z,k as E,a as B,q as R,l as I,m as D,h as b,c as C,r as H,n as w,J as L,b as v,D as V,K as ce,f as p,g as O,d as P,u as fe,t as $,L as A,p as F,M as ie,N as j,O as ae,P as he,w as M,x as N,y as G,z as W,e as q,H as _e,o as ge}from"../../chunks/index-5bc28d6e.js";import{b as me}from"../../chunks/paths-d538d824.js";import{B as be,G as K,a as T,c as Q,r as de}from"../../chunks/game-06c5939e.js";function pe(o){const e=o-1;return e*e*e+1}function X(o,{delay:e=0,duration:t=400,easing:l=U}={}){const n=+getComputedStyle(o).opacity;return{delay:e,duration:t,easing:l,css:s=>`opacity: ${s*n}`}}function Z(o,{delay:e=0,duration:t=400,easing:l=pe,x:n=0,y:s=0,opacity:i=0}={}){const c=getComputedStyle(o),r=+c.opacity,u=c.transform==="none"?"":c.transform,a=r*(1-i);return{delay:e,duration:t,easing:l,css:(g,f)=>`
			transform: ${u} translate(${(1-g)*n}px, ${(1-g)*s}px);
			opacity: ${r-a*f}`}}function x(o,e,t){const l=o.slice();return l[5]=e[t],l}function ee(o){let e,t,l=`var(--clr-wtr${o[5]})`,n;return{c(){e=E("div"),this.h()},l(s){e=I(s,"DIV",{class:!0}),D(e).forEach(b),this.h()},h(){w(e,"class","waterblock svelte-1ioo7u3"),F(e,"background-color",l)},m(s,i){v(s,e,i),n=!0},p(s,i){o=s,i&1&&l!==(l=`var(--clr-wtr${o[5]})`)&&F(e,"background-color",l)},i(s){n||(s&&ie(()=>{t||(t=j(e,Z,{y:-200,duration:200,easing:U},!0)),t.run(1)}),n=!0)},o(s){s&&(t||(t=j(e,Z,{y:-200,duration:200,easing:U},!1)),t.run(0)),n=!1},d(s){s&&b(e),s&&t&&t.end()}}}function $e(o){let e,t,l,n,s,i,c=o[0].name+"",r,u,a,g,f=o[0].levels,h=[];for(let _=0;_<f.length;_+=1)h[_]=ee(x(o,f,_));const S=_=>$(h[_],1,1,()=>{h[_]=null});return{c(){e=E("div"),t=E("div"),l=E("div"),n=B();for(let _=0;_<h.length;_+=1)h[_].c();s=B(),i=E("h4"),r=R(c),this.h()},l(_){e=I(_,"DIV",{class:!0});var d=D(e);t=I(d,"DIV",{class:!0,selectable:!0});var m=D(t);l=I(m,"DIV",{class:!0}),D(l).forEach(b),n=C(m);for(let y=0;y<h.length;y+=1)h[y].l(m);m.forEach(b),s=C(d),i=I(d,"H4",{class:!0});var k=D(i);r=H(k,c),k.forEach(b),d.forEach(b),this.h()},h(){w(l,"class","plug svelte-1ioo7u3"),w(t,"class","tube svelte-1ioo7u3"),w(t,"selectable",o[3]),L(t,"selected",o[1]),L(t,"highlight",o[2]),L(t,"unplugged",!o[0].done),w(i,"class","svelte-1ioo7u3"),w(e,"class","tube-slot")},m(_,d){v(_,e,d),V(e,t),V(t,l),V(t,n);for(let m=0;m<h.length;m+=1)h[m].m(t,null);V(e,s),V(e,i),V(i,r),u=!0,a||(g=ce(t,"click",o[4]),a=!0)},p(_,[d]){if(d&1){f=_[0].levels;let m;for(m=0;m<f.length;m+=1){const k=x(_,f,m);h[m]?(h[m].p(k,d),p(h[m],1)):(h[m]=ee(k),h[m].c(),p(h[m],1),h[m].m(t,null))}for(O(),m=f.length;m<h.length;m+=1)S(m);P()}(!u||d&8)&&w(t,"selectable",_[3]),(!u||d&2)&&L(t,"selected",_[1]),(!u||d&4)&&L(t,"highlight",_[2]),(!u||d&1)&&L(t,"unplugged",!_[0].done),(!u||d&1)&&c!==(c=_[0].name+"")&&fe(r,c)},i(_){if(!u){for(let d=0;d<f.length;d+=1)p(h[d]);u=!0}},o(_){h=h.filter(Boolean);for(let d=0;d<h.length;d+=1)$(h[d]);u=!1},d(_){_&&b(e),A(h,_),a=!1,g()}}}function ve(o,e,t){let{tube:l}=e,{selected:n=!1}=e,{highlight:s=!1}=e,{selectable:i}=e;function c(r){ae.call(this,o,r)}return o.$$set=r=>{"tube"in r&&t(0,l=r.tube),"selected"in r&&t(1,n=r.selected),"highlight"in r&&t(2,s=r.highlight),"selectable"in r&&t(3,i=r.selectable)},[l,n,s,i,c]}class ke extends J{constructor(e){super(),Y(this,e,ve,$e,z,{tube:0,selected:1,highlight:2,selectable:3})}}function te(o,e,t){const l=o.slice();return l[9]=e[t],l}function le(o,e,t){const l=o.slice();return l[12]=e[t],l}function ne(o){let e,t;function l(){return o[6](o[12])}return e=new ke({props:{tube:o[12],selected:o[0]===o[12].id,selectable:o[3](o[12].id,o[0]),highlight:o[1]===o[12].id}}),e.$on("click",l),{c(){M(e.$$.fragment)},l(n){N(e.$$.fragment,n)},m(n,s){G(e,n,s),t=!0},p(n,s){o=n;const i={};s&4&&(i.tube=o[12]),s&5&&(i.selected=o[0]===o[12].id),s&5&&(i.selectable=o[3](o[12].id,o[0])),s&6&&(i.highlight=o[1]===o[12].id),e.$set(i)},i(n){t||(p(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function se(o){let e,t,l,n=o[9],s=[];for(let c=0;c<n.length;c+=1)s[c]=ne(le(o,n,c));const i=c=>$(s[c],1,1,()=>{s[c]=null});return{c(){e=E("div");for(let c=0;c<s.length;c+=1)s[c].c();t=B(),this.h()},l(c){e=I(c,"DIV",{class:!0});var r=D(e);for(let u=0;u<s.length;u+=1)s[u].l(r);t=C(r),r.forEach(b),this.h()},h(){w(e,"class","tubes-row svelte-1m5libu")},m(c,r){v(c,e,r);for(let u=0;u<s.length;u+=1)s[u].m(e,null);V(e,t),l=!0},p(c,r){if(r&31){n=c[9];let u;for(u=0;u<n.length;u+=1){const a=le(c,n,u);s[u]?(s[u].p(a,r),p(s[u],1)):(s[u]=ne(a),s[u].c(),p(s[u],1),s[u].m(e,t))}for(O(),u=n.length;u<s.length;u+=1)i(u);P()}},i(c){if(!l){for(let r=0;r<n.length;r+=1)p(s[r]);l=!0}},o(c){s=s.filter(Boolean);for(let r=0;r<s.length;r+=1)$(s[r]);l=!1},d(c){c&&b(e),A(s,c)}}}function we(o){let e,t,l=o[2],n=[];for(let i=0;i<l.length;i+=1)n[i]=se(te(o,l,i));const s=i=>$(n[i],1,1,()=>{n[i]=null});return{c(){e=E("div");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var c=D(e);for(let r=0;r<n.length;r+=1)n[r].l(c);c.forEach(b),this.h()},h(){w(e,"class","tubes-container")},m(i,c){v(i,e,c);for(let r=0;r<n.length;r+=1)n[r].m(e,null);t=!0},p(i,[c]){if(c&31){l=i[2];let r;for(r=0;r<l.length;r+=1){const u=te(i,l,r);n[r]?(n[r].p(u,c),p(n[r],1)):(n[r]=se(u),n[r].c(),p(n[r],1),n[r].m(e,null))}for(O(),r=l.length;r<n.length;r+=1)s(r);P()}},i(i){if(!t){for(let c=0;c<l.length;c+=1)p(n[c]);t=!0}},o(i){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)$(n[c]);t=!1},d(i){i&&b(e),A(n,i)}}}function ye(o,e,t){const l=he();let{tubes:n}=e,{selected:s=null}=e,{highlight:i=null}=e,c=[];function r(f){const h=f.length<=6?f.length:f.length<=14?(f.length+1)/2:5,S=[];for(let _=0;_<f.length;_+=h)S.push(n.slice(_,_+h));return S}function u(f){return s===f?!0:!(n[f].done||s===null&&n[f].empty||s!==null&&n[f].full)}function a(f){u(f)&&l("select",f)}const g=f=>a(f.id);return o.$$set=f=>{"tubes"in f&&t(5,n=f.tubes),"selected"in f&&t(0,s=f.selected),"highlight"in f&&t(1,i=f.highlight)},o.$$.update=()=>{o.$$.dirty&32&&t(2,c=r(n))},[s,i,c,u,a,n,g]}class Ee extends J{constructor(e){super(),Y(this,e,ye,we,z,{tubes:5,selected:0,highlight:1})}}function Ie(o){let e,t,l,n,s,i;return{c(){e=E("div"),t=E("h2"),l=R(o[0]),this.h()},l(c){e=I(c,"DIV",{class:!0});var r=D(e);t=I(r,"H2",{});var u=D(t);l=H(u,o[0]),u.forEach(b),r.forEach(b),this.h()},h(){w(e,"class",n="modal "+(o[1]||"")+" svelte-alsri9")},m(c,r){v(c,e,r),V(e,t),V(t,l),i=!0},p(c,[r]){(!i||r&1)&&fe(l,c[0]),(!i||r&2&&n!==(n="modal "+(c[1]||"")+" svelte-alsri9"))&&w(e,"class",n)},i(c){i||(ie(()=>{s||(s=j(e,X,{delay:100},!0)),s.run(1)}),i=!0)},o(c){s||(s=j(e,X,{delay:100},!1)),s.run(0),i=!1},d(c){c&&b(e),c&&s&&s.end()}}}function De(o,e,t){let{message:l}=e,{result:n}=e;return o.$$set=s=>{"message"in s&&t(0,l=s.message),"result"in s&&t(1,n=s.result)},o.$$.update=()=>{o.$$.dirty&2&&console.log(n),o.$$.dirty&2&&t(0,l=n==="win"?"🏅 You Win 🏅":"You lose 😞")},[l,n]}class Se extends J{constructor(e){super(),Y(this,e,De,Ie,z,{message:0,result:1})}}function Ve(){return new Worker(""+new URL("../../workers/solve-worker-a18bb6af.js",import.meta.url).href)}function Be(o){let e;return{c(){e=R("New")},l(t){e=H(t,"New")},m(t,l){v(t,e,l)},d(t){t&&b(e)}}}function Ce(o){let e;return{c(){e=R("Custom")},l(t){e=H(t,"Custom")},m(t,l){v(t,e,l)},d(t){t&&b(e)}}}function Me(o){let e;return{c(){e=R("Reset")},l(t){e=H(t,"Reset")},m(t,l){v(t,e,l)},d(t){t&&b(e)}}}function oe(o){let e,t;return e=new T({props:{$$slots:{default:[Ne]},$$scope:{ctx:o}}}),e.$on("click",o[8]),{c(){M(e.$$.fragment)},l(l){N(e.$$.fragment,l)},m(l,n){G(e,l,n),t=!0},p(l,n){const s={};n&16384&&(s.$$scope={dirty:n,ctx:l}),e.$set(s)},i(l){t||(p(e.$$.fragment,l),t=!0)},o(l){$(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Ne(o){let e;return{c(){e=R("Solve")},l(t){e=H(t,"Solve")},m(t,l){v(t,e,l)},d(t){t&&b(e)}}}function re(o){let e,t;return e=new T({props:{$$slots:{default:[Ge]},$$scope:{ctx:o}}}),e.$on("click",o[10]),{c(){M(e.$$.fragment)},l(l){N(e.$$.fragment,l)},m(l,n){G(e,l,n),t=!0},p(l,n){const s={};n&16384&&(s.$$scope={dirty:n,ctx:l}),e.$set(s)},i(l){t||(p(e.$$.fragment,l),t=!0)},o(l){$(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Ge(o){let e;return{c(){e=R("💡")},l(t){e=H(t,"💡")},m(t,l){v(t,e,l)},d(t){t&&b(e)}}}function We(o){let e,t,l,n,s,i,c,r,u;e=new T({props:{$$slots:{default:[Be]},$$scope:{ctx:o}}}),e.$on("click",o[6]),l=new T({props:{href:me+"/edit",$$slots:{default:[Ce]},$$scope:{ctx:o}}}),s=new T({props:{$$slots:{default:[Me]},$$scope:{ctx:o}}}),s.$on("click",o[7]);let a=o[1]&&o[4].length==0&&oe(o),g=o[4].length>0&&re(o);return{c(){M(e.$$.fragment),t=B(),M(l.$$.fragment),n=B(),M(s.$$.fragment),i=B(),a&&a.c(),c=B(),g&&g.c(),r=q()},l(f){N(e.$$.fragment,f),t=C(f),N(l.$$.fragment,f),n=C(f),N(s.$$.fragment,f),i=C(f),a&&a.l(f),c=C(f),g&&g.l(f),r=q()},m(f,h){G(e,f,h),v(f,t,h),G(l,f,h),v(f,n,h),G(s,f,h),v(f,i,h),a&&a.m(f,h),v(f,c,h),g&&g.m(f,h),v(f,r,h),u=!0},p(f,h){const S={};h&16384&&(S.$$scope={dirty:h,ctx:f}),e.$set(S);const _={};h&16384&&(_.$$scope={dirty:h,ctx:f}),l.$set(_);const d={};h&16384&&(d.$$scope={dirty:h,ctx:f}),s.$set(d),f[1]&&f[4].length==0?a?(a.p(f,h),h&18&&p(a,1)):(a=oe(f),a.c(),p(a,1),a.m(c.parentNode,c)):a&&(O(),$(a,1,1,()=>{a=null}),P()),f[4].length>0?g?(g.p(f,h),h&16&&p(g,1)):(g=re(f),g.c(),p(g,1),g.m(r.parentNode,r)):g&&(O(),$(g,1,1,()=>{g=null}),P())},i(f){u||(p(e.$$.fragment,f),p(l.$$.fragment,f),p(s.$$.fragment,f),p(a),p(g),u=!0)},o(f){$(e.$$.fragment,f),$(l.$$.fragment,f),$(s.$$.fragment,f),$(a),$(g),u=!1},d(f){W(e,f),f&&b(t),W(l,f),f&&b(n),W(s,f),f&&b(i),a&&a.d(f),f&&b(c),g&&g.d(f),f&&b(r)}}}function ue(o){let e,t;return e=new Se({props:{result:o[2].status}}),{c(){M(e.$$.fragment)},l(l){N(e.$$.fragment,l)},m(l,n){G(e,l,n),t=!0},p(l,n){const s={};n&4&&(s.result=l[2].status),e.$set(s)},i(l){t||(p(e.$$.fragment,l),t=!0)},o(l){$(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Re(o){let e,t,l,n,s,i,c;e=new be({props:{$$slots:{default:[We]},$$scope:{ctx:o}}}),n=new Ee({props:{tubes:o[2].tubes,selected:o[0],selectable:o[3],highlight:o[5]}}),n.$on("select",o[9]);let r=o[2].status&&ue(o);return{c(){M(e.$$.fragment),t=B(),l=E("div"),M(n.$$.fragment),s=B(),r&&r.c(),i=q(),this.h()},l(u){N(e.$$.fragment,u),t=C(u),l=I(u,"DIV",{class:!0});var a=D(l);N(n.$$.fragment,a),a.forEach(b),s=C(u),r&&r.l(u),i=q(),this.h()},h(){w(l,"class","cols-2 svelte-m2jv0k")},m(u,a){G(e,u,a),v(u,t,a),v(u,l,a),G(n,l,null),v(u,s,a),r&&r.m(u,a),v(u,i,a),c=!0},p(u,[a]){const g={};a&16402&&(g.$$scope={dirty:a,ctx:u}),e.$set(g);const f={};a&4&&(f.tubes=u[2].tubes),a&1&&(f.selected=u[0]),a&8&&(f.selectable=u[3]),a&32&&(f.highlight=u[5]),n.$set(f),u[2].status?r?(r.p(u,a),a&4&&p(r,1)):(r=ue(u),r.c(),p(r,1),r.m(i.parentNode,i)):r&&(O(),$(r,1,1,()=>{r=null}),P())},i(u){c||(p(e.$$.fragment,u),p(n.$$.fragment,u),p(r),c=!0)},o(u){$(e.$$.fragment,u),$(n.$$.fragment,u),$(r),c=!1},d(u){W(e,u),u&&b(t),u&&b(l),W(n),u&&b(s),r&&r.d(u),u&&b(i)}}}function He(o,e,t){let l;_e(o,Q,m=>t(12,l=m));let n,s=new K(l),i=null,c,r=[],u=[],a=null;ge(async()=>{t(1,n=new Ve),t(1,n.onmessage=function(m){t(4,u=m.data.actions),console.log(u)},n)});function g(){console.debug("generating new game"),Q.set(de()),t(2,s=new K(l)),r=[],t(4,u=[]),t(5,a=null)}function f(){t(2,s=new K(l)),t(0,i=null),r=[],t(4,u=[]),t(5,a=null)}function h(){n.postMessage(s)}function S(m){const k=m.detail;if(i===null)t(0,i=k),console.debug(`selecting ${i}`);else if(i===k)console.debug(`deselecting ${i}`),t(0,i=null);else{if(_(i,k),u.length>0){const y=u[0];k===y.toIndex&&i===y.fromIndex?t(4,u=u.slice(1)):t(4,u=[])}t(0,i=null),t(5,a=null)}}function _(m,k){try{const y=s.historyEntry({from:m,to:k});t(2,s=s.applyMove({from:m,to:k})),console.debug(`applied move ${JSON.stringify(y)}`),r=[...r,y]}catch(y){console.log(y.message)}}function d(){u.length>0&&(t(0,i=u[0].fromIndex),t(5,a=u[0].toIndex))}return o.$$.update=()=>{o.$$.dirty&1&&t(3,c=i?"non-full":"non-empty")},[i,n,s,c,u,a,g,f,h,S,d]}class Te extends J{constructor(e){super(),Y(this,e,He,Re,z,{})}}export{Te as default};
