import{S as j,i as G,s as N,e as B,b as v,g as O,t as h,d as T,f as c,h as d,O as D,k as w,l as y,m as k,n as p,J as S,K as F,C,E as A,F as E,G as M}from"./index-5bc28d6e.js";import{w as U}from"./paths-d538d824.js";function W(i){let e,s,n,l,t=!i[2]&&I(i);return{c(){e=w("button"),t&&t.c(),this.h()},l(o){e=y(o,"BUTTON",{class:!0});var u=k(e);t&&t.l(u),u.forEach(d),this.h()},h(){p(e,"class","button svelte-1rmphn3"),e.disabled=i[1],S(e,"spinning",i[2])},m(o,u){v(o,e,u),t&&t.m(e,null),s=!0,n||(l=F(e,"click",i[5]),n=!0)},p(o,u){o[2]?t&&(O(),h(t,1,1,()=>{t=null}),T()):t?(t.p(o,u),u&4&&c(t,1)):(t=I(o),t.c(),c(t,1),t.m(e,null)),(!s||u&2)&&(e.disabled=o[1]),(!s||u&4)&&S(e,"spinning",o[2])},i(o){s||(c(t),s=!0)},o(o){h(t),s=!1},d(o){o&&d(e),t&&t.d(),n=!1,l()}}}function q(i){let e,s;const n=i[4].default,l=C(n,i,i[3],null);return{c(){e=w("a"),l&&l.c(),this.h()},l(t){e=y(t,"A",{class:!0,href:!0,role:!0});var o=k(e);l&&l.l(o),o.forEach(d),this.h()},h(){p(e,"class","button svelte-1rmphn3"),p(e,"href",i[0]),p(e,"role","button")},m(t,o){v(t,e,o),l&&l.m(e,null),s=!0},p(t,o){l&&l.p&&(!s||o&8)&&A(l,n,t,t[3],s?M(n,t[3],o,null):E(t[3]),null),(!s||o&1)&&p(e,"href",t[0])},i(t){s||(c(l,t),s=!0)},o(t){h(l,t),s=!1},d(t){t&&d(e),l&&l.d(t)}}}function I(i){let e;const s=i[4].default,n=C(s,i,i[3],null);return{c(){n&&n.c()},l(l){n&&n.l(l)},m(l,t){n&&n.m(l,t),e=!0},p(l,t){n&&n.p&&(!e||t&8)&&A(n,s,l,l[3],e?M(s,l[3],t,null):E(l[3]),null)},i(l){e||(c(n,l),e=!0)},o(l){h(n,l),e=!1},d(l){n&&n.d(l)}}}function H(i){let e,s,n,l;const t=[q,W],o=[];function u(a,r){return a[0]?0:1}return e=u(i),s=o[e]=t[e](i),{c(){s.c(),n=B()},l(a){s.l(a),n=B()},m(a,r){o[e].m(a,r),v(a,n,r),l=!0},p(a,[r]){let f=e;e=u(a),e===f?o[e].p(a,r):(O(),h(o[f],1,1,()=>{o[f]=null}),T(),s=o[e],s?s.p(a,r):(s=o[e]=t[e](a),s.c()),c(s,1),s.m(n.parentNode,n))},i(a){l||(c(s),l=!0)},o(a){h(s),l=!1},d(a){o[e].d(a),a&&d(n)}}}function J(i,e,s){let{$$slots:n={},$$scope:l}=e,{href:t=null}=e,{disabled:o=!1}=e,{spin:u=!1}=e;function a(r){D.call(this,i,r)}return i.$$set=r=>{"href"in r&&s(0,t=r.href),"disabled"in r&&s(1,o=r.disabled),"spin"in r&&s(2,u=r.spin),"$$scope"in r&&s(3,l=r.$$scope)},[t,o,u,l,n,a]}class x extends j{constructor(e){super(),G(this,e,J,H,N,{href:0,disabled:1,spin:2})}}function K(i){let e,s;const n=i[1].default,l=C(n,i,i[0],null);return{c(){e=w("div"),l&&l.c(),this.h()},l(t){e=y(t,"DIV",{class:!0});var o=k(e);l&&l.l(o),o.forEach(d),this.h()},h(){p(e,"class","svelte-k0makj")},m(t,o){v(t,e,o),l&&l.m(e,null),s=!0},p(t,[o]){l&&l.p&&(!s||o&1)&&A(l,n,t,t[0],s?M(n,t[0],o,null):E(t[0]),null)},i(t){s||(c(l,t),s=!0)},o(t){h(l,t),s=!1},d(t){t&&d(e),l&&l.d(t)}}}function L(i,e,s){let{$$slots:n={},$$scope:l}=e;return i.$$set=t=>{"$$scope"in t&&s(0,l=t.$$scope)},[l,n]}class ee extends j{constructor(e){super(),G(this,e,L,K,N,{})}}function R(i,e){if(i.empty)throw Error(`source-empty ${i.name}`);if(i.done)throw Error(`source-closed ${i.name}`);if(e.full)throw Error(`target-full ${i.name}`);const s=i.topColor;if(e.length>0&&s!==e.topColor)throw Error("invalid-color");const n=Math.min(i.topAmount,e.emptySpace),l=i.levels.slice(0,-n),t=Array(n).fill(s),o=[...e.levels,...t];return[new m(i.id,l),new m(e.id,o)]}class m{constructor(e,s=[]){this.id=e,this.levels=s}get name(){return String.fromCharCode(65+this.id)}get empty(){return this.levels.length===0}get full(){return this.levels.length>=4}get emptySpace(){return 4-this.levels.length}get done(){return this.levels.length===4&&this.levels[0]===this.levels[1]&&this.levels[1]===this.levels[2]&&this.levels[2]==this.levels[3]}get topColor(){return this.levels.length?this.levels[this.levels.length-1]:null}get topAmount(){if(this.levels.length<=1)return this.levels.length;const e=this.topColor;let s=1;for(;s<this.levels.length;){if(this.levels[this.levels.length-1-s]!=e)return s;s+=1}return this.levels.length}get singleColor(){return this.topAmount===this.levels.length}accepts(e){return this.empty?4:this.full?0:this.topColor===e?this.emptySpace:0}add(e){if(!this.full)return new m(this.id,[...this.levels,e])}}const V=19;function z(i){let e=[];for(let s=0;s<i.length;s++){const n=i[s];if(!n.done&&!n.empty)for(let l=0;l<i.length;l++){const t=i[l];s!==l&&t.accepts(n.topColor)&&e.push({from:n.id,to:t.id})}}return e}function P(i){return i.map(e=>e.done||e.empty).reduce((e,s)=>e&&s,!0)}class _{constructor(e=[]){this.tubes=[];for(const[s,n]of e.entries())n instanceof m?this.tubes.push(n):this.tubes.push(new m(s,n));P(this.tubes)?this.status="win":this.possibleActions().length===0&&(this.status="lose")}possibleActions(){return z(this.tubes)}get won(){return this.status==="win"}get lost(){return this.status==="lose"}get ended(){return this.status!==void 0}get numClosed(){return this.tubes.filter(e=>e.done).length}historyEntry({from:e,to:s}){if(this.tubes[e].topColor!==this.tubes[s].topColor&&!this.tubes[s].empty)throw new Error("invalid-color");const n=this.tubes[e].topColor;return{fromIndex:e,toIndex:s,fromId:this.tubes[e].name,toId:this.tubes[s].name,color:n,amount:Math.min(this.tubes[e].topAmount,this.tubes[s].accepts(n))}}applyMove({from:e,to:s}){const[n,l]=R(this.tubes[e],this.tubes[s]),t=[...this.tubes];return t[e]=n,t[s]=l,new _(t)}add(e,s){const n=[...this.tubes];return n[s]=this.tubes[s].add(e),new _(n)}getHash(){return this.tubes.map(e=>e.levels.concat(e.full?[]:[0])).flat().map(e=>e.toString(36)).join("")}}function g(i){return i[Math.floor(Math.random()*i.length)]}function Q(i){for(let e=i.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[i[e],i[s]]=[i[s],i[e]]}}function X(i){const e=Array(V).fill().map((s,n)=>n+1);return Q(e),e.slice(0,i)}function Y(i){i=i||10+Math.floor(Math.random()*6);const e=X(i-2),s=new Array(i-2).fill().map((t,o)=>new Array(4).fill(e[o])).concat([[],[]]),n=new _(s);for(let t=0;t<70;t++){const o=n.tubes.filter(b=>!b.empty),u=g(o),a=n.tubes.filter(b=>!b.full&&b.id!==u.id),r=g(a);console.debug(`move ${t}: ${u.id} -> ${r.id}`);const f=u.levels.splice(-1);r.levels.push(...f)}let l=n.tubes.filter(t=>t.empty).length;for(let t=0;t<100&&l<2;t++){const o=n.tubes.filter(r=>!r.empty),u=g(o),a=n.tubes.filter(r=>!r.full&&r.levels.length>u.levels.length);if(a.length>0){const r=g(a);console.debug(`move: ${u.id} -> ${r.id}`);const f=u.levels.splice(-1);r.levels.push(...f)}l=n.tubes.filter(r=>r.empty).length}return new _(n.tubes)}const te=U(Y());export{ee as B,_ as G,V as N,m as T,x as a,te as c,Y as r};
