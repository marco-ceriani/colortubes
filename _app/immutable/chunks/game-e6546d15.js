import{S as $,i as S,s as T,e as B,b as v,g as I,t as p,d as M,f as m,h,O as G,C as g,k as w,l as y,m as C,n as d,K as j,E as k,F as E,G as A}from"./index-5bc28d6e.js";import{w as q}from"./paths-d538d824.js";function D(o){let e,t,r,s;const l=o[3].default,n=g(l,o,o[2],null);return{c(){e=w("button"),n&&n.c(),this.h()},l(u){e=y(u,"BUTTON",{class:!0});var i=C(e);n&&n.l(i),i.forEach(h),this.h()},h(){d(e,"class","button svelte-1523qao"),e.disabled=o[1]},m(u,i){v(u,e,i),n&&n.m(e,null),t=!0,r||(s=j(e,"click",o[4]),r=!0)},p(u,i){n&&n.p&&(!t||i&4)&&k(n,l,u,u[2],t?A(l,u[2],i,null):E(u[2]),null),(!t||i&2)&&(e.disabled=u[1])},i(u){t||(m(n,u),t=!0)},o(u){p(n,u),t=!1},d(u){u&&h(e),n&&n.d(u),r=!1,s()}}}function F(o){let e,t;const r=o[3].default,s=g(r,o,o[2],null);return{c(){e=w("a"),s&&s.c(),this.h()},l(l){e=y(l,"A",{class:!0,href:!0,role:!0});var n=C(e);s&&s.l(n),n.forEach(h),this.h()},h(){d(e,"class","button svelte-1523qao"),d(e,"href",o[0]),d(e,"role","button")},m(l,n){v(l,e,n),s&&s.m(e,null),t=!0},p(l,n){s&&s.p&&(!t||n&4)&&k(s,r,l,l[2],t?A(r,l[2],n,null):E(l[2]),null),(!t||n&1)&&d(e,"href",l[0])},i(l){t||(m(s,l),t=!0)},o(l){p(s,l),t=!1},d(l){l&&h(e),s&&s.d(l)}}}function N(o){let e,t,r,s;const l=[F,D],n=[];function u(i,a){return i[0]?0:1}return e=u(o),t=n[e]=l[e](o),{c(){t.c(),r=B()},l(i){t.l(i),r=B()},m(i,a){n[e].m(i,a),v(i,r,a),s=!0},p(i,[a]){let c=e;e=u(i),e===c?n[e].p(i,a):(I(),p(n[c],1,1,()=>{n[c]=null}),M(),t=n[e],t?t.p(i,a):(t=n[e]=l[e](i),t.c()),m(t,1),t.m(r.parentNode,r))},i(i){s||(m(t),s=!0)},o(i){p(t),s=!1},d(i){n[e].d(i),i&&h(r)}}}function O(o,e,t){let{$$slots:r={},$$scope:s}=e,{href:l=null}=e,{disabled:n=!1}=e;function u(i){G.call(this,o,i)}return o.$$set=i=>{"href"in i&&t(0,l=i.href),"disabled"in i&&t(1,n=i.disabled),"$$scope"in i&&t(2,s=i.$$scope)},[l,n,s,r,u]}class L extends ${constructor(e){super(),S(this,e,O,N,T,{href:0,disabled:1})}}function W(o){let e,t;const r=o[1].default,s=g(r,o,o[0],null);return{c(){e=w("div"),s&&s.c(),this.h()},l(l){e=y(l,"DIV",{class:!0});var n=C(e);s&&s.l(n),n.forEach(h),this.h()},h(){d(e,"class","svelte-1boj8r1")},m(l,n){v(l,e,n),s&&s.m(e,null),t=!0},p(l,[n]){s&&s.p&&(!t||n&1)&&k(s,r,l,l[0],t?A(r,l[0],n,null):E(l[0]),null)},i(l){t||(m(s,l),t=!0)},o(l){p(s,l),t=!1},d(l){l&&h(e),s&&s.d(l)}}}function H(o,e,t){let{$$slots:r={},$$scope:s}=e;return o.$$set=l=>{"$$scope"in l&&t(0,s=l.$$scope)},[s,r]}class P extends ${constructor(e){super(),S(this,e,H,W,T,{})}}function K(o,e){if(o.empty)throw Error(`source-empty ${o.name}`);if(o.done)throw Error(`source-closed ${o.name}`);if(e.full)throw Error(`target-full ${o.name}`);const t=o.topColor;if(e.length>0&&t!==e.topColor)throw Error("invalid-color");const r=Math.min(o.topAmount,e.emptySpace),s=o.levels.slice(0,-r),l=Array(r).fill(t),n=[...e.levels,...l];return[new f(o.id,s),new f(e.id,n)]}class f{constructor(e,t=[]){this.id=e,this.levels=t}get name(){return String.fromCharCode(65+this.id)}get empty(){return this.levels.length===0}get full(){return this.levels.length>=4}get emptySpace(){return 4-this.levels.length}get done(){return this.levels.length===4&&this.levels[0]===this.levels[1]&&this.levels[1]===this.levels[2]&&this.levels[2]==this.levels[3]}get topColor(){return this.levels.length?this.levels[this.levels.length-1]:null}get topAmount(){if(this.levels.length<=1)return this.levels.length;const e=this.topColor;let t=1;for(;t<this.levels.length;){if(this.levels[this.levels.length-1-t]!=e)return t;t+=1}return this.levels.length}get singleColor(){return this.topAmount===this.levels.length}accepts(e){return this.empty?4:this.full?0:this.topColor===e?this.emptySpace:0}add(e){if(!this.full)return new f(this.id,[...this.levels,e])}}function U(o){let e=[];for(let t=0;t<o.length;t++){const r=o[t];if(!r.done&&!r.empty)for(let s=0;s<o.length;s++){const l=o[s];t!==s&&l.accepts(r.topColor)&&e.push({from:r.id,to:l.id})}}return e}function V(o){return o.map(e=>e.done||e.empty).reduce((e,t)=>e&&t,!0)}class _{constructor(e=[]){this.tubes=[];for(const[t,r]of e.entries())r instanceof f?this.tubes.push(r):this.tubes.push(new f(t,r));V(this.tubes)?this.status="win":this.possibleActions().length===0&&(this.status="lose")}possibleActions(){return U(this.tubes)}get won(){return this.status==="win"}get lost(){return this.status==="lose"}get ended(){return this.status!==void 0}get numClosed(){return this.tubes.filter(e=>e.done).length}historyEntry({from:e,to:t}){if(this.tubes[e].topColor!==this.tubes[t].topColor&&!this.tubes[t].empty)throw new Error("invalid-color");const r=this.tubes[e].topColor;return{fromIndex:e,toIndex:t,fromId:this.tubes[e].name,toId:this.tubes[t].name,color:r,amount:Math.min(this.tubes[e].topAmount,this.tubes[t].accepts(r))}}applyMove({from:e,to:t}){const[r,s]=K(this.tubes[e],this.tubes[t]),l=[...this.tubes];return l[e]=r,l[t]=s,new _(l)}add(e,t){const r=[...this.tubes];return r[t]=this.tubes[t].add(e),new _(r)}getHash(){return this.tubes.map(e=>e.levels.concat(e.full?[]:[0])).flat().map(e=>e.toString(36)).join("")}}function b(o){return o[Math.floor(Math.random()*o.length)]}function Q(o=10){const e=new Array(o-2).fill().map((s,l)=>new Array(4).fill(l+1)).concat([[],[]]),t=new _(e);for(let s=0;s<70;s++){const l=t.tubes.filter(c=>!c.empty),n=b(l),u=t.tubes.filter(c=>!c.full&&c.id!==n.id),i=b(u);console.log(`move ${s}: ${n.id} -> ${i.id}`);const a=n.levels.splice(-1);i.levels.push(...a)}let r=t.tubes.filter(s=>s.empty).length;for(let s=0;s<100&&r<2;s++){const l=t.tubes.filter(i=>!i.empty),n=b(l),u=t.tubes.filter(i=>!i.full&&i.levels.length>n.levels.length);if(u.length>0){const i=b(u);console.log(`move: ${n.id} -> ${i.id}`);const a=n.levels.splice(-1);i.levels.push(...a)}r=t.tubes.filter(i=>i.empty).length}return t.status=void 0,e}const R=q([[9,8,5,2],[1,3,3,3],[6,5,8,5],[7,6,2,9],[9,6,8,7],[7,6,4,3],[2,1,8,5],[1,4,9,4],[1,7,2,4],[],[]].map((o,e)=>new f(e,o)));export{P as B,_ as G,f as T,L as a,R as c,Q as r};
