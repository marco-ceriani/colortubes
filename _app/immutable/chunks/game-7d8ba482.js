import{S,i as $,s as I,e as B,b as g,g as j,t as p,d as G,f as m,h,O as N,C as w,k as y,l as C,m as k,n as d,K as O,E as A,F as E,G as M}from"./index-5bc28d6e.js";import{w as T}from"./paths-d538d824.js";function q(l){let e,t,o,n;const s=l[3].default,i=w(s,l,l[2],null);return{c(){e=y("button"),i&&i.c(),this.h()},l(u){e=C(u,"BUTTON",{class:!0});var r=k(e);i&&i.l(r),r.forEach(h),this.h()},h(){d(e,"class","button svelte-1523qao"),e.disabled=l[1]},m(u,r){g(u,e,r),i&&i.m(e,null),t=!0,o||(n=O(e,"click",l[4]),o=!0)},p(u,r){i&&i.p&&(!t||r&4)&&A(i,s,u,u[2],t?M(s,u[2],r,null):E(u[2]),null),(!t||r&2)&&(e.disabled=u[1])},i(u){t||(m(i,u),t=!0)},o(u){p(i,u),t=!1},d(u){u&&h(e),i&&i.d(u),o=!1,n()}}}function D(l){let e,t;const o=l[3].default,n=w(o,l,l[2],null);return{c(){e=y("a"),n&&n.c(),this.h()},l(s){e=C(s,"A",{class:!0,href:!0,role:!0});var i=k(e);n&&n.l(i),i.forEach(h),this.h()},h(){d(e,"class","button svelte-1523qao"),d(e,"href",l[0]),d(e,"role","button")},m(s,i){g(s,e,i),n&&n.m(e,null),t=!0},p(s,i){n&&n.p&&(!t||i&4)&&A(n,o,s,s[2],t?M(o,s[2],i,null):E(s[2]),null),(!t||i&1)&&d(e,"href",s[0])},i(s){t||(m(n,s),t=!0)},o(s){p(n,s),t=!1},d(s){s&&h(e),n&&n.d(s)}}}function F(l){let e,t,o,n;const s=[D,q],i=[];function u(r,a){return r[0]?0:1}return e=u(l),t=i[e]=s[e](l),{c(){t.c(),o=B()},l(r){t.l(r),o=B()},m(r,a){i[e].m(r,a),g(r,o,a),n=!0},p(r,[a]){let c=e;e=u(r),e===c?i[e].p(r,a):(j(),p(i[c],1,1,()=>{i[c]=null}),G(),t=i[e],t?t.p(r,a):(t=i[e]=s[e](r),t.c()),m(t,1),t.m(o.parentNode,o))},i(r){n||(m(t),n=!0)},o(r){p(t),n=!1},d(r){i[e].d(r),r&&h(o)}}}function U(l,e,t){let{$$slots:o={},$$scope:n}=e,{href:s=null}=e,{disabled:i=!1}=e;function u(r){N.call(this,l,r)}return l.$$set=r=>{"href"in r&&t(0,s=r.href),"disabled"in r&&t(1,i=r.disabled),"$$scope"in r&&t(2,n=r.$$scope)},[s,i,n,o,u]}class X extends S{constructor(e){super(),$(this,e,U,F,I,{href:0,disabled:1})}}function W(l){let e,t;const o=l[1].default,n=w(o,l,l[0],null);return{c(){e=y("div"),n&&n.c(),this.h()},l(s){e=C(s,"DIV",{class:!0});var i=k(e);n&&n.l(i),i.forEach(h),this.h()},h(){d(e,"class","svelte-k0makj")},m(s,i){g(s,e,i),n&&n.m(e,null),t=!0},p(s,[i]){n&&n.p&&(!t||i&1)&&A(n,o,s,s[0],t?M(o,s[0],i,null):E(s[0]),null)},i(s){t||(m(n,s),t=!0)},o(s){p(n,s),t=!1},d(s){s&&h(e),n&&n.d(s)}}}function H(l,e,t){let{$$slots:o={},$$scope:n}=e;return l.$$set=s=>{"$$scope"in s&&t(0,n=s.$$scope)},[n,o]}class Y extends S{constructor(e){super(),$(this,e,H,W,I,{})}}function K(l,e){if(l.empty)throw Error(`source-empty ${l.name}`);if(l.done)throw Error(`source-closed ${l.name}`);if(e.full)throw Error(`target-full ${l.name}`);const t=l.topColor;if(e.length>0&&t!==e.topColor)throw Error("invalid-color");const o=Math.min(l.topAmount,e.emptySpace),n=l.levels.slice(0,-o),s=Array(o).fill(t),i=[...e.levels,...s];return[new f(l.id,n),new f(e.id,i)]}class f{constructor(e,t=[]){this.id=e,this.levels=t}get name(){return String.fromCharCode(65+this.id)}get empty(){return this.levels.length===0}get full(){return this.levels.length>=4}get emptySpace(){return 4-this.levels.length}get done(){return this.levels.length===4&&this.levels[0]===this.levels[1]&&this.levels[1]===this.levels[2]&&this.levels[2]==this.levels[3]}get topColor(){return this.levels.length?this.levels[this.levels.length-1]:null}get topAmount(){if(this.levels.length<=1)return this.levels.length;const e=this.topColor;let t=1;for(;t<this.levels.length;){if(this.levels[this.levels.length-1-t]!=e)return t;t+=1}return this.levels.length}get singleColor(){return this.topAmount===this.levels.length}accepts(e){return this.empty?4:this.full?0:this.topColor===e?this.emptySpace:0}add(e){if(!this.full)return new f(this.id,[...this.levels,e])}}const L=18;function R(l){let e=[];for(let t=0;t<l.length;t++){const o=l[t];if(!o.done&&!o.empty)for(let n=0;n<l.length;n++){const s=l[n];t!==n&&s.accepts(o.topColor)&&e.push({from:o.id,to:s.id})}}return e}function V(l){return l.map(e=>e.done||e.empty).reduce((e,t)=>e&&t,!0)}class v{constructor(e=[]){this.tubes=[];for(const[t,o]of e.entries())o instanceof f?this.tubes.push(o):this.tubes.push(new f(t,o));V(this.tubes)?this.status="win":this.possibleActions().length===0&&(this.status="lose")}possibleActions(){return R(this.tubes)}get won(){return this.status==="win"}get lost(){return this.status==="lose"}get ended(){return this.status!==void 0}get numClosed(){return this.tubes.filter(e=>e.done).length}historyEntry({from:e,to:t}){if(this.tubes[e].topColor!==this.tubes[t].topColor&&!this.tubes[t].empty)throw new Error("invalid-color");const o=this.tubes[e].topColor;return{fromIndex:e,toIndex:t,fromId:this.tubes[e].name,toId:this.tubes[t].name,color:o,amount:Math.min(this.tubes[e].topAmount,this.tubes[t].accepts(o))}}applyMove({from:e,to:t}){const[o,n]=K(this.tubes[e],this.tubes[t]),s=[...this.tubes];return s[e]=o,s[t]=n,new v(s)}add(e,t){const o=[...this.tubes];return o[t]=this.tubes[t].add(e),new v(o)}getHash(){return this.tubes.map(e=>e.levels.concat(e.full?[]:[0])).flat().map(e=>e.toString(36)).join("")}}function b(l){return l[Math.floor(Math.random()*l.length)]}function z(l){for(let e=l.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[l[e],l[t]]=[l[t],l[e]]}}function J(l){const e=Array(L).fill().map((t,o)=>o+1);return z(e),e.slice(0,l)}function Z(l){l=l||8+Math.floor(Math.random()*5);const e=J(l-2),t=new Array(l-2).fill().map((s,i)=>new Array(4).fill(e[i])).concat([[],[]]),o=new v(t);for(let s=0;s<70;s++){const i=o.tubes.filter(_=>!_.empty),u=b(i),r=o.tubes.filter(_=>!_.full&&_.id!==u.id),a=b(r);console.log(`move ${s}: ${u.id} -> ${a.id}`);const c=u.levels.splice(-1);a.levels.push(...c)}let n=o.tubes.filter(s=>s.empty).length;for(let s=0;s<100&&n<2;s++){const i=o.tubes.filter(a=>!a.empty),u=b(i),r=o.tubes.filter(a=>!a.full&&a.levels.length>u.levels.length);if(r.length>0){const a=b(r);console.log(`move: ${u.id} -> ${a.id}`);const c=u.levels.splice(-1);a.levels.push(...c)}n=o.tubes.filter(a=>a.empty).length}return o.status=void 0,t}const x=T([[9,8,5,2],[1,3,3,3],[6,5,8,5],[7,6,2,9],[9,6,8,7],[7,6,4,3],[2,1,8,5],[1,4,9,4],[1,7,2,4],[],[]].map((l,e)=>new f(e,l)));export{Y as B,v as G,L as N,f as T,X as a,x as c,Z as r};
