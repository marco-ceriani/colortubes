var Xt=Object.defineProperty;var Zt=(t,e,n)=>e in t?Xt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var re=(t,e,n)=>(Zt(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}})();function S(){}const se=t=>t;function Te(t,e){for(const n in e)t[n]=e[n];return t}function xt(t){return!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function Mt(t){return t()}function xe(){return Object.create(null)}function X(t){t.forEach(Mt)}function ue(t){return typeof t=="function"}function U(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function en(t){return Object.keys(t).length===0}function Ot(t,...e){if(t==null){for(const s of e)s(void 0);return S}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function oe(t,e,n){t.$$.on_destroy.push(Ot(e,n))}function me(t,e,n,s){if(t){const l=Nt(t,e,n,s);return t[0](l)}}function Nt(t,e,n,s){return t[1]&&s?Te(n.ctx.slice(),t[1](s(e))):n.ctx}function ge(t,e,n,s){if(t[2]&&s){const l=t[2](s(n));if(e.dirty===void 0)return l;if(typeof l=="object"){const r=[],i=Math.max(e.dirty.length,l.length);for(let o=0;o<i;o+=1)r[o]=e.dirty[o]|l[o];return r}return e.dirty|l}return e.dirty}function be(t,e,n,s,l,r){if(l){const i=Nt(e,n,s,r);t.p(i,l)}}function $e(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let s=0;s<n;s++)e[s]=-1;return e}return-1}function et(t){const e={};for(const n in t)n[0]!=="$"&&(e[n]=t[n]);return e}function tn(t){return t&&ue(t.destroy)?t.destroy:S}function tt(t){const e=typeof t=="string"&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}const Rt=typeof window<"u";let Ye=Rt?()=>window.performance.now():()=>Date.now(),Ge=Rt?t=>requestAnimationFrame(t):S;const he=new Set;function Lt(t){he.forEach(e=>{e.c(t)||(he.delete(e),e.f())}),he.size!==0&&Ge(Lt)}function Ke(t){let e;return he.size===0&&Ge(Lt),{promise:new Promise(n=>{he.add(e={c:t,f:n})}),abort(){he.delete(e)}}}function j(t,e){t.appendChild(e)}function Dt(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function nn(t){const e=P("style");return e.textContent="/* empty */",sn(Dt(t),e),e.sheet}function sn(t,e){return j(t.head||t,e),e.sheet}function v(t,e,n){t.insertBefore(e,n||null)}function w(t){t.parentNode&&t.parentNode.removeChild(t)}function Ve(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function P(t){return document.createElement(t)}function q(t){return document.createTextNode(t)}function L(){return q(" ")}function V(){return q("")}function K(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function I(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function ln(t){return Array.from(t.childNodes)}function Je(t,e){e=""+e,t.data!==e&&(t.data=e)}function ve(t,e,n,s){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}function W(t,e,n){t.classList.toggle(e,!!n)}function jt(t,e,{bubbles:n=!1,cancelable:s=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:s})}function nt(t,e){return new t(e)}const Ae=new Map;let Pe=0;function rn(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function on(t,e){const n={stylesheet:nn(e),rules:{}};return Ae.set(t,n),n}function Me(t,e,n,s,l,r,i,o=0){const u=16.666/s;let c=`{
`;for(let $=0;$<=1;$+=u){const h=e+(n-e)*r($);c+=$*100+`%{${i(h,1-h)}}
`}const f=c+`100% {${i(n,1-n)}}
}`,a=`__svelte_${rn(f)}_${o}`,d=Dt(t),{stylesheet:_,rules:p}=Ae.get(d)||on(d,t);p[a]||(p[a]=!0,_.insertRule(`@keyframes ${a} ${f}`,_.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?`${m}, `:""}${a} ${s}ms linear ${l}ms 1 both`,Pe+=1,a}function Oe(t,e){const n=(t.style.animation||"").split(", "),s=n.filter(e?r=>r.indexOf(e)<0:r=>r.indexOf("__svelte")===-1),l=n.length-s.length;l&&(t.style.animation=s.join(", "),Pe-=l,Pe||un())}function un(){Ge(()=>{Pe||(Ae.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&w(e)}),Ae.clear())})}let Ce;function x(t){Ce=t}function ke(){if(!Ce)throw new Error("Function called outside component initialization");return Ce}function Wt(t){ke().$$.on_mount.push(t)}function cn(t){ke().$$.on_destroy.push(t)}function Bt(){const t=ke();return(e,n,{cancelable:s=!1}={})=>{const l=t.$$.callbacks[e];if(l){const r=jt(e,n,{cancelable:s});return l.slice().forEach(i=>{i.call(t,r)}),!r.defaultPrevented}return!0}}function De(t,e){return ke().$$.context.set(t,e),e}function Fe(t){return ke().$$.context.get(t)}function Se(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(s=>s.call(this,e))}const ae=[],st=[];let _e=[];const lt=[],fn=Promise.resolve();let Ue=!1;function an(){Ue||(Ue=!0,fn.then(Qe))}function Q(t){_e.push(t)}const je=new Set;let ce=0;function Qe(){if(ce!==0)return;const t=Ce;do{try{for(;ce<ae.length;){const e=ae[ce];ce++,x(e),dn(e.$$)}}catch(e){throw ae.length=0,ce=0,e}for(x(null),ae.length=0,ce=0;st.length;)st.pop()();for(let e=0;e<_e.length;e+=1){const n=_e[e];je.has(n)||(je.add(n),n())}_e.length=0}while(ae.length);for(;lt.length;)lt.pop()();Ue=!1,je.clear(),x(t)}function dn(t){if(t.fragment!==null){t.update(),X(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Q)}}function hn(t){const e=[],n=[];_e.forEach(s=>t.indexOf(s)===-1?e.push(s):n.push(s)),n.forEach(s=>s()),_e=e}let ye;function Xe(){return ye||(ye=Promise.resolve(),ye.then(()=>{ye=null})),ye}function ie(t,e,n){t.dispatchEvent(jt(`${e?"intro":"outro"}${n}`))}const Ie=new Set;let J;function z(){J={r:0,c:[],p:J}}function F(){J.r||X(J.c),J=J.p}function b(t,e){t&&t.i&&(Ie.delete(t),t.i(e))}function k(t,e,n,s){if(t&&t.o){if(Ie.has(t))return;Ie.add(t),J.c.push(()=>{Ie.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}else s&&s()}const Ze={duration:0};function _n(t,e,n){const s={direction:"in"};let l=e(t,n,s),r=!1,i,o,u=0;function c(){i&&Oe(t,i)}function f(){const{delay:d=0,duration:_=300,easing:p=se,tick:m=S,css:$}=l||Ze;$&&(i=Me(t,0,1,_,d,p,$,u++)),m(0,1);const h=Ye()+d,y=h+_;o&&o.abort(),r=!0,Q(()=>ie(t,!0,"start")),o=Ke(C=>{if(r){if(C>=y)return m(1,0),ie(t,!0,"end"),c(),r=!1;if(C>=h){const T=p((C-h)/_);m(T,1-T)}}return r})}let a=!1;return{start(){a||(a=!0,Oe(t),ue(l)?(l=l(s),Xe().then(f)):f())},invalidate(){a=!1},end(){r&&(c(),r=!1)}}}function pn(t,e,n){const s={direction:"out"};let l=e(t,n,s),r=!0,i;const o=J;o.r+=1;let u;function c(){const{delay:f=0,duration:a=300,easing:d=se,tick:_=S,css:p}=l||Ze;p&&(i=Me(t,1,0,a,f,d,p));const m=Ye()+f,$=m+a;Q(()=>ie(t,!1,"start")),"inert"in t&&(u=t.inert,t.inert=!0),Ke(h=>{if(r){if(h>=$)return _(0,1),ie(t,!1,"end"),--o.r||X(o.c),!1;if(h>=m){const y=d((h-m)/a);_(1-y,y)}}return r})}return ue(l)?Xe().then(()=>{l=l(s),c()}):c(),{end(f){f&&"inert"in t&&(t.inert=u),f&&l.tick&&l.tick(1,0),r&&(i&&Oe(t,i),r=!1)}}}function pe(t,e,n,s){let r=e(t,n,{direction:"both"}),i=s?0:1,o=null,u=null,c=null,f;function a(){c&&Oe(t,c)}function d(p,m){const $=p.b-i;return m*=Math.abs($),{a:i,b:p.b,d:$,duration:m,start:p.start,end:p.start+m,group:p.group}}function _(p){const{delay:m=0,duration:$=300,easing:h=se,tick:y=S,css:C}=r||Ze,T={start:Ye()+m,b:p};p||(T.group=J,J.r+=1),"inert"in t&&(p?f!==void 0&&(t.inert=f):(f=t.inert,t.inert=!0)),o||u?u=T:(C&&(a(),c=Me(t,i,p,$,m,h,C)),p&&y(0,1),o=d(T,$),Q(()=>ie(t,p,"start")),Ke(D=>{if(u&&D>u.start&&(o=d(u,$),u=null,ie(t,o.b,"start"),C&&(a(),c=Me(t,i,o.b,o.duration,0,h,r.css))),o){if(D>=o.end)y(i=o.b,1-i),ie(t,o.b,"end"),u||(o.b?a():--o.group.r||X(o.group.c)),o=null;else if(D>=o.start){const Z=D-o.start;i=o.a+o.d*h(Z/o.duration),y(i,1-i)}}return!!(o||u)}))}return{run(p){ue(r)?Xe().then(()=>{r=r({direction:p?"in":"out"}),_(p)}):_(p)},end(){a(),o=u=null}}}function rt(t,e){const n=e.token={};function s(l,r,i,o){if(e.token!==n)return;e.resolved=o;let u=e.ctx;i!==void 0&&(u=u.slice(),u[i]=o);const c=l&&(e.current=l)(u);let f=!1;e.block&&(e.blocks?e.blocks.forEach((a,d)=>{d!==r&&a&&(z(),k(a,1,1,()=>{e.blocks[d]===a&&(e.blocks[d]=null)}),F())}):e.block.d(1),c.c(),b(c,1),c.m(e.mount(),e.anchor),f=!0),e.block=c,e.blocks&&(e.blocks[r]=c),f&&Qe()}if(xt(t)){const l=ke();if(t.then(r=>{x(l),s(e.then,1,e.value,r),x(null)},r=>{if(x(l),s(e.catch,2,e.error,r),x(null),!e.hasCatch)throw r}),e.current!==e.pending)return s(e.pending,0),!0}else{if(e.current!==e.then)return s(e.then,1,e.value,t),!0;e.resolved=t}}function mn(t,e,n){const s=e.slice(),{resolved:l}=t;t.current===t.then&&(s[t.value]=l),t.current===t.catch&&(s[t.error]=l),t.block.p(s,n)}function le(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function gn(t,e){k(t,1,1,()=>{e.delete(t.key)})}function bn(t,e,n,s,l,r,i,o,u,c,f,a){let d=t.length,_=r.length,p=d;const m={};for(;p--;)m[t[p].key]=p;const $=[],h=new Map,y=new Map,C=[];for(p=_;p--;){const R=a(l,r,p),E=n(R);let g=i.get(E);g?s&&C.push(()=>g.p(R,e)):(g=c(E,R),g.c()),h.set(E,$[p]=g),E in m&&y.set(E,Math.abs(p-m[E]))}const T=new Set,D=new Set;function Z(R){b(R,1),R.m(o,f),i.set(R.key,R),f=R.first,_--}for(;d&&_;){const R=$[_-1],E=t[d-1],g=R.key,A=E.key;R===E?(f=R.first,d--,_--):h.has(A)?!i.has(g)||T.has(g)?Z(R):D.has(A)?d--:y.get(g)>y.get(A)?(D.add(g),Z(R)):(T.add(A),d--):(u(E,i),d--)}for(;d--;){const R=t[d];h.has(R.key)||u(R,i)}for(;_;)Z($[_-1]);return X(C),$}function ot(t,e){const n={},s={},l={$$scope:1};let r=t.length;for(;r--;){const i=t[r],o=e[r];if(o){for(const u in i)u in o||(s[u]=1);for(const u in o)l[u]||(n[u]=o[u],l[u]=1);t[r]=o}else for(const u in i)l[u]=1}for(const i in s)i in n||(n[i]=void 0);return n}function Ee(t){return typeof t=="object"&&t!==null?t:{}}function N(t){t&&t.c()}function M(t,e,n){const{fragment:s,after_update:l}=t.$$;s&&s.m(e,n),Q(()=>{const r=t.$$.on_mount.map(Mt).filter(ue);t.$$.on_destroy?t.$$.on_destroy.push(...r):X(r),t.$$.on_mount=[]}),l.forEach(Q)}function O(t,e){const n=t.$$;n.fragment!==null&&(hn(n.after_update),X(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function $n(t,e){t.$$.dirty[0]===-1&&(ae.push(t),an(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function H(t,e,n,s,l,r,i=null,o=[-1]){const u=Ce;x(t);const c=t.$$={fragment:null,ctx:[],props:r,update:S,not_equal:l,bound:xe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:xe(),dirty:o,skip_bound:!1,root:e.target||u.$$.root};i&&i(c.root);let f=!1;if(c.ctx=n?n(t,e.props||{},(a,d,..._)=>{const p=_.length?_[0]:d;return c.ctx&&l(c.ctx[a],c.ctx[a]=p)&&(!c.skip_bound&&c.bound[a]&&c.bound[a](p),f&&$n(t,a)),d}):[],c.update(),f=!0,X(c.before_update),c.fragment=s?s(c.ctx):!1,e.target){if(e.hydrate){const a=ln(e.target);c.fragment&&c.fragment.l(a),a.forEach(w)}else c.fragment&&c.fragment.c();e.intro&&b(t.$$.fragment),M(t,e.target,e.anchor),Qe()}x(u)}class Y{constructor(){re(this,"$$");re(this,"$$set")}$destroy(){O(this,1),this.$destroy=S}$on(e,n){if(!ue(n))return S;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const l=s.indexOf(n);l!==-1&&s.splice(l,1)}}$set(e){this.$$set&&!en(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const kn="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(kn);const it={},qe={},yn={},zt=/^:(.+)/,ut=4,wn=3,vn=2,Cn=1,En=1,He=t=>t.replace(/(^\/+|\/+$)/g,"").split("/"),We=t=>t.replace(/(^\/+|\/+$)/g,""),Sn=(t,e)=>{const n=t.default?0:He(t.path).reduce((s,l)=>(s+=ut,l===""?s+=En:zt.test(l)?s+=vn:l[0]==="*"?s-=ut+Cn:s+=wn,s),0);return{route:t,score:n,index:e}},In=t=>t.map(Sn).sort((e,n)=>e.score<n.score?1:e.score>n.score?-1:e.index-n.index),ct=(t,e)=>{let n,s;const[l]=e.split("?"),r=He(l),i=r[0]==="",o=In(t);for(let u=0,c=o.length;u<c;u++){const f=o[u].route;let a=!1;if(f.default){s={route:f,params:{},uri:e};continue}const d=He(f.path),_={},p=Math.max(r.length,d.length);let m=0;for(;m<p;m++){const $=d[m],h=r[m];if($&&$[0]==="*"){const C=$==="*"?"*":$.slice(1);_[C]=r.slice(m).map(decodeURIComponent).join("/");break}if(typeof h>"u"){a=!0;break}const y=zt.exec($);if(y&&!i){const C=decodeURIComponent(h);_[y[1]]=C}else if($!==h){a=!0;break}}if(!a){n={route:f,params:_,uri:"/"+r.slice(0,m).join("/")};break}}return n||s||null},ft=(t,e)=>`${We(e==="/"?t:`${We(t)}/${We(e)}`)}/`,Tn=t=>!t.defaultPrevented&&t.button===0&&!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey),An=t=>{const e=location.host;return t.host===e||t.href.indexOf(`https://${e}`)===0||t.href.indexOf(`http://${e}`)===0},Ft=()=>typeof window<"u"&&"document"in window&&"location"in window,Pn=t=>({params:t&4}),at=t=>({params:t[2]});function dt(t){let e,n,s,l;const r=[On,Mn],i=[];function o(u,c){return u[0]?0:1}return e=o(t),n=i[e]=r[e](t),{c(){n.c(),s=V()},m(u,c){i[e].m(u,c),v(u,s,c),l=!0},p(u,c){let f=e;e=o(u),e===f?i[e].p(u,c):(z(),k(i[f],1,1,()=>{i[f]=null}),F(),n=i[e],n?n.p(u,c):(n=i[e]=r[e](u),n.c()),b(n,1),n.m(s.parentNode,s))},i(u){l||(b(n),l=!0)},o(u){k(n),l=!1},d(u){u&&w(s),i[e].d(u)}}}function Mn(t){let e;const n=t[8].default,s=me(n,t,t[7],at);return{c(){s&&s.c()},m(l,r){s&&s.m(l,r),e=!0},p(l,r){s&&s.p&&(!e||r&132)&&be(s,n,l,l[7],e?ge(n,l[7],r,Pn):$e(l[7]),at)},i(l){e||(b(s,l),e=!0)},o(l){k(s,l),e=!1},d(l){s&&s.d(l)}}}function On(t){let e,n,s,l={ctx:t,current:null,token:null,hasCatch:!1,pending:Ln,then:Rn,catch:Nn,value:12,blocks:[,,,]};return rt(n=t[0],l),{c(){e=V(),l.block.c()},m(r,i){v(r,e,i),l.block.m(r,l.anchor=i),l.mount=()=>e.parentNode,l.anchor=e,s=!0},p(r,i){t=r,l.ctx=t,i&1&&n!==(n=t[0])&&rt(n,l)||mn(l,t,i)},i(r){s||(b(l.block),s=!0)},o(r){for(let i=0;i<3;i+=1){const o=l.blocks[i];k(o)}s=!1},d(r){r&&w(e),l.block.d(r),l.token=null,l=null}}}function Nn(t){return{c:S,m:S,p:S,i:S,o:S,d:S}}function Rn(t){var o;let e,n,s;const l=[t[2],t[3]];var r=((o=t[12])==null?void 0:o.default)||t[12];function i(u,c){let f={};if(c!==void 0&&c&12)f=ot(l,[c&4&&Ee(u[2]),c&8&&Ee(u[3])]);else for(let a=0;a<l.length;a+=1)f=Te(f,l[a]);return{props:f}}return r&&(e=nt(r,i(t))),{c(){e&&N(e.$$.fragment),n=V()},m(u,c){e&&M(e,u,c),v(u,n,c),s=!0},p(u,c){var f;if(c&1&&r!==(r=((f=u[12])==null?void 0:f.default)||u[12])){if(e){z();const a=e;k(a.$$.fragment,1,0,()=>{O(a,1)}),F()}r?(e=nt(r,i(u,c)),N(e.$$.fragment),b(e.$$.fragment,1),M(e,n.parentNode,n)):e=null}else if(r){const a=c&12?ot(l,[c&4&&Ee(u[2]),c&8&&Ee(u[3])]):{};e.$set(a)}},i(u){s||(e&&b(e.$$.fragment,u),s=!0)},o(u){e&&k(e.$$.fragment,u),s=!1},d(u){u&&w(n),e&&O(e,u)}}}function Ln(t){return{c:S,m:S,p:S,i:S,o:S,d:S}}function Dn(t){let e,n,s=t[1]&&t[1].route===t[5]&&dt(t);return{c(){s&&s.c(),e=V()},m(l,r){s&&s.m(l,r),v(l,e,r),n=!0},p(l,[r]){l[1]&&l[1].route===l[5]?s?(s.p(l,r),r&2&&b(s,1)):(s=dt(l),s.c(),b(s,1),s.m(e.parentNode,e)):s&&(z(),k(s,1,1,()=>{s=null}),F())},i(l){n||(b(s),n=!0)},o(l){k(s),n=!1},d(l){l&&w(e),s&&s.d(l)}}}function jn(t,e,n){let s,{$$slots:l={},$$scope:r}=e,{path:i=""}=e,{component:o=null}=e,u={},c={};const{registerRoute:f,unregisterRoute:a,activeRoute:d}=Fe(qe);oe(t,d,p=>n(1,s=p));const _={path:i,default:i===""};return f(_),cn(()=>{a(_)}),t.$$set=p=>{n(11,e=Te(Te({},e),et(p))),"path"in p&&n(6,i=p.path),"component"in p&&n(0,o=p.component),"$$scope"in p&&n(7,r=p.$$scope)},t.$$.update=()=>{if(s&&s.route===_){n(2,u=s.params);const{component:p,path:m,...$}=e;n(3,c=$),p&&(p.toString().startsWith("class ")?n(0,o=p):n(0,o=p())),Ft()&&!s.preserveScroll&&(window==null||window.scrollTo(0,0))}},e=et(e),[o,s,u,c,d,_,i,r,l]}class ht extends Y{constructor(e){super(),H(this,e,jn,Dn,U,{path:6,component:0})}}const fe=[];function Wn(t,e){return{subscribe:de(t,e).subscribe}}function de(t,e=S){let n;const s=new Set;function l(o){if(U(t,o)&&(t=o,n)){const u=!fe.length;for(const c of s)c[1](),fe.push(c,t);if(u){for(let c=0;c<fe.length;c+=2)fe[c][0](fe[c+1]);fe.length=0}}}function r(o){l(o(t))}function i(o,u=S){const c=[o,u];return s.add(c),s.size===1&&(n=e(l,r)||S),o(t),()=>{s.delete(c),s.size===0&&n&&(n(),n=null)}}return{set:l,update:r,subscribe:i}}function Bn(t,e,n){const s=!Array.isArray(t),l=s?[t]:t;if(!l.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const r=e.length<2;return Wn(n,(i,o)=>{let u=!1;const c=[];let f=0,a=S;const d=()=>{if(f)return;a();const p=e(s?c[0]:c,i,o);r?i(p):a=ue(p)?p:S},_=l.map((p,m)=>Ot(p,$=>{c[m]=$,f&=~(1<<m),u&&d()},()=>{f|=1<<m}));return u=!0,d(),function(){X(_),a(),u=!1}})}const Be=t=>({...t.location,state:t.history.state,key:t.history.state&&t.history.state.key||"initial"}),zn=t=>{const e=[];let n=Be(t);return{get location(){return n},listen(s){e.push(s);const l=()=>{n=Be(t),s({location:n,action:"POP"})};return t.addEventListener("popstate",l),()=>{t.removeEventListener("popstate",l);const r=e.indexOf(s);e.splice(r,1)}},navigate(s,{state:l,replace:r=!1,preserveScroll:i=!1,blurActiveElement:o=!0}={}){l={...l,key:Date.now()+""};try{r?t.history.replaceState(l,"",s):t.history.pushState(l,"",s)}catch{t.location[r?"replace":"assign"](s)}n=Be(t),e.forEach(u=>u({location:n,action:"PUSH",preserveScroll:i})),o&&document.activeElement.blur()}}},Fn=(t="/")=>{let e=0;const n=[{pathname:t,search:""}],s=[];return{get location(){return n[e]},addEventListener(l,r){},removeEventListener(l,r){},history:{get entries(){return n},get index(){return e},get state(){return s[e]},pushState(l,r,i){const[o,u=""]=i.split("?");e++,n.push({pathname:o,search:u}),s.push(l)},replaceState(l,r,i){const[o,u=""]=i.split("?");n[e]={pathname:o,search:u},s[e]=l}}}},Ut=zn(Ft()?window:Fn()),{navigate:qt}=Ut,Un=t=>({route:t&4,location:t&2}),_t=t=>({route:t[2]&&t[2].uri,location:t[1]}),qn=t=>({route:t&4,location:t&2}),pt=t=>({route:t[2]&&t[2].uri,location:t[1]});function Hn(t){let e;const n=t[15].default,s=me(n,t,t[14],_t);return{c(){s&&s.c()},m(l,r){s&&s.m(l,r),e=!0},p(l,r){s&&s.p&&(!e||r&16390)&&be(s,n,l,l[14],e?ge(n,l[14],r,Un):$e(l[14]),_t)},i(l){e||(b(s,l),e=!0)},o(l){k(s,l),e=!1},d(l){s&&s.d(l)}}}function Yn(t){let e=t[1].pathname,n,s,l=mt(t);return{c(){l.c(),n=V()},m(r,i){l.m(r,i),v(r,n,i),s=!0},p(r,i){i&2&&U(e,e=r[1].pathname)?(z(),k(l,1,1,S),F(),l=mt(r),l.c(),b(l,1),l.m(n.parentNode,n)):l.p(r,i)},i(r){s||(b(l),s=!0)},o(r){k(l),s=!1},d(r){r&&w(n),l.d(r)}}}function mt(t){let e,n,s,l;const r=t[15].default,i=me(r,t,t[14],pt);return{c(){e=P("div"),i&&i.c()},m(o,u){v(o,e,u),i&&i.m(e,null),l=!0},p(o,u){i&&i.p&&(!l||u&16390)&&be(i,r,o,o[14],l?ge(r,o[14],u,qn):$e(o[14]),pt)},i(o){l||(b(i,o),o&&Q(()=>{l&&(s&&s.end(1),n=_n(e,t[3],{}),n.start())}),l=!0)},o(o){k(i,o),n&&n.invalidate(),o&&(s=pn(e,t[3],{})),l=!1},d(o){o&&w(e),i&&i.d(o),o&&s&&s.end()}}}function Gn(t){let e,n,s,l;const r=[Yn,Hn],i=[];function o(u,c){return u[0]?0:1}return e=o(t),n=i[e]=r[e](t),{c(){n.c(),s=V()},m(u,c){i[e].m(u,c),v(u,s,c),l=!0},p(u,[c]){let f=e;e=o(u),e===f?i[e].p(u,c):(z(),k(i[f],1,1,()=>{i[f]=null}),F(),n=i[e],n?n.p(u,c):(n=i[e]=r[e](u),n.c()),b(n,1),n.m(s.parentNode,s))},i(u){l||(b(n),l=!0)},o(u){k(n),l=!1},d(u){u&&w(s),i[e].d(u)}}}function Kn(t,e,n){let s,l,r,i,{$$slots:o={},$$scope:u}=e,{basepath:c="/"}=e,{url:f=null}=e,{viewtransition:a=null}=e,{history:d=Ut}=e;const _=(g,A,G)=>{const B=a(G);return typeof(B==null?void 0:B.fn)=="function"?B.fn(g,B):B};De(yn,d);const p=Fe(it),m=Fe(qe),$=de([]);oe(t,$,g=>n(12,l=g));const h=de(null);oe(t,h,g=>n(2,i=g));let y=!1;const C=p||de(f?{pathname:f}:d.location);oe(t,C,g=>n(1,s=g));const T=m?m.routerBase:de({path:c,uri:c});oe(t,T,g=>n(13,r=g));const D=Bn([T,h],([g,A])=>{if(!A)return g;const{path:G}=g,{route:B,uri:Qt}=A;return{path:B.default?G:B.path.replace(/\*.*$/,""),uri:Qt}}),Z=g=>{const{path:A}=r;let{path:G}=g;if(g._path=G,g.path=ft(A,G),typeof window>"u"){if(y)return;const B=ct([g],s.pathname);B&&(h.set(B),y=!0)}else $.update(B=>[...B,g])},R=g=>{$.update(A=>A.filter(G=>G!==g))};let E=!1;return p||(Wt(()=>d.listen(A=>{n(11,E=A.preserveScroll||!1),C.set(A.location)})),De(it,C)),De(qe,{activeRoute:h,base:T,routerBase:D,registerRoute:Z,unregisterRoute:R}),t.$$set=g=>{"basepath"in g&&n(8,c=g.basepath),"url"in g&&n(9,f=g.url),"viewtransition"in g&&n(0,a=g.viewtransition),"history"in g&&n(10,d=g.history),"$$scope"in g&&n(14,u=g.$$scope)},t.$$.update=()=>{if(t.$$.dirty&8192){const{path:g}=r;$.update(A=>A.map(G=>Object.assign(G,{path:ft(g,G._path)})))}if(t.$$.dirty&6146){const g=ct(l,s.pathname);h.set(g&&{...g,preserveScroll:E})}},[a,s,i,_,$,h,C,T,c,f,d,E,l,r,u,o]}class Vn extends Y{constructor(e){super(),H(this,e,Kn,Gn,U,{basepath:8,url:9,viewtransition:0,history:10})}}const Jn=t=>{const e=n=>{const s=n.currentTarget;(s.target===""||s.target==="_self")&&An(s)&&Tn(n)&&(n.preventDefault(),qt(s.pathname+s.search,{replace:s.hasAttribute("replace"),preserveScroll:s.hasAttribute("preserveScroll")}))};return t.addEventListener("click",e),{destroy(){t.removeEventListener("click",e)}}};function Qn(t){let e,n;const s=t[1].default,l=me(s,t,t[0],null);return{c(){e=P("div"),l&&l.c(),I(e,"class","svelte-rl1i24")},m(r,i){v(r,e,i),l&&l.m(e,null),n=!0},p(r,[i]){l&&l.p&&(!n||i&1)&&be(l,s,r,r[0],n?ge(s,r[0],i,null):$e(r[0]),null)},i(r){n||(b(l,r),n=!0)},o(r){k(l,r),n=!1},d(r){r&&w(e),l&&l.d(r)}}}function Xn(t,e,n){let{$$slots:s={},$$scope:l}=e;return t.$$set=r=>{"$$scope"in r&&n(0,l=r.$$scope)},[l,s]}class Ht extends Y{constructor(e){super(),H(this,e,Xn,Qn,U,{})}}function Zn(t){let e,n,s,l,r=!t[2]&&gt(t);return{c(){e=P("button"),r&&r.c(),I(e,"class","button svelte-1rmphn3"),e.disabled=t[1],W(e,"spinning",t[2])},m(i,o){v(i,e,o),r&&r.m(e,null),n=!0,s||(l=K(e,"click",t[5]),s=!0)},p(i,o){i[2]?r&&(z(),k(r,1,1,()=>{r=null}),F()):r?(r.p(i,o),o&4&&b(r,1)):(r=gt(i),r.c(),b(r,1),r.m(e,null)),(!n||o&2)&&(e.disabled=i[1]),(!n||o&4)&&W(e,"spinning",i[2])},i(i){n||(b(r),n=!0)},o(i){k(r),n=!1},d(i){i&&w(e),r&&r.d(),s=!1,l()}}}function xn(t){let e,n,s,l;const r=t[4].default,i=me(r,t,t[3],null);return{c(){e=P("a"),i&&i.c(),I(e,"class","button svelte-1rmphn3"),I(e,"href",t[0]),I(e,"role","button")},m(o,u){v(o,e,u),i&&i.m(e,null),n=!0,s||(l=tn(Jn.call(null,e)),s=!0)},p(o,u){i&&i.p&&(!n||u&8)&&be(i,r,o,o[3],n?ge(r,o[3],u,null):$e(o[3]),null),(!n||u&1)&&I(e,"href",o[0])},i(o){n||(b(i,o),n=!0)},o(o){k(i,o),n=!1},d(o){o&&w(e),i&&i.d(o),s=!1,l()}}}function gt(t){let e;const n=t[4].default,s=me(n,t,t[3],null);return{c(){s&&s.c()},m(l,r){s&&s.m(l,r),e=!0},p(l,r){s&&s.p&&(!e||r&8)&&be(s,n,l,l[3],e?ge(n,l[3],r,null):$e(l[3]),null)},i(l){e||(b(s,l),e=!0)},o(l){k(s,l),e=!1},d(l){s&&s.d(l)}}}function es(t){let e,n,s,l;const r=[xn,Zn],i=[];function o(u,c){return u[0]?0:1}return e=o(t),n=i[e]=r[e](t),{c(){n.c(),s=V()},m(u,c){i[e].m(u,c),v(u,s,c),l=!0},p(u,[c]){let f=e;e=o(u),e===f?i[e].p(u,c):(z(),k(i[f],1,1,()=>{i[f]=null}),F(),n=i[e],n?n.p(u,c):(n=i[e]=r[e](u),n.c()),b(n,1),n.m(s.parentNode,s))},i(u){l||(b(n),l=!0)},o(u){k(n),l=!1},d(u){u&&w(s),i[e].d(u)}}}function ts(t,e,n){let{$$slots:s={},$$scope:l}=e,{href:r=null}=e,{disabled:i=!1}=e,{spin:o=!1}=e;function u(c){Se.call(this,t,c)}return t.$$set=c=>{"href"in c&&n(0,r=c.href),"disabled"in c&&n(1,i=c.disabled),"spin"in c&&n(2,o=c.spin),"$$scope"in c&&n(3,l=c.$$scope)},[r,i,o,l,s,u]}class ne extends Y{constructor(e){super(),H(this,e,ts,es,U,{href:0,disabled:1,spin:2})}}function ns(t){const e=t-1;return e*e*e+1}function bt(t,{delay:e=0,duration:n=400,easing:s=se}={}){const l=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:s,css:r=>`opacity: ${r*l}`}}function Ne(t,{delay:e=0,duration:n=400,easing:s=ns,x:l=0,y:r=0,opacity:i=0}={}){const o=getComputedStyle(t),u=+o.opacity,c=o.transform==="none"?"":o.transform,f=u*(1-i),[a,d]=tt(l),[_,p]=tt(r);return{delay:e,duration:n,easing:s,css:(m,$)=>`
			transform: ${c} translate(${(1-m)*a}${d}, ${(1-m)*_}${p});
			opacity: ${u-f*$}`}}function $t(t,e,n){const s=t.slice();return s[14]=e[n],s[16]=n,s}function ss(t){let e,n,s,l,r;function i(){return t[12](t[16])}return{c(){e=P("div"),I(e,"class","waterblock svelte-iw98db"),ve(e,"background-color","var(--clr-none)")},m(o,u){v(o,e,u),s=!0,l||(r=K(e,"click",i),l=!0)},p(o,u){t=o},i(o){s||(o&&Q(()=>{s&&(n||(n=pe(e,Ne,{y:-200,duration:200,easing:se},!0)),n.run(1))}),s=!0)},o(o){o&&(n||(n=pe(e,Ne,{y:-200,duration:200,easing:se},!1)),n.run(0)),s=!1},d(o){o&&w(e),o&&n&&n.end(),l=!1,r()}}}function ls(t){let e,n,s=`var(--clr-wtr${t[0].levels[t[16]]})`,l,r,i;function o(){return t[11](t[16])}return{c(){e=P("div"),I(e,"class","waterblock svelte-iw98db"),ve(e,"background-color",s)},m(u,c){v(u,e,c),l=!0,r||(i=K(e,"click",o),r=!0)},p(u,c){t=u,c&1&&s!==(s=`var(--clr-wtr${t[0].levels[t[16]]})`)&&ve(e,"background-color",s)},i(u){l||(u&&Q(()=>{l&&(n||(n=pe(e,Ne,{y:-200,duration:200,easing:se},!0)),n.run(1))}),l=!0)},o(u){u&&(n||(n=pe(e,Ne,{y:-200,duration:200,easing:se},!1)),n.run(0)),l=!1},d(u){u&&w(e),u&&n&&n.end(),r=!1,i()}}}function kt(t){let e,n,s;const l=[ls,ss],r=[];function i(o,u){return o[16]<=o[0].levels.length?0:1}return e=i(t),n=r[e]=l[e](t),{c(){n.c(),s=V()},m(o,u){r[e].m(o,u),v(o,s,u)},p(o,u){let c=e;e=i(o),e===c?r[e].p(o,u):(z(),k(r[c],1,1,()=>{r[c]=null}),F(),n=r[e],n?n.p(o,u):(n=r[e]=l[e](o),n.c()),b(n,1),n.m(s.parentNode,s))},d(o){o&&w(s),r[e].d(o)}}}function rs(t){let e,n,s,l,r,i,o=t[0].name+"",u,c,f,a=le({length:4}),d=[];for(let _=0;_<a.length;_+=1)d[_]=kt($t(t,a,_));return{c(){e=P("div"),n=P("div"),s=P("div"),l=L();for(let _=0;_<d.length;_+=1)d[_].c();r=L(),i=P("h4"),u=q(o),I(s,"class","plug svelte-iw98db"),I(n,"class","tube svelte-iw98db"),I(n,"data-selectable",t[3]),I(n,"draggable","true"),W(n,"selected",t[1]),W(n,"highlight",t[2]),W(n,"dropping",t[4]),W(n,"unplugged",!t[0].done),I(i,"class","svelte-iw98db"),I(e,"class","tube-slot")},m(_,p){v(_,e,p),j(e,n),j(n,s),j(n,l);for(let m=0;m<d.length;m+=1)d[m]&&d[m].m(n,null);j(e,r),j(e,i),j(i,u),c||(f=[K(n,"dragstart",t[6]),K(n,"dragenter",t[8]),K(n,"dragover",t[9]),K(n,"dragleave",t[10]),K(n,"drop",t[7])],c=!0)},p(_,[p]){if(p&33){a=le({length:4});let m;for(m=0;m<a.length;m+=1){const $=$t(_,a,m);d[m]?d[m].p($,p):(d[m]=kt($),d[m].c(),d[m].m(n,null))}for(;m<d.length;m+=1)d[m].d(1);d.length=a.length}p&8&&I(n,"data-selectable",_[3]),p&2&&W(n,"selected",_[1]),p&4&&W(n,"highlight",_[2]),p&16&&W(n,"dropping",_[4]),p&1&&W(n,"unplugged",!_[0].done),p&1&&o!==(o=_[0].name+"")&&Je(u,o)},i:S,o:S,d(_){_&&w(e),Ve(d,_),c=!1,X(f)}}}const we="game/tube";function os(t,e,n){let{tube:s}=e,{selected:l=!1}=e,{highlight:r=!1}=e,{selectable:i}=e,o=!1;const u=Bt(),c=h=>{u("tube-click",{tubeId:s.id,level:h})},f=h=>{h.dataTransfer.setData(we,s.id.toString()),u("tube-drag",{tubeId:s.id})},a=h=>{n(4,o=!1);const y=+h.dataTransfer.getData(we),C=s.id;u("tube-drop",{sourceTubeId:y,targetTubeId:C}),h.preventDefault()},d=h=>{h.dataTransfer.types.includes(we)&&(h.preventDefault(),i&&n(4,o=!0))},_=h=>{h.dataTransfer.types.includes(we)&&h.preventDefault()},p=h=>{h.dataTransfer.types.includes(we)&&(n(4,o=!1),h.preventDefault())},m=h=>c(h),$=h=>c(h);return t.$$set=h=>{"tube"in h&&n(0,s=h.tube),"selected"in h&&n(1,l=h.selected),"highlight"in h&&n(2,r=h.highlight),"selectable"in h&&n(3,i=h.selectable)},[s,l,r,i,o,c,f,a,d,_,p,m,$]}let is=class extends Y{constructor(e){super(),H(this,e,os,rs,U,{tube:0,selected:1,highlight:2,selectable:3})}};function Yt(t){if(t.length<=6)return[t];const e=t.length<=14?2:3,n=Math.floor(t.length/e),s=[];for(let l=0,r=0;l<t.length;r++,l+=n){const i=r<t.length%e?1:0;s.push(t.slice(l,l+n+i)),l+=i}return s}function yt(t,e,n){const s=t.slice();return s[8]=e[n],s}function wt(t,e,n){const s=t.slice();return s[11]=e[n],s}function vt(t,e){let n,s,l;return s=new is({props:{tube:e[11],selected:e[1]===e[11].id,selectable:e[0][e[11].id],highlight:e[2]===e[11].id}}),s.$on("tube-click",e[5]),s.$on("tube-drag",e[6]),s.$on("tube-drop",e[7]),{key:t,first:null,c(){n=V(),N(s.$$.fragment),this.first=n},m(r,i){v(r,n,i),M(s,r,i),l=!0},p(r,i){e=r;const o={};i&8&&(o.tube=e[11]),i&10&&(o.selected=e[1]===e[11].id),i&9&&(o.selectable=e[0][e[11].id]),i&12&&(o.highlight=e[2]===e[11].id),s.$set(o)},i(r){l||(b(s.$$.fragment,r),l=!0)},o(r){k(s.$$.fragment,r),l=!1},d(r){r&&w(n),O(s,r)}}}function Ct(t){let e,n=[],s=new Map,l,r,i=le(t[8]);const o=u=>u[11].id;for(let u=0;u<i.length;u+=1){let c=wt(t,i,u),f=o(c);s.set(f,n[u]=vt(f,c))}return{c(){e=P("div");for(let u=0;u<n.length;u+=1)n[u].c();l=L(),I(e,"class","tubes-row svelte-17orp1k")},m(u,c){v(u,e,c);for(let f=0;f<n.length;f+=1)n[f]&&n[f].m(e,null);j(e,l),r=!0},p(u,c){c&15&&(i=le(u[8]),z(),n=bn(n,c,o,1,u,i,s,e,gn,vt,l,wt),F())},i(u){if(!r){for(let c=0;c<i.length;c+=1)b(n[c]);r=!0}},o(u){for(let c=0;c<n.length;c+=1)k(n[c]);r=!1},d(u){u&&w(e);for(let c=0;c<n.length;c+=1)n[c].d()}}}function us(t){let e,n,s=le(t[3]),l=[];for(let i=0;i<s.length;i+=1)l[i]=Ct(yt(t,s,i));const r=i=>k(l[i],1,1,()=>{l[i]=null});return{c(){e=P("div");for(let i=0;i<l.length;i+=1)l[i].c();I(e,"class","tubes-container")},m(i,o){v(i,e,o);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(e,null);n=!0},p(i,[o]){if(o&15){s=le(i[3]);let u;for(u=0;u<s.length;u+=1){const c=yt(i,s,u);l[u]?(l[u].p(c,o),b(l[u],1)):(l[u]=Ct(c),l[u].c(),b(l[u],1),l[u].m(e,null))}for(z(),u=s.length;u<l.length;u+=1)r(u);F()}},i(i){if(!n){for(let o=0;o<s.length;o+=1)b(l[o]);n=!0}},o(i){l=l.filter(Boolean);for(let o=0;o<l.length;o+=1)k(l[o]);n=!1},d(i){i&&w(e),Ve(l,i)}}}function cs(t,e,n){let{tubes:s}=e,{enabled:l}=e,{selectedId:r=null}=e,{highlightId:i=null}=e,o=[];function u(a){Se.call(this,t,a)}function c(a){Se.call(this,t,a)}function f(a){Se.call(this,t,a)}return t.$$set=a=>{"tubes"in a&&n(4,s=a.tubes),"enabled"in a&&n(0,l=a.enabled),"selectedId"in a&&n(1,r=a.selectedId),"highlightId"in a&&n(2,i=a.highlightId)},t.$$.update=()=>{t.$$.dirty&16&&n(3,o=Yt(s))},[l,r,i,o,s,u,c,f]}class Gt extends Y{constructor(e){super(),H(this,e,cs,us,U,{tubes:4,enabled:0,selectedId:1,highlightId:2})}}function fs(t){let e,n,s,l,r,i;return{c(){e=P("div"),n=P("h2"),s=q(t[1]),I(e,"class",l="modal "+t[0]+" svelte-alsri9")},m(o,u){v(o,e,u),j(e,n),j(n,s),i=!0},p(o,[u]){(!i||u&2)&&Je(s,o[1]),(!i||u&1&&l!==(l="modal "+o[0]+" svelte-alsri9"))&&I(e,"class",l)},i(o){i||(o&&Q(()=>{i&&(r||(r=pe(e,bt,{delay:100},!0)),r.run(1))}),i=!0)},o(o){o&&(r||(r=pe(e,bt,{delay:100},!1)),r.run(0)),i=!1},d(o){o&&w(e),o&&r&&r.end()}}}function as(t,e,n){let s,{result:l}=e,r="";return t.$$set=i=>{"result"in i&&n(2,l=i.result)},t.$$.update=()=>{t.$$.dirty&4&&n(1,s=l?"🏅 You Win 🏅":"You lose 😞"),t.$$.dirty&4&&n(0,r=l?"win":"lose")},[r,s,l]}class ds extends Y{constructor(e){super(),H(this,e,as,fs,U,{result:2})}}function hs(t){let e;return{c(){e=P("h2"),I(e,"class","focus-anchor svelte-odht4n")},m(n,s){v(n,e,s)},p:S,i:S,o:S,d(n){n&&w(e)}}}class Kt extends Y{constructor(e){super(),H(this,e,null,hs,U,{})}}function _s(t,e){if(t.empty)throw Error(`source-empty ${t.name}`);if(t.done)throw Error(`source-closed ${t.name}`);if(e.full)throw Error(`target-full ${t.name}`);const n=t.topColor;if(!e.empty&&n!==e.topColor)throw Error("invalid-color");const s=Math.min(t.topAmount,e.emptySpace),l=t.levels.slice(0,-s),r=Array(s).fill(n),i=[...e.levels,...r];return[new te(t.id,l),new te(e.id,i)]}class te{constructor(e,n=[]){this.id=e,this.levels=n}get name(){return String.fromCharCode(65+this.id)}get empty(){return this.levels.length===0}get full(){return this.levels.length>=4}get emptySpace(){return 4-this.levels.length}get done(){return this.levels.length===4&&this.levels[0]===this.levels[1]&&this.levels[1]===this.levels[2]&&this.levels[2]==this.levels[3]&&this.levels[3]>0}get topColor(){return this.levels.length?this.levels[this.levels.length-1]:null}get topAmount(){if(this.levels.length<=1)return this.levels.length;const e=this.topColor;let n=1;for(;n<this.levels.length;){if(this.levels[this.levels.length-1-n]!=e)return n;n+=1}return this.levels.length}get singleColor(){return this.topAmount===this.levels.length}accepts(e){return this.empty?4:this.full?0:this.topColor===e?this.emptySpace:0}add(e){if(this.full)throw Error(`tube-full ${this.name}`);return new te(this.id,[...this.levels,e])}}const Vt=19;class Et{constructor(e,n){re(this,"cumulative");re(this,"tot");this.items=e,this.cumulative=[],this.tot=0;for(let s=0;s<e.length;s++)this.tot+=n[s],this.cumulative.push(this.tot)}randomItem(){const e=Math.random()*this.tot;for(let n=0;n<this.items.length;n++)if(this.cumulative[n]>e)return this.items[n];return this.items[this.items.length-1]}}function ps(t){let e=[];for(let n=0;n<t.length;n++){const s=t[n];if(!s.done&&!s.empty)for(let l=0;l<t.length;l++){const r=t[l];n!==l&&r.accepts(s.topColor)&&e.push({from:s.id,to:r.id})}}return e}function ms(t){return t.map(e=>e.done||e.empty).reduce((e,n)=>e&&n,!0)}var Re=(t=>(t[t.Playing=0]="Playing",t[t.Won=1]="Won",t[t.Lost=2]="Lost",t))(Re||{});class ee{constructor(e=[]){re(this,"status");re(this,"tubes");this.tubes=[];for(const[n,s]of e.entries())s instanceof te?this.tubes.push(s):this.tubes.push(new te(n,s));this.status=0,ms(this.tubes)?this.status=1:this.possibleActions().length===0&&(this.status=2)}possibleActions(){return ps(this.tubes)}get won(){return this.status===1}get lost(){return this.status===2}get ended(){return this.status!==0}get numClosed(){return this.tubes.filter(e=>e.done).length}historyEntry({from:e,to:n}){if(this.tubes[e].topColor!==this.tubes[n].topColor&&!this.tubes[n].empty)throw new Error("invalid-color");const s=this.tubes[e].topColor;return{fromIndex:e,toIndex:n,fromId:this.tubes[e].name,toId:this.tubes[n].name,color:s,amount:Math.min(this.tubes[e].topAmount,this.tubes[n].accepts(s))}}applyMove({from:e,to:n}){const[s,l]=_s(this.tubes[e],this.tubes[n]),r=[...this.tubes];return r[e]=s,r[n]=l,new ee(r)}add(e,n){const s=[...this.tubes];return s[n]=this.tubes[n].add(e),new ee(s)}getHash(){return this.tubes.map(e=>e.levels.concat(e.full?[]:[0])).flat().map(e=>e.toString(36)).join("")}}function ze(t){return t[Math.floor(Math.random()*t.length)]}function gs(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}}function bs(t){const e=Array(Vt).fill(null).map((n,s)=>s+1);return gs(e),e.slice(0,t)}function Jt(t=0){t==0&&(t=10+Math.floor(Math.random()*6));const e=bs(t-2),n=new Array(t-2).fill(null).map((r,i)=>new Array(4).fill(e[i])).concat([[],[]]),s=new ee(n);for(let r=0;r<70;r++){const i=new Et(s.tubes,s.tubes.map(d=>d.topAmount)).randomItem(),o=s.tubes.filter(d=>!d.full&&d.id!==i.id),u=ze(o),c=Math.min(i.singleColor?i.topAmount-1:i.topAmount,u.emptySpace),f=new Et([1,2,3].splice(0,c),[1,3,9].splice(c)).randomItem(),a=i.levels.splice(-f);u.levels.push(...a)}let l=s.tubes.filter(r=>r.empty).length;for(let r=0;r<100&&l<2;r++){const i=s.tubes.filter(c=>!c.empty),o=ze(i),u=s.tubes.filter(c=>!c.full&&c.levels.length>o.levels.length);if(u.length>0){const c=ze(u),f=o.levels.splice(-1);c.levels.push(...f)}l=s.tubes.filter(c=>c.empty).length}return new ee(s.tubes)}const Le=de(Jt());function $s(){return new Worker("/colortubes/assets/solve-worker-e3be59c8.js")}function ks(t){let e;return{c(){e=q("New")},m(n,s){v(n,e,s)},d(n){n&&w(e)}}}function ys(t){let e;return{c(){e=q("Custom")},m(n,s){v(n,e,s)},d(n){n&&w(e)}}}function ws(t){let e;return{c(){e=q("Reset")},m(n,s){v(n,e,s)},d(n){n&&w(e)}}}function St(t){let e,n;return e=new ne({props:{spin:t[1],$$slots:{default:[vs]},$$scope:{ctx:t}}}),e.$on("click",t[9]),{c(){N(e.$$.fragment)},m(s,l){M(e,s,l),n=!0},p(s,l){const r={};l&2&&(r.spin=s[1]),l&2097152&&(r.$$scope={dirty:l,ctx:s}),e.$set(r)},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){k(e.$$.fragment,s),n=!1},d(s){O(e,s)}}}function vs(t){let e;return{c(){e=q("Solve")},m(n,s){v(n,e,s)},d(n){n&&w(e)}}}function It(t){let e,n;return e=new ne({props:{$$slots:{default:[Cs]},$$scope:{ctx:t}}}),e.$on("click",t[13]),{c(){N(e.$$.fragment)},m(s,l){M(e,s,l),n=!0},p(s,l){const r={};l&2097152&&(r.$$scope={dirty:l,ctx:s}),e.$set(r)},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){k(e.$$.fragment,s),n=!1},d(s){O(e,s)}}}function Cs(t){let e;return{c(){e=q("💡")},m(n,s){v(n,e,s)},d(n){n&&w(e)}}}function Es(t){let e,n,s,l,r,i,o,u,c;e=new ne({props:{$$slots:{default:[ks]},$$scope:{ctx:t}}}),e.$on("click",t[7]),s=new ne({props:{href:"/edit",$$slots:{default:[ys]},$$scope:{ctx:t}}}),r=new ne({props:{$$slots:{default:[ws]},$$scope:{ctx:t}}}),r.$on("click",t[8]);let f=t[0]&&t[5].length==0&&St(t),a=t[5].length>0&&It(t);return{c(){N(e.$$.fragment),n=L(),N(s.$$.fragment),l=L(),N(r.$$.fragment),i=L(),f&&f.c(),o=L(),a&&a.c(),u=V()},m(d,_){M(e,d,_),v(d,n,_),M(s,d,_),v(d,l,_),M(r,d,_),v(d,i,_),f&&f.m(d,_),v(d,o,_),a&&a.m(d,_),v(d,u,_),c=!0},p(d,_){const p={};_&2097152&&(p.$$scope={dirty:_,ctx:d}),e.$set(p);const m={};_&2097152&&(m.$$scope={dirty:_,ctx:d}),s.$set(m);const $={};_&2097152&&($.$$scope={dirty:_,ctx:d}),r.$set($),d[0]&&d[5].length==0?f?(f.p(d,_),_&33&&b(f,1)):(f=St(d),f.c(),b(f,1),f.m(o.parentNode,o)):f&&(z(),k(f,1,1,()=>{f=null}),F()),d[5].length>0?a?(a.p(d,_),_&32&&b(a,1)):(a=It(d),a.c(),b(a,1),a.m(u.parentNode,u)):a&&(z(),k(a,1,1,()=>{a=null}),F())},i(d){c||(b(e.$$.fragment,d),b(s.$$.fragment,d),b(r.$$.fragment,d),b(f),b(a),c=!0)},o(d){k(e.$$.fragment,d),k(s.$$.fragment,d),k(r.$$.fragment,d),k(f),k(a),c=!1},d(d){d&&(w(n),w(l),w(i),w(o),w(u)),O(e,d),O(s,d),O(r,d),f&&f.d(d),a&&a.d(d)}}}function Tt(t){let e,n;return e=new ds({props:{result:t[2].status==Re.Won}}),{c(){N(e.$$.fragment)},m(s,l){M(e,s,l),n=!0},p(s,l){const r={};l&4&&(r.result=s[2].status==Re.Won),e.$set(r)},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){k(e.$$.fragment,s),n=!1},d(s){O(e,s)}}}function Ss(t){let e,n,s,l,r,i,o,u,c;e=new Kt({}),s=new Ht({props:{$$slots:{default:[Es]},$$scope:{ctx:t}}}),i=new Gt({props:{tubes:t[2].tubes,selectedId:t[3],highlightId:t[6],enabled:t[4]}}),i.$on("tube-click",t[10]),i.$on("tube-drag",t[14]),i.$on("tube-drop",t[12]);let f=t[2].ended&&Tt(t);return{c(){N(e.$$.fragment),n=L(),N(s.$$.fragment),l=L(),r=P("div"),N(i.$$.fragment),o=L(),f&&f.c(),u=V(),I(r,"class","cols-2 svelte-m2jv0k")},m(a,d){M(e,a,d),v(a,n,d),M(s,a,d),v(a,l,d),v(a,r,d),M(i,r,null),v(a,o,d),f&&f.m(a,d),v(a,u,d),c=!0},p(a,[d]){const _={};d&2097187&&(_.$$scope={dirty:d,ctx:a}),s.$set(_);const p={};d&4&&(p.tubes=a[2].tubes),d&8&&(p.selectedId=a[3]),d&64&&(p.highlightId=a[6]),d&16&&(p.enabled=a[4]),i.$set(p),a[2].ended?f?(f.p(a,d),d&4&&b(f,1)):(f=Tt(a),f.c(),b(f,1),f.m(u.parentNode,u)):f&&(z(),k(f,1,1,()=>{f=null}),F())},i(a){c||(b(e.$$.fragment,a),b(s.$$.fragment,a),b(i.$$.fragment,a),b(f),c=!0)},o(a){k(e.$$.fragment,a),k(s.$$.fragment,a),k(i.$$.fragment,a),k(f),c=!1},d(a){a&&(w(n),w(l),w(r),w(o),w(u)),O(e,a),O(s,a),O(i),f&&f.d(a)}}}function Is(t,e,n){let s;oe(t,Le,E=>n(16,s=E));let l=null,r=!1,i=s,o=null,u=[],c=[],f=[],a=null;Wt(async()=>{console.log("initializing web worker"),n(0,l=new $s),n(0,l.onmessage=function(E){E.data.result===Re.Won&&(n(5,f=E.data.actions),console.debug(f)),n(1,r=!1)},l)});function d(){console.debug("generating new game"),Le.set(Jt()),_()}function _(){n(2,i=s),n(3,o=null),n(6,a=null),u=[],n(5,f=[]),C()}function p(){l.postMessage(i),n(1,r=!0)}function m(E){return o===E?!0:!(i.tubes[E].done||o===null&&i.tubes[E].empty||o!==null&&i.tubes[E].full)}function $(E){console.log(`clicked ${JSON.stringify(E.detail)}`);const g=E.detail.tubeId;m(g)&&(o===null?h(g):o===g?(console.debug(`deselecting tube ${o}`),n(3,o=null)):(T(o,g),D(g),n(3,o=null),n(6,a=null)),C())}function h(E){n(3,o=E),console.debug(`selecting tube ${o}`)}function y(E){const{sourceTubeId:g,targetTubeId:A}=E.detail;m(A)&&(o===A?(console.debug(`deselecting tube ${o}`),n(3,o=null)):(T(g,A),D(A),n(3,o=null)),C())}function C(){n(4,c=i.tubes.map(E=>m(E.id)))}function T(E,g){try{const A=i.historyEntry({from:E,to:g});n(2,i=i.applyMove({from:E,to:g})),console.info(`applied move ${JSON.stringify(A)}`),u=[...u,A]}catch(A){console.warn(A.message)}}function D(E){if(f.length>0){const g=f[0];E===g.toIndex&&o===g.fromIndex?n(5,f=f.slice(1)):n(5,f=[])}}function Z(){f.length>0&&(n(3,o=f[0].fromIndex),n(6,a=f[0].toIndex))}return[l,r,i,o,c,f,a,d,_,p,$,h,y,Z,E=>h(E.detail.tubeId)]}class Ts extends Y{constructor(e){super(),H(this,e,Is,Ss,U,{})}}function At(t,e,n){const s=t.slice();return s[7]=e[n],s}function Pt(t){let e,n=(t[0][t[7]]||"")+"",s,l=`var(--clr-wtr${t[7]>=0?t[7]:"-none"})`,r,i;function o(){return t[4](t[7])}return{c(){e=P("button"),s=q(n),I(e,"class","cell svelte-1smq6qh"),W(e,"curr",t[7]===t[1]),W(e,"extra",t[0][t[7]]>4),ve(e,"--color",l)},m(u,c){v(u,e,c),j(e,s),r||(i=K(e,"click",o),r=!0)},p(u,c){t=u,c&1&&n!==(n=(t[0][t[7]]||"")+"")&&Je(s,n),c&6&&W(e,"curr",t[7]===t[1]),c&5&&W(e,"extra",t[0][t[7]]>4)},d(u){u&&w(e),r=!1,i()}}}function As(t){let e,n,s,l,r,i=le(t[2]),o=[];for(let u=0;u<i.length;u+=1)o[u]=Pt(At(t,i,u));return{c(){e=P("div");for(let u=0;u<o.length;u+=1)o[u].c();n=L(),s=P("button"),s.innerHTML="",I(s,"class","cell empty svelte-1smq6qh"),W(s,"curr",t[1]===null),ve(s,"--color","var(--clr-wtr-none)"),I(e,"class","palette svelte-1smq6qh")},m(u,c){v(u,e,c);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(e,null);j(e,n),j(e,s),l||(r=K(s,"click",t[5]),l=!0)},p(u,[c]){if(c&15){i=le(u[2]);let f;for(f=0;f<i.length;f+=1){const a=At(u,i,f);o[f]?o[f].p(a,c):(o[f]=Pt(a),o[f].c(),o[f].m(e,n))}for(;f<o.length;f+=1)o[f].d(1);o.length=i.length}c&2&&W(s,"curr",u[1]===null)},i:S,o:S,d(u){u&&w(e),Ve(o,u),l=!1,r()}}}function Ps(t,e,n){const s=Bt();let{counts:l={}}=e;const r=Array(Vt).fill(null).map((f,a)=>a+1);let i=null;function o(f){n(1,i=f),s("color-pick",f)}const u=f=>o(f),c=()=>o(null);return t.$$set=f=>{"counts"in f&&n(0,l=f.counts)},[l,i,r,o,u,c]}class Ms extends Y{constructor(e){super(),H(this,e,Ps,As,U,{counts:0})}}function Os(t){let e;return{c(){e=q("Reset")},m(n,s){v(n,e,s)},d(n){n&&w(e)}}}function Ns(t){let e;return{c(){e=q("Discard")},m(n,s){v(n,e,s)},d(n){n&&w(e)}}}function Rs(t){let e;return{c(){e=q("Play")},m(n,s){v(n,e,s)},d(n){n&&w(e)}}}function Ls(t){let e,n,s,l,r,i;return e=new ne({props:{$$slots:{default:[Os]},$$scope:{ctx:t}}}),e.$on("click",t[5]),s=new ne({props:{href:"/",$$slots:{default:[Ns]},$$scope:{ctx:t}}}),r=new ne({props:{disabled:!t[3],$$slots:{default:[Rs]},$$scope:{ctx:t}}}),r.$on("click",t[8]),{c(){N(e.$$.fragment),n=L(),N(s.$$.fragment),l=L(),N(r.$$.fragment)},m(o,u){M(e,o,u),v(o,n,u),M(s,o,u),v(o,l,u),M(r,o,u),i=!0},p(o,u){const c={};u&32768&&(c.$$scope={dirty:u,ctx:o}),e.$set(c);const f={};u&32768&&(f.$$scope={dirty:u,ctx:o}),s.$set(f);const a={};u&8&&(a.disabled=!o[3]),u&32768&&(a.$$scope={dirty:u,ctx:o}),r.$set(a)},i(o){i||(b(e.$$.fragment,o),b(s.$$.fragment,o),b(r.$$.fragment,o),i=!0)},o(o){k(e.$$.fragment,o),k(s.$$.fragment,o),k(r.$$.fragment,o),i=!1},d(o){o&&(w(n),w(l)),O(e,o),O(s,o),O(r,o)}}}function Ds(t){let e,n,s,l,r,i,o,u,c,f,a,d,_,p,m,$;return e=new Kt({}),s=new Ht({props:{$$slots:{default:[Ls]},$$scope:{ctx:t}}}),a=new Ms({props:{counts:t[1]}}),a.$on("color-pick",t[6]),_=new Gt({props:{tubes:t[0].tubes,enabled:t[2]}}),_.$on("tube-click",t[7]),{c(){N(e.$$.fragment),n=L(),N(s.$$.fragment),l=L(),r=P("div"),i=P("label"),i.textContent="Num. Tubes",o=L(),u=P("input"),f=L(),N(a.$$.fragment),d=L(),N(_.$$.fragment),I(i,"for","num_tubes"),I(u,"type","number"),I(u,"name","num_tubes"),I(u,"min","5"),I(u,"max","20"),u.value=c=t[0].tubes.length,I(u,"class","svelte-1ypq0x8")},m(h,y){M(e,h,y),v(h,n,y),M(s,h,y),v(h,l,y),v(h,r,y),j(r,i),j(r,o),j(r,u),v(h,f,y),M(a,h,y),v(h,d,y),M(_,h,y),p=!0,m||($=K(u,"change",t[4]),m=!0)},p(h,[y]){const C={};y&32776&&(C.$$scope={dirty:y,ctx:h}),s.$set(C),(!p||y&1&&c!==(c=h[0].tubes.length)&&u.value!==c)&&(u.value=c);const T={};y&2&&(T.counts=h[1]),a.$set(T);const D={};y&1&&(D.tubes=h[0].tubes),y&4&&(D.enabled=h[2]),_.$set(D)},i(h){p||(b(e.$$.fragment,h),b(s.$$.fragment,h),b(a.$$.fragment,h),b(_.$$.fragment,h),p=!0)},o(h){k(e.$$.fragment,h),k(s.$$.fragment,h),k(a.$$.fragment,h),k(_.$$.fragment,h),p=!1},d(h){h&&(w(n),w(l),w(r),w(f),w(d)),O(e,h),O(s,h),O(a,h),O(_,h),m=!1,$()}}}function js(t){return t.length<4?t.concat(new Array(4-t.length).fill(0)):t}function Ws(t){const e={};for(const n of t)for(const s of n.levels)s&&(e[s]=++e[s]||1);return e}function Bs(t){const e=new Set(Object.values(t));return e.size===1&&e.has(4)}function zs(t,e,n){let s;oe(t,Le,h=>n(11,s=h));let l=s,r=[];l.tubes;let i=null,o={},u=!1;function c(h,y=0){return Array(h).fill(null).map((C,T)=>new te(y+T,[0,0,0,0]))}function f(h){const C=+h.target.value;if(C<l.tubes.length&&n(0,l=new ee(l.tubes.slice(0,C))),C>l.tubes.length){const T=C-l.tubes.length;n(0,l=new ee([...l.tubes,...c(T,l.tubes.length)]))}n(2,r=l.tubes.map(T=>!0))}function a(){n(0,l=new ee(c(l.tubes.length)))}function d(h){return h.map(y=>{const C=y.levels.indexOf(0);return C>=0?new te(y.id,y.levels.slice(0,C)):y})}function _(h){i=h.detail}function p(h,y){console.debug(`apply color ${i} to tube ${h} level ${y}`);const C=l.tubes[h],T=js([...C.levels]);T[y]=i||0;const D=[...l.tubes];D[h]=new te(C.id,T),n(0,l.tubes=D,l)}function m(h){let y=h.detail;p(y.tubeId,y.level)}function $(){if(u){const h=new ee(d(l.tubes));Le.set(h),qt("/")}}return t.$$.update=()=>{t.$$.dirty&1&&Yt(l.tubes),t.$$.dirty&1&&n(1,o=Ws(l.tubes)),t.$$.dirty&2&&n(3,u=Bs(o))},[l,o,r,u,f,a,_,m,$]}class Fs extends Y{constructor(e){super(),H(this,e,zs,Ds,U,{})}}function Us(t){let e,n;return e=new Ts({}),{c(){N(e.$$.fragment)},m(s,l){M(e,s,l),n=!0},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){k(e.$$.fragment,s),n=!1},d(s){O(e,s)}}}function qs(t){let e,n;return e=new Fs({}),{c(){N(e.$$.fragment)},m(s,l){M(e,s,l),n=!0},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){k(e.$$.fragment,s),n=!1},d(s){O(e,s)}}}function Hs(t){let e,n,s,l;return e=new ht({props:{path:"/",$$slots:{default:[Us]},$$scope:{ctx:t}}}),s=new ht({props:{path:"/edit",$$slots:{default:[qs]},$$scope:{ctx:t}}}),{c(){N(e.$$.fragment),n=L(),N(s.$$.fragment)},m(r,i){M(e,r,i),v(r,n,i),M(s,r,i),l=!0},p(r,i){const o={};i&1&&(o.$$scope={dirty:i,ctx:r}),e.$set(o);const u={};i&1&&(u.$$scope={dirty:i,ctx:r}),s.$set(u)},i(r){l||(b(e.$$.fragment,r),b(s.$$.fragment,r),l=!0)},o(r){k(e.$$.fragment,r),k(s.$$.fragment,r),l=!1},d(r){r&&w(n),O(e,r),O(s,r)}}}function Ys(t){let e,n,s,l,r,i;return r=new Vn({props:{basepath:"/colortubes",$$slots:{default:[Hs]},$$scope:{ctx:t}}}),{c(){e=P("div"),n=P("header"),n.innerHTML='<h1 class="svelte-98ugf6">Color Water Tubes</h1>',s=L(),l=P("main"),N(r.$$.fragment),I(n,"class","svelte-98ugf6"),I(e,"class","root-container svelte-98ugf6")},m(o,u){v(o,e,u),j(e,n),j(e,s),j(e,l),M(r,l,null),i=!0},p(o,[u]){const c={};u&1&&(c.$$scope={dirty:u,ctx:o}),r.$set(c)},i(o){i||(b(r.$$.fragment,o),i=!0)},o(o){k(r.$$.fragment,o),i=!1},d(o){o&&w(e),O(r)}}}class Gs extends Y{constructor(e){super(),H(this,e,null,Ys,U,{})}}new Gs({target:document.getElementById("app")});
